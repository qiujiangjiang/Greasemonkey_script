// ==UserScript==
// @name         qjjtools
// @namespace    npm/vite-plugin-monkey
// @version      11.1.1
// @author       qjj
// @description  qjjtools
// @license      MIT
// @icon         https://vitejs.dev/logo.svg
// @match        *://*/*
// @require      https://cdnjs.cloudflare.com/ajax/libs/vue/3.5.18/vue.global.prod.min.js
// @require      data:application/javascript,%3Bwindow.Vue%3DVue%3B
// @require      https://cdnjs.cloudflare.com/ajax/libs/naive-ui/2.42.0/index.prod.js
// @require      data:application/javascript,%3Bwindow.naive%3Dnaive%3B
// @grant        GM.addElement
// @grant        GM.addStyle
// @grant        GM.addValueChangeListener
// @grant        GM.cookie
// @grant        GM.deleteValue
// @grant        GM.deleteValues
// @grant        GM.download
// @grant        GM.getResourceText
// @grant        GM.getResourceUrl
// @grant        GM.getTab
// @grant        GM.getTabs
// @grant        GM.getValue
// @grant        GM.getValues
// @grant        GM.info
// @grant        GM.listValues
// @grant        GM.log
// @grant        GM.notification
// @grant        GM.openInTab
// @grant        GM.registerMenuCommand
// @grant        GM.removeValueChangeListener
// @grant        GM.saveTab
// @grant        GM.setClipboard
// @grant        GM.setValue
// @grant        GM.setValues
// @grant        GM.unregisterMenuCommand
// @grant        GM.webRequest
// @grant        GM.xmlHttpRequest
// @grant        GM_addElement
// @grant        GM_addStyle
// @grant        GM_addValueChangeListener
// @grant        GM_cookie
// @grant        GM_deleteValue
// @grant        GM_deleteValues
// @grant        GM_download
// @grant        GM_getResourceText
// @grant        GM_getResourceURL
// @grant        GM_getTab
// @grant        GM_getTabs
// @grant        GM_getValue
// @grant        GM_getValues
// @grant        GM_info
// @grant        GM_listValues
// @grant        GM_log
// @grant        GM_notification
// @grant        GM_openInTab
// @grant        GM_registerMenuCommand
// @grant        GM_removeValueChangeListener
// @grant        GM_saveTab
// @grant        GM_setClipboard
// @grant        GM_setValue
// @grant        GM_setValues
// @grant        GM_unregisterMenuCommand
// @grant        GM_webRequest
// @grant        GM_xmlhttpRequest
// @grant        unsafeWindow
// @grant        window.close
// @grant        window.focus
// @grant        window.onurlchange
// @run-at       document-start
// ==/UserScript==
(function() {
    'use strict';


    // --------------------------
    // 配置：仅监听匹配以下规则的URL
    // 支持字符串全匹配或正则表达式
    // 示例：
    // 1. 全匹配："https://api.example.com/data"
    // 2. 包含字符串：/api\.example\.com/
    // 3. 特定路径：/\/user\/\d+/
    console.log(unsafeWindow.location);
    // 配置需要监听的域名列表
    const LISTEN_DOMAINS = [
        {
            domain: 'ad.e.kuaishou.com',
            targetUrlPattern: /createUnitAndCreative/,
            onRequest: function(requestData) {
                // 处理快手请求数据
                try {
                    GM_setValue("kuaishou_requestData", JSON.stringify(requestData));
                    console.log("快手请求数据已保存到 kuaishou_requestData");
                } catch (error) {
                    console.error("保存快手请求数据失败:", error);
                }
            }
        },
        {
            domain: 'diy.cbd.alibaba-inc.com',
            targetUrlPattern: /queryJobPs/,
            onResponse: async function(responseData) {
                // 处理阿里响应数据
                try {
                    await saveToIndexedDB("alibaba_responseData", responseData);
                    console.log("阿里响应数据已保存到 alibaba_responseData");
                } catch (error) {
                    console.error("保存阿里响应数据失败:", error);
                }
            }
        }
    ];







    // 检查当前域名是否在监听列表中
    // 是否需要调整

    const shouldListen = LISTEN_DOMAINS.some(domain => unsafeWindow.location.href.includes(domain.domain));
    
    if (!shouldListen) {
        console.log("当前域名不在监听列表中，跳过监听");
        return 0;
    }

    // IndexedDB 操作函数
    const initIndexedDB = () => {
        return new Promise((resolve, reject) => {
            const request = indexedDB.open('RequestDataDB', 1);
            
            request.onerror = (event) => {
                console.error('IndexedDB 初始化失败:', event.target.error);
                reject(event.target.error);
            };
            
            request.onsuccess = (event) => {
                resolve(event.target.result);
            };
            
            request.onupgradeneeded = (event) => {
                const db = event.target.result;
                if (!db.objectStoreNames.contains('requests')) {
                    const objectStore = db.createObjectStore('requests', { keyPath: 'id' });
                    objectStore.createIndex('name', 'name', { unique: false });
                }
            };
        });
    };

    const saveToIndexedDB = async (dataName, data) => {
        try {
            const db = await initIndexedDB();
            const transaction = db.transaction(['requests'], 'readwrite');
            const objectStore = transaction.objectStore('requests');
            
            const requestData = {
                id: dataName,
                name: dataName,
                data: data,
                timestamp: new Date().getTime()
            };
            
            const request = objectStore.put(requestData);
            
            request.onsuccess = () => {
                console.log(`${dataName} 数据已保存到 IndexedDB`);
            };
            
            request.onerror = (event) => {
                console.error(`${dataName} 数据保存失败:`, event.target.error);
            };
            
            db.close();
        } catch (error) {
            console.error('IndexedDB 操作失败:', error);
        }
    };




    console.log('%c【XHR请求监听已启动】监听请求和响应', 'color: #22C55E; font-weight: bold');
   
    // 获取当前页面匹配的域名配置
    const getCurrentDomainConfigs = () => {
        return LISTEN_DOMAINS.filter(domain => unsafeWindow.location.href.includes(domain.domain));
    };

    const CURRENT_DOMAIN_CONFIGS = getCurrentDomainConfigs();
    
    // --------------------------
    console.log('监听URL规则：', CURRENT_DOMAIN_CONFIGS.map(c => c.targetUrlPattern));
    // 生成唯一请求ID
    const generateRequestId = () => `xhr_${Date.now()}_${Math.floor(Math.random() * 1000)}`;

    // 安全打印请求信息
    const logRequestInfo = (reqId, type, data) => {
        const title = `[XHR监听] ${type} - ID: ${reqId}`;
        console.groupCollapsed(`%c${title}`, 'color: #1E90FF; font-weight: 500');
        Object.entries(data).forEach(([key, value]) => {
            console.log(`%c${key}:`, 'color: #666; font-weight: 600', value);
        });
        console.groupEnd();
    };

    // 获取匹配的域名配置
    const getMatchingDomainConfig = (url) => {
        return LISTEN_DOMAINS.find(domain => {
            if (!domain.targetUrlPattern) return false;
            if (typeof domain.targetUrlPattern === 'string') {
                return url.includes(domain.targetUrlPattern);
            } else if (domain.targetUrlPattern instanceof RegExp) {
                return domain.targetUrlPattern.test(url);
            }
            return false;
        });
    };

    // 检查URL是否匹配目标规则
    const isTargetUrl = (url) => {
        return LISTEN_DOMAINS.some(domain => {
            if (!domain.targetUrlPattern) return false;
            if (typeof domain.targetUrlPattern === 'string') {
                return url.includes(domain.targetUrlPattern);
            } else if (domain.targetUrlPattern instanceof RegExp) {
                return domain.targetUrlPattern.test(url);
            }
            return false;
        });
    };

    // 拦截XMLHttpRequest（监听请求和响应）
    const hookXHR = () => {
        const originalXHR = unsafeWindow.XMLHttpRequest;
        unsafeWindow.XMLHttpRequest = function() {
            const xhr = new originalXHR();
            const reqId = generateRequestId();
            let method, url;
            const headers = {};
            let isTarget = false;
            let matchedDomainConfig = null;

            // 监听open方法（判断是否为目标URL）
            const originalOpen = xhr.open;
            xhr.open = function(m, u, async = true) {
                method = m.toUpperCase();
                url = u;
                
                // 检查是否匹配目标URL规则
                isTarget = isTargetUrl(url);
                if (isTarget) {
                    matchedDomainConfig = getMatchingDomainConfig(url);
                    logRequestInfo(reqId, '请求初始化', {
                        方法: method,
                        URL: url,
                        是否异步: async,
                        匹配域名配置: matchedDomainConfig ? matchedDomainConfig.domain : '未找到'
                    });
                }

                originalOpen.apply(xhr, arguments);
            };

            // 监听setRequestHeader（仅记录目标请求的头）
            const originalSetRequestHeader = xhr.setRequestHeader;
            xhr.setRequestHeader = function(header, value) {
                if (isTarget) {
                    headers[header.toLowerCase()] = value;
                }
                originalSetRequestHeader.apply(xhr, arguments);
            };

            // 监听send方法（仅打印目标请求的发送信息）
            const originalSend = xhr.send;
            xhr.send = function(body) {
                if (isTarget) {
                    // 处理请求体信息
                    let bodyInfo = '无';
                    if (body !== undefined && body !== null) {
                        if (typeof body === 'string') {
                            bodyInfo = body;
                        } else if (body instanceof FormData) {
                            bodyInfo = '[FormData]';
                        } else if (body instanceof Blob) {
                            bodyInfo = '[Blob]';
                        } else {
                            try {
                                bodyInfo = JSON.stringify(body);
                            } catch (e) {
                                bodyInfo = `[${Object.prototype.toString.call(body)}] 类型`;
                            }
                        }
                    }
                    
                    const requestData = {
                        method: method,
                        url: unsafeWindow.location.origin + url,
                        requestHeaders: headers,
                        requestBody: bodyInfo
                    };
                    
                    // 使用配置中的onRequest处理器（如果存在）
                    if (matchedDomainConfig && typeof matchedDomainConfig.onRequest === 'function') {
                        try {
                            matchedDomainConfig.onRequest(requestData);
                        } catch (handlerError) {
                            console.error(`处理 ${matchedDomainConfig.domain} 请求时出错:`, handlerError);
                        }
                    } else {
                        // 默认处理方式
                        try {
                            GM_setValue("kuaishou_requestData", JSON.stringify(requestData));
                        } catch (error) {
                            console.error('保存请求数据失败:', error);
                        }
                    }
                    
                    logRequestInfo(url + reqId, '请求发送', requestData);
                }

                originalSend.apply(xhr, arguments);
                
                // 添加响应监听
                if (isTarget) {
                    const originalOnReadyStateChange = xhr.onreadystatechange;
                    xhr.onreadystatechange = function() {
                        if (xhr.readyState === 4) {
                            // 请求完成，处理响应
                            let responseBody = xhr.responseText;
                            try {
                                responseBody = JSON.parse(xhr.responseText);
                            } catch (e) {
                                // 如果不是JSON格式，保持原样
                            }
                            
                            const responseData = {
                                status: xhr.status,
                                statusText: xhr.statusText,
                                responseURL: xhr.responseURL,
                                responseType: xhr.responseType,
                                response: responseBody,
                                responseHeaders: xhr.getAllResponseHeaders()
                            };
                            
                            // 使用配置中的onResponse处理器（如果存在）
                            if (matchedDomainConfig && typeof matchedDomainConfig.onResponse === 'function') {
                                try {
                                    matchedDomainConfig.onResponse(responseData);
                                } catch (handlerError) {
                                    console.error(`处理 ${matchedDomainConfig.domain} 响应时出错:`, handlerError);
                                }
                            } else {
                                // 默认情况下只记录日志
                                logRequestInfo(reqId, '响应接收', responseData);
                            }
                        }
                        
                        if (originalOnReadyStateChange) {
                            originalOnReadyStateChange.apply(this, arguments);
                        }
                    };
                }
            };

            return xhr;
        };
    };

    // 初始化
    hookXHR();

})();


(a=>{if(typeof GM_addStyle=="function"){GM_addStyle(a);return}const t=document.createElement("style");t.textContent=a,document.head.append(t)})(" .n-progress[data-v-9e16403e],.n-progress[data-v-29be6a47],.n-progress[data-v-66be8dce]{margin:10px 0}.createrplan-container[data-v-5dbab58c]{padding:24px;max-width:1000px;margin:0 auto;background:linear-gradient(135deg,#667eea,#764ba2);min-height:100vh}.main-card[data-v-5dbab58c]{background:#fffffff2;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);border-radius:16px;box-shadow:0 8px 32px #0000001a;border:1px solid rgba(255,255,255,.2)}.main-card[data-v-5dbab58c] .n-card-header{background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;border-radius:16px 16px 0 0;padding:20px 24px}.main-card[data-v-5dbab58c] .n-card-content{padding:24px}[data-v-5dbab58c] .n-button{border-radius:12px;font-weight:500;transition:all .3s ease}[data-v-5dbab58c] .n-button:hover{transform:translateY(-2px);box-shadow:0 4px 16px #00000026}[data-v-5dbab58c] .n-input{border-radius:8px}[data-v-5dbab58c] .n-form-item-label{font-weight:500;color:#333}[data-v-5dbab58c] .n-tag{border-radius:20px;font-weight:500}pre[data-v-789feec4]{white-space:pre-wrap;word-wrap:break-word;font-size:12px}.button-container[data-v-dd9dacf7]{padding:20px}@media (max-width: 768px){.button-container[data-v-dd9dacf7] .n-space{flex-direction:column!important}.button-container[data-v-dd9dacf7] .n-button{width:100%!important;margin:4px 0!important}}.auto-height-card[data-v-dd9dacf7],.auto-height-card[data-v-dd9dacf7] .n-card__content{flex:1;display:flex;flex-direction:column}.flex-card[data-v-dd9dacf7]{flex:2}.default-component[data-v-ff0a68db]{display:flex;justify-content:center;align-items:center;height:100%;padding:20px}.getchuangyi-container[data-v-e7612e1f]{padding:24px;max-width:1200px;margin:0 auto;background:linear-gradient(135deg,#667eea,#764ba2);min-height:100vh}.main-card[data-v-e7612e1f]{background:#fffffff2;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);border-radius:16px;box-shadow:0 8px 32px #0000001a;border:1px solid rgba(255,255,255,.2)}.main-card[data-v-e7612e1f] .n-card-header{background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;border-radius:16px 16px 0 0;padding:20px 24px}.main-card[data-v-e7612e1f] .n-card-content{padding:24px}[data-v-e7612e1f] .n-button{border-radius:12px;font-weight:500;transition:all .3s ease}[data-v-e7612e1f] .n-button:hover{transform:translateY(-2px);box-shadow:0 4px 16px #00000026}[data-v-e7612e1f] .n-date-picker,[data-v-e7612e1f] .n-input{border-radius:8px}[data-v-e7612e1f] .n-data-table{border-radius:8px;overflow:hidden}[data-v-e7612e1f] .n-tag{border-radius:20px;font-weight:500}.jihua-container[data-v-e9fa887f]{padding:20px;max-width:800px;margin:0 auto}.description[data-v-e9fa887f]{background-color:#f5f5f5;padding:12px;border-radius:4px;margin-bottom:16px}.description pre[data-v-e9fa887f]{background-color:#fff;padding:8px;border-radius:4px;margin:8px 0;white-space:pre-wrap}.plan-container[data-v-f977d1aa]{padding:20px;max-width:800px;margin:0 auto}.description[data-v-f977d1aa]{background-color:#f5f5f5;padding:12px;border-radius:4px;margin-bottom:16px}.description pre[data-v-f977d1aa]{background-color:#fff;padding:8px;border-radius:4px;margin:8px 0;white-space:pre-wrap}.search-price-container[data-v-1b153763]{max-width:800px;margin:0 auto;padding:20px;background:linear-gradient(135deg,#667eea,#764ba2);min-height:100vh}.header[data-v-1b153763]{text-align:center;margin-bottom:30px;color:#fff}.header h2[data-v-1b153763]{font-size:28px;margin-bottom:10px;text-shadow:2px 2px 4px rgba(0,0,0,.3)}.subtitle[data-v-1b153763]{font-size:16px;opacity:.9;margin:0}.form-card[data-v-1b153763]{margin-bottom:20px;border-radius:16px;box-shadow:0 8px 32px #0000001a;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);border:1px solid rgba(255,255,255,.2)}.button-group[data-v-1b153763]{display:flex;gap:12px;justify-content:center;margin-top:20px}.result-card[data-v-1b153763]{margin-bottom:20px;border-radius:16px;box-shadow:0 8px 32px #0000001a}.result-card.success[data-v-1b153763]{border-left:4px solid #18a058}.result-card.error[data-v-1b153763]{border-left:4px solid #d03050}.result-header[data-v-1b153763]{display:flex;align-items:center;gap:8px;margin-bottom:12px;font-weight:600;font-size:16px}.result-icon[data-v-1b153763]{font-size:20px}.error-message[data-v-1b153763]{color:#d03050;margin:0}.preview-card[data-v-1b153763]{border-radius:16px;box-shadow:0 8px 32px #0000001a;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);border:1px solid rgba(255,255,255,.2)}.preview-header[data-v-1b153763]{font-weight:600;margin-bottom:16px;color:#333}.plan-ids-grid[data-v-1b153763]{display:flex;flex-wrap:wrap;gap:8px}@media (max-width: 768px){.search-price-container[data-v-1b153763]{padding:16px}.button-group[data-v-1b153763]{flex-direction:column}.header h2[data-v-1b153763]{font-size:24px}}.note-match-container[data-v-0e22a33f]{max-width:1200px;margin:0 auto;padding:20px;background:linear-gradient(135deg,#667eea,#764ba2);min-height:100vh}.header[data-v-0e22a33f]{text-align:center;margin-bottom:30px;color:#fff}.header h2[data-v-0e22a33f]{font-size:28px;margin-bottom:10px;text-shadow:2px 2px 4px rgba(0,0,0,.3)}.subtitle[data-v-0e22a33f]{font-size:16px;opacity:.9;margin:0}.main-card[data-v-0e22a33f]{background:#fffffff2;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);border-radius:16px;box-shadow:0 8px 32px #0000001a;border:1px solid rgba(255,255,255,.2);margin-bottom:20px}.main-card[data-v-0e22a33f] .n-card-content{padding:24px}.result-card[data-v-0e22a33f]{background:#fffffff2;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);border-radius:16px;box-shadow:0 8px 32px #0000001a;border:1px solid rgba(255,255,255,.2);border-left:4px solid #18a058}.result-card[data-v-0e22a33f] .n-card-header{background:linear-gradient(135deg,#18a058,#36ad6a);color:#fff;border-radius:16px 16px 0 0;margin:-1px -1px 0}.result-card[data-v-0e22a33f] .n-card-content{padding:24px}.match-stats-content[data-v-0e22a33f]{padding:16px}.stats-item[data-v-0e22a33f]{display:flex;align-items:center;padding:12px 16px;background:#409eff1a;border-radius:8px;border-left:4px solid #409eff}.stats-item.success[data-v-0e22a33f]{background:#18a0581a;border-left-color:#18a058}.stats-item.warning[data-v-0e22a33f]{background:#f08a001a;border-left-color:#f08a00}.stats-item .stats-icon[data-v-0e22a33f]{font-size:20px;margin-right:12px}.stats-item .stats-text[data-v-0e22a33f]{font-size:16px;color:#333}.stats-summary[data-v-0e22a33f]{display:flex;align-items:center;padding:16px;background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;border-radius:12px;font-weight:600;font-size:18px;text-align:center;justify-content:center}.stats-summary .stats-icon[data-v-0e22a33f]{font-size:24px;margin-right:12px}@media (max-width: 768px){.note-match-container[data-v-0e22a33f]{padding:16px}.header h2[data-v-0e22a33f]{font-size:24px}.main-card[data-v-0e22a33f] .n-card-content,.result-card[data-v-0e22a33f] .n-card-content{padding:16px}}.button-container[data-v-3acfd1ee]{padding:20px}.kuaishou-container[data-v-4eb60829]{padding:24px;max-width:1000px;margin:0 auto;background:linear-gradient(135deg,#667eea,#764ba2);min-height:100vh}.tool-card[data-v-4eb60829]{background:#fffffff2;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);border-radius:16px;box-shadow:0 8px 32px #0000001a;border:1px solid rgba(255,255,255,.2)}.tool-card[data-v-4eb60829] .n-card-content{padding:24px}[data-v-4eb60829] .n-button{border-radius:12px;font-weight:500;transition:all .3s ease}[data-v-4eb60829] .n-button:hover{transform:translateY(-2px);box-shadow:0 4px 16px #00000026}[data-v-4eb60829] .n-input{border-radius:8px}[data-v-4eb60829] .n-form-item-label{font-weight:500;color:#333}[data-v-4eb60829] .n-collapse,[data-v-4eb60829] .n-table{border-radius:8px;overflow:hidden}.kuaishou-container[data-v-4830d34f]{padding:24px;max-width:1000px;margin:0 auto;background:linear-gradient(135deg,#667eea,#764ba2);min-height:100vh}.tool-card[data-v-4830d34f]{background:#fffffff2;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);border-radius:16px;box-shadow:0 8px 32px #0000001a;border:1px solid rgba(255,255,255,.2)}.tool-card[data-v-4830d34f] .n-card-content{padding:24px}[data-v-4830d34f] .n-button{border-radius:12px;font-weight:500;transition:all .3s ease}[data-v-4830d34f] .n-button:hover{transform:translateY(-2px);box-shadow:0 4px 16px #00000026}[data-v-4830d34f] .n-input{border-radius:8px}[data-v-4830d34f] .n-form-item-label{font-weight:500;color:#333}[data-v-4830d34f] .n-collapse,[data-v-4830d34f] .n-table{border-radius:8px;overflow:hidden}.kuaishou-ad-creator[data-v-654ceeb0]{max-width:1000px;margin:0 auto;padding:20px;font-family:Arial,sans-serif}.form-section[data-v-654ceeb0]{margin-bottom:20px}.form-section h2[data-v-654ceeb0]{color:#333;margin-bottom:20px}.form-section h3[data-v-654ceeb0]{color:#555;margin:15px 0 10px}.form-group[data-v-654ceeb0]{margin-bottom:20px}.form-group label[data-v-654ceeb0]{display:block;margin-bottom:8px;font-weight:700;color:#444}.form-group textarea[data-v-654ceeb0]{width:100%;padding:10px;border:1px solid #ccc;border-radius:4px;box-sizing:border border-box;font-family:monospace;font-size:14px}.form-group textarea[readonly][data-v-654ceeb0]{background-color:#f9f9f9;color:#666}.hint[data-v-654ceeb0]{margin-top:5px;font-size:12px;color:#666;font-style:italic}.action-section[data-v-654ceeb0]{margin:20px 0;text-align:center}button[data-v-654ceeb0]{padding:12px 30px;background-color:#007bff;color:#fff;border:none;border-radius:4px;cursor:pointer;font-size:16px;transition:background-color .3s}button[data-v-654ceeb0]:disabled{background-color:#ccc;cursor:not-allowed}button[data-v-654ceeb0]:hover:not(:disabled){background-color:#0056b3}.log-section[data-v-654ceeb0]{margin-top:20px}.log-content[data-v-654ceeb0]{height:300px;overflow-y:auto;padding:15px;background-color:#f8f9fa;border:1px solid #ddd;border-radius:4px;font-family:monospace;font-size:14px;white-space:pre-wrap}.info[data-v-654ceeb0]{color:#333}.success[data-v-654ceeb0]{color:green}.error[data-v-654ceeb0]{color:red}.warning[data-v-654ceeb0]{color:orange}.kuaishou-ad-creator[data-v-e2ee36d7]{max-width:1000px;margin:0 auto;padding:20px;font-family:Arial,sans-serif}.form-section[data-v-e2ee36d7]{margin-bottom:20px}.form-section h2[data-v-e2ee36d7]{color:#333;margin-bottom:20px}.form-section h3[data-v-e2ee36d7]{color:#555;margin:15px 0 10px}.form-group[data-v-e2ee36d7]{margin-bottom:20px}.form-group label[data-v-e2ee36d7]{display:block;margin-bottom:8px;font-weight:700;color:#444}.form-group textarea[data-v-e2ee36d7]{width:100%;padding:10px;border:1px solid #ccc;border-radius:4px;box-sizing:border border-box;font-family:monospace;font-size:14px}.form-group textarea[readonly][data-v-e2ee36d7]{background-color:#f9f9f9;color:#666}.hint[data-v-e2ee36d7]{margin-top:5px;font-size:12px;color:#666;font-style:italic}.action-section[data-v-e2ee36d7]{margin:20px 0;text-align:center}button[data-v-e2ee36d7]{padding:12px 30px;background-color:#007bff;color:#fff;border:none;border-radius:4px;cursor:pointer;font-size:16px;transition:background-color .3s}button[data-v-e2ee36d7]:disabled{background-color:#ccc;cursor:not-allowed}button[data-v-e2ee36d7]:hover:not(:disabled){background-color:#0056b3}.log-section[data-v-e2ee36d7]{margin-top:20px}.log-content[data-v-e2ee36d7]{height:300px;overflow-y:auto;padding:15px;background-color:#f8f9fa;border:1px solid #ddd;border-radius:4px;font-family:monospace;font-size:14px;white-space:pre-wrap}.info[data-v-e2ee36d7]{color:#333}.success[data-v-e2ee36d7]{color:green}.error[data-v-e2ee36d7]{color:red}.warning[data-v-e2ee36d7]{color:orange}.button-container[data-v-ddd76544]{padding:20px}.hunjianpiliang-container[data-v-866e6680]{padding:24px;max-width:1200px;margin:0 auto;background:linear-gradient(135deg,#667eea,#764ba2);min-height:100vh}.main-card[data-v-866e6680]{background:#fffffff2;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);border-radius:16px;box-shadow:0 8px 32px #0000001a;border:1px solid rgba(255,255,255,.2)}.main-card[data-v-866e6680] .n-card-content{padding:24px}[data-v-866e6680] .n-button{border-radius:12px;font-weight:500;transition:all .3s ease}[data-v-866e6680] .n-button:hover{transform:translateY(-2px);box-shadow:0 4px 16px #00000026}[data-v-866e6680] .n-input{border-radius:8px}[data-v-866e6680] .n-form-item-label{font-weight:500;color:#333}[data-v-866e6680] .n-collapse,[data-v-866e6680] .n-data-table{border-radius:8px;overflow:hidden}.hunjianpiliang-container[data-v-f1625577]{padding:24px;max-width:1200px;margin:0 auto;background:linear-gradient(135deg,#667eea,#764ba2);min-height:100vh}.main-card[data-v-f1625577]{background:#fffffff2;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);border-radius:16px;box-shadow:0 8px 32px #0000001a;border:1px solid rgba(255,255,255,.2)}.main-card[data-v-f1625577] .n-card-content{padding:24px}[data-v-f1625577] .n-button{border-radius:12px;font-weight:500;transition:all .3s ease}[data-v-f1625577] .n-button:hover{transform:translateY(-2px);box-shadow:0 4px 16px #00000026}[data-v-f1625577] .n-input{border-radius:8px}[data-v-f1625577] .n-form-item-label{font-weight:500;color:#333}[data-v-f1625577] .n-collapse,[data-v-f1625577] .n-data-table{border-radius:8px;overflow:hidden}.button-container[data-v-4c94ffe2]{padding:20px;background:linear-gradient(135deg,#667eea,#764ba2);min-height:100vh}.kanban-table-container[data-v-18710e37]{max-height:calc(100vh - 100px);overflow:auto}pre[data-v-18710e37]{white-space:pre-wrap;word-wrap:break-word;background-color:#f5f5f5;padding:10px;border-radius:4px;max-height:60vh;overflow-y:auto;font-size:12px}[data-v-18710e37] .n-data-table th,[data-v-18710e37] .n-data-table td{padding:4px 8px!important;font-size:12px!important}[data-v-18710e37] .n-card__content{padding:10px!important}.option-container[data-v-9eb581f0]{padding:20px;max-width:800px;margin:0 auto}th[data-v-9eb581f0],td[data-v-9eb581f0]{text-align:left;padding:12px 8px}[data-v-9eb581f0] .n-collapse-item__header-main{font-weight:500}[data-v-9eb581f0] .n-dynamic-tags .n-tag{margin-right:8px;margin-bottom:8px}[data-v-9eb581f0] .n-card__content{padding:20px!important}.button-container[data-v-1b23b5f3]{padding:20px} ");

(function (vue, C) {
	'use strict';

	var e=Object.getOwnPropertyNames;var Q,Z,ee=(Q={"main-hZHtsOGo.js"(e,Q){class Z{constructor(){this.isLoading=false,this.tableData=[],this.responseData=[],this.stats={totalCreativity:0,clickUrlCounts:[],expoUrlCounts:[]};}async checkLinks(){this.isLoading=true,this.clearData();try{const e=await this.fetchAllData();return this.responseData=e,this.tableData=e,this.processStats(e),console.log("读取成功"),{success:!0,data:e}}catch(e){return console.error("请求或处理数据时出错:",e),{success:false,error:e.message}}finally{this.isLoading=false;}}async fetchAllData(){let e=4,t=1,a=1,l=[];do{const n=this.getHeaders(),o=await fetch(`https://ad.xiaohongshu.com/api/leona/rtb/creativity/list?pageNum=${t}&pageSize=50`,{method:"POST",headers:n,body:JSON.stringify({startTime:(new Date).toISOString().split("T")[0],endTime:(new Date).toISOString().split("T")[0],pageNum:t,pageSize:50})}),s=await o.json();if(!(s&&s.data&&s.data.list))throw new Error("API 返回数据格式不正确");l=l.concat(s.data.list),a=s.data.totalPage,e=s.data.totalPage,t++;}while(t<=a&&t<=e);return l}getHeaders(){const e={accept:"application/json, text/plain, */*","accept-language":"zh-CN,zh;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6","content-type":"application/json;charset=UTF-8",priority:"u=1, i","sec-ch-ua":'"Not A(Brand";v="8", "Chromium";v="132", "Microsoft Edge";v="132"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"Windows"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin",Referer:location.href,Origin:location.origin,"User-Agent":navigator.userAgent};return  -1!==location.href.indexOf("vSellerId")&&(e["v-seller-id"]=location.search.match(new RegExp("(?<=vSellerId=)[0-9a-z].*","g"))),e}processStats(e){this.stats.totalCreativity=new Set(e.map(e=>e.creativityId)).size;const t=(e,t)=>{const a={};return e.forEach(e=>{Array.isArray(e[t])&&e[t].forEach(e=>{e&&(a[e]=(a[e]||0)+1);});}),Object.entries(a).map(([e,t])=>({url:e,count:t,displayUrl:this.ellipsisUrl(e)}))};this.stats.clickUrlCounts=t(e,"clickUrls"),this.stats.expoUrlCounts=t(e,"expoUrls");}ellipsisUrl(e,t=30,a=30){return e.length<=t+a+3?e:e.slice(0,t)+"..."+e.slice(-a)}extractUrlParam(e){if(!e)return "";const t=e.match(/https:\/\/magellan\.alimama\.com\/(.*?)&/);return t?t[1]:e}clearData(){this.tableData=[],this.responseData=[],this.stats={totalCreativity:0,clickUrlCounts:[],expoUrlCounts:[]};}downloadCSV(){if(0===this.responseData.length)return void console.log("没有可下载的数据！");const e=[["创建时间","创意名","创意ID","点击链接","曝光链接","笔记id"].join(",")];this.responseData.forEach(t=>{const a=[t.creativityCreateTime||"",t.creativityName||"",t.creativityId||"",JSON.stringify(t.clickUrls)||"",JSON.stringify(t.expoUrls)||"",t.noteId+""||""].map(e=>"string"!=typeof e?e:e.includes(",")||e.includes('"')||e.includes("\n")?`"${e.replace(/"/g,'""')}"`:e);e.push(a.join(","));});const t="\ufeff"+e.join("\n"),a=new Blob([t],{type:"text/csv;charset=utf-8"}),l=URL.createObjectURL(a),n=document.createElement("a"),o=(new Date).toLocaleString().replace(/[/:]/g,"-");n.setAttribute("href",l),n.setAttribute("download",`data_${o}.csv`),document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(l);}getState(){return {isLoading:this.isLoading,tableData:this.tableData,stats:this.stats,hasData:this.responseData.length>0}}}async function ee(e,t){const a={accept:"application/json, text/plain, */*","accept-language":"zh-CN,zh;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6","content-type":"application/json;charset=UTF-8",priority:"u=1, i","sec-ch-ua":'"Not(A:Brand";v="99", "Microsoft Edge";v="133", "Chromium";v="133"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"macOS"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin","x-b3-traceid":"dee287ce9b6526cc"};return  -1!=location.href.indexOf("vSellerId")&&(a["v-seller-id"]=location.search.match(new RegExp("(?<=vSellerId=)[0-9a-z].*","g"))),fetch("https://ad.xiaohongshu.com/api/leona/rtb/creativity/batch/update/name",{headers:a,referrerPolicy:"strict-origin-when-cross-origin",body:`{"creativityId":${e},"creativityName":"${t}"}`,method:"POST",mode:"cors",credentials:"include"})} void 0!==Q&&Q.exports?Q.exports=Z:"undefined"!=typeof window&&(window.LinkChecker=Z);const te=(e,t)=>{const a=e.__vccOpts||e;for(const[l,n]of t)a[l]=n;return a},ae=te({__name:"rename",props:{show:{type:Boolean,default:false}},emits:["update:show"],setup(e,{emit:p}){const m=p,h=C.useMessage(),v=vue.ref(false),g=vue.ref(""),f=vue.ref(""),y=vue.ref(0),_=vue.ref(0),k=vue.ref(0),b=vue.computed(()=>k.value>0?`正在处理: ${_.value}/${k.value} (${y.value}%)`:"正在处理中...");async function w(){if(g.value){v.value=true,y.value=0,_.value=0,k.value=0;try{await async function(e,t,a){const l=location.href.match(/[0-9]{1,20}/g),n={accept:"application/json, text/plain, */*","accept-language":"zh-CN,zh;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6","content-type":"application/json;charset=UTF-8",priority:"u=1, i","sec-ch-ua":'"Not(A:Brand";v="99", "Microsoft Edge";v="133", "Chromium";v="133"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"macOS"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin"};-1!=location.href.indexOf("vSellerId")&&(n["v-seller-id"]=location.search.match(new RegExp("(?<=vSellerId=)[0-9a-z].*","g")));const o=await fetch("https://ad.xiaohongshu.com/api/leona/rtb/creativity/list",{headers:n,referrerPolicy:"strict-origin-when-cross-origin",body:`{"campaignId":${l[0]},"unitId":${l[1]},"startTime":"${(new Date).toISOString().split("T")[0]}","endTime":"${(new Date).toISOString().split("T")[0]}","pageNum":1,"pageSize":50}`,method:"POST",mode:"cors",credentials:"include"}),s=(await o.json()).data.list,i=s.length;a&&a(0,0,i);for(let r=0;r<i;r++){const l=s[r],n=l.creativityName.replace(new RegExp(e,"g"),t);if(await ee(l.creativityId,n),a){const e=(r+1)/i*100;a(Math.round(e),r+1,i);}}}(g.value,f.value,(e,t,a)=>{y.value=e,_.value=t,k.value=a;}),h.success("批量重命名操作已完成！"),g.value="",f.value="",m("update:show",!1);}catch(e){h.error("重命名过程中发生错误"),console.error(e);}finally{v.value=false;}}else h.warning("请输入要被替换的旧字符");}function x(){g.value="",f.value="",y.value=0,_.value=0,k.value=0,m("update:show",false);}return (e,t)=>{const a=vue.resolveComponent("n-input"),p=vue.resolveComponent("n-progress"),m=vue.resolveComponent("n-text"),h=vue.resolveComponent("n-space"),_=vue.resolveComponent("n-button");return vue.openBlock(),vue.createElementBlock("div",null,[vue.createVNode(h,{vertical:""},{default:vue.withCtx(()=>[vue.createVNode(a,{value:g.value,"onUpdate:value":t[0]||(t[0]=e=>g.value=e),placeholder:"输入要被替换的旧字符"},null,8,["value"]),vue.createVNode(a,{value:f.value,"onUpdate:value":t[1]||(t[1]=e=>f.value=e),placeholder:"输入用于替换的新字符"},null,8,["value"]),v.value?(vue.openBlock(),vue.createBlock(p,{key:0,type:"line",percentage:y.value,"indicator-placement":"inside",processing:""},null,8,["percentage"])):vue.createCommentVNode("",true),v.value?(vue.openBlock(),vue.createBlock(m,{key:1,depth:"3",style:{"text-align":"center"}},{default:vue.withCtx(()=>[vue.createTextVNode(vue.toDisplayString(b.value),1)]),_:1})):vue.createCommentVNode("",true)]),_:1}),vue.createVNode(h,{justify:"end",style:{"margin-top":"20px"}},{default:vue.withCtx(()=>[vue.createVNode(_,{onClick:x},{default:vue.withCtx(()=>t[2]||(t[2]=[vue.createTextVNode("取消",-1)])),_:1,__:[2]}),vue.createVNode(_,{type:"primary",onClick:w,loading:v.value},{default:vue.withCtx(()=>[vue.createTextVNode(vue.toDisplayString(v.value?"处理中...":"确认替换"),1)]),_:1},8,["loading"])]),_:1})])}}},[["__scopeId","data-v-9e16403e"]]),le=te({__name:"BatchPrice",props:{show:{type:Boolean,default:false}},emits:["update:show"],setup(e,{emit:a}){const r=e,c=a,h=C.useMessage(),y=vue.ref(null),_=vue.ref(false),k=vue.ref(false),b=vue.ref(false),w=vue.ref(0),x=vue.ref(""),I=vue.reactive({mode:"all",price:null,unitIds:""}),S=[{label:"全部调价",value:"all"},{label:"指定单元ID调价",value:"uid"}],T={mode:{required:true,message:"请选择调价模式",trigger:"change"},price:{required:true,validator:(e,t)=>t||0===t?!(t<0)||new Error("价格不能为负数"):new Error("请输入调整价格"),trigger:["input","blur"]},unitIds:{trigger:["input","blur"],validator(e,t){if("uid"===I.mode){if(!t)return new Error("请输入单元ID列表");if(0===t.trim().split(/\s+/).length)return new Error("请输入有效的单元ID")}return  true}}};vue.watch(()=>r.show,e=>{_.value=e;}),vue.watch(_,e=>{c("update:show",e);});const C$1=e=>{I.mode=e;},$=()=>{_.value=false,y.value?.restoreValidation();},z=()=>Math.floor(Date.now()/1e3),U=(e,t)=>(e.removeBind=0,e.sourceFlag="web",e.pageEnterTime=z()-10,e.pageSubmitTime=z(),e.keywordWithBid&&Array.isArray(e.keywordWithBid)&&e.keywordWithBid.forEach(e=>{e.bid=100*t;}),e),q=async e=>{const t={};["sourceFlag","unitId","unitName","promotionTarget","keywordWithBid","targetConfig","phraseMatchTypeUpgrade","removeBind","noteIds","keywordGenType","pageEnterTime","pageSubmitTime"].forEach(a=>{if(e.hasOwnProperty(a))if("pageEnterTime"===a||"pageSubmitTime"===a){const l=e[a];"number"==typeof l&&10===l.toString().length?t[a]=1e3*l:t[a]=l;}else t[a]=e[a];}),t.keywordGenType=0;const a=Date.now();t.pageSubmitTime=a;const l={accept:"application/json, text/plain, */*","accept-language":"zh-CN,zh;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6","content-type":"application/json",priority:"u=1, i","sec-ch-ua":'"Not;A=Brand";v="99", "Microsoft Edge";v="139", "Chromium";v="139"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"macOS"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin","x-t":a};-1!==location.href.indexOf("vSellerId")&&(l["v-seller-id"]=location.search.match(new RegExp("(?<=vSellerId=)[0-9a-z].*","g")));try{const e=await fetch("https://ad.xiaohongshu.com/api/leona/rtb/unit",{headers:l,referrerPolicy:"strict-origin-when-cross-origin",body:JSON.stringify(t),method:"PUT",mode:"cors",credentials:"include"});return await e.json()}catch(n){throw console.error("请求出错:",n),n}},D=e=>{e.preventDefault(),y.value?.validate(async e=>{if(e)h.error("请检查表单填写是否正确");else {b.value=true,k.value=true,w.value=0,x.value="正在获取单元数据...";try{const e=await(async()=>{const e={accept:"application/json, text/plain, */*","accept-language":"zh-CN,zh;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6","content-type":"application/json",priority:"u=1, i","sec-ch-ua":'"Chromium";v="134", "Not:A-Brand";v="24", "Microsoft Edge";v="134"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"Windows"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin"};-1!==location.href.indexOf("vSellerId")&&(e["v-seller-id"]=location.search.match(new RegExp("(?<=vSellerId=)[0-9a-z].*","g")));let t=[],a=1,l=1;do{const n=await fetch("https://ad.xiaohongshu.com/api/leona/rtb/unit/search",{headers:e,referrer:"https://ad.xiaohongshu.com/aurora/ad/manage/creativity",referrerPolicy:"strict-origin-when-cross-origin",body:JSON.stringify({startTime:(new Date).toISOString().split("T")[0],endTime:(new Date).toISOString().split("T")[0],pageNum:a,pageSize:100,placementList:[2]}),method:"POST",mode:"cors",credentials:"include"}),o=await n.json();t=t.concat(o.data.list),l=o.data.totalPage,a++;}while(a<=l);return t})();h.info(`获取到 ${e.length} 个单元`);let a=[];"all"===I.mode?a=e:(a=((e,t)=>{const a=t.trim().split(/\s+/);return e.filter(e=>a.includes(String(e.unitId)))})(e,I.unitIds),h.info(`筛选出 ${a.length} 个指定单元`));const l=[];for(let o=0;o<a.length;o++){const e=a[o];w.value=Math.round((o+1)/a.length*100),x.value=`正在调整单元: ${e.unitName} (${o+1}/${a.length})`;try{const t=U({...e},I.price),a=await q(t);l.push({unitName:e.unitName,unitId:e.unitId,success:"成功"===a.msg,message:a.msg}),await new Promise(e=>setTimeout(e,700));}catch(t){l.push({unitName:e.unitName,unitId:e.unitId,success:!1,message:t.message||"请求失败"});}}const n=l.filter(e=>e.success).length;h.success(`调整完成！成功: ${n}/${l.length}`),console.log("调价结果:",l),_.value=!1;}catch(t){h.error("操作失败: "+(t.message||"未知错误")),console.error("调价过程中出错:",t);}finally{b.value=false,k.value=false;}}});};return (e,t)=>{const a=vue.resolveComponent("n-select"),r=vue.resolveComponent("n-form-item"),c=vue.resolveComponent("n-input-number"),p=vue.resolveComponent("n-input"),m=vue.resolveComponent("n-form"),h=vue.resolveComponent("n-button"),N=vue.resolveComponent("n-space"),z=vue.resolveComponent("n-modal"),U=vue.resolveComponent("n-text"),q=vue.resolveComponent("n-progress");return vue.openBlock(),vue.createElementBlock(vue.Fragment,null,[vue.createVNode(z,{show:_.value,"onUpdate:show":t[3]||(t[3]=e=>_.value=e),preset:"card",style:{width:"600px"},title:"批量调整出价","mask-closable":false,"close-on-esc":false},{footer:vue.withCtx(()=>[vue.createVNode(N,{justify:"end"},{default:vue.withCtx(()=>[vue.createVNode(h,{onClick:$},{default:vue.withCtx(()=>t[5]||(t[5]=[vue.createTextVNode("取消",-1)])),_:1,__:[5]}),vue.createVNode(h,{type:"primary",onClick:D,loading:b.value},{default:vue.withCtx(()=>[vue.createTextVNode(vue.toDisplayString(b.value?"调整中...":"确认调整"),1)]),_:1},8,["loading"])]),_:1})]),default:vue.withCtx(()=>[vue.createVNode(m,{model:I,rules:T,ref_key:"formRef",ref:y},{default:vue.withCtx(()=>[vue.createVNode(r,{label:"调价模式",path:"mode"},{default:vue.withCtx(()=>[vue.createVNode(a,{value:I.mode,"onUpdate:value":[t[0]||(t[0]=e=>I.mode=e),C$1],options:S},null,8,["value"])]),_:1}),vue.createVNode(r,{label:"调整价格",path:"price"},{default:vue.withCtx(()=>[vue.createVNode(c,{value:I.price,"onUpdate:value":t[1]||(t[1]=e=>I.price=e),"show-button":false,placeholder:"请输入要调整的价格",style:{width:"100%"}},null,8,["value"])]),_:1}),vue.withDirectives(vue.createVNode(r,{label:"单元ID列表",path:"unitIds"},{default:vue.withCtx(()=>[vue.createVNode(p,{value:I.unitIds,"onUpdate:value":t[2]||(t[2]=e=>I.unitIds=e),type:"textarea",placeholder:"请输入单元ID，每行一个",autosize:{minRows:3,maxRows:6}},null,8,["value"])]),_:1},512),[[vue.vShow,"uid"===I.mode]])]),_:1},8,["model"])]),_:1},8,["show"]),vue.createVNode(z,{show:k.value,"onUpdate:show":t[4]||(t[4]=e=>k.value=e),preset:"card",style:{width:"500px"},title:"调整进度","mask-closable":false,"close-on-esc":false},{default:vue.withCtx(()=>[vue.createVNode(N,{vertical:""},{default:vue.withCtx(()=>[vue.createVNode(U,null,{default:vue.withCtx(()=>t[6]||(t[6]=[vue.createTextVNode("正在调整出价，请稍候...",-1)])),_:1,__:[6]}),vue.createVNode(q,{type:"line",percentage:w.value,"indicator-placement":"inside",processing:""},null,8,["percentage"]),vue.createVNode(U,{depth:"3"},{default:vue.withCtx(()=>[vue.createTextVNode(vue.toDisplayString(x.value),1)]),_:1})]),_:1})]),_:1},8,["show"])],64)}}},[["__scopeId","data-v-29be6a47"]]),ne=te({__name:"setplan",props:{show:{type:Boolean,default:false}},emits:["update:show"],setup(e,{emit:a}){const r=a,c=C.useMessage(),m=vue.ref(null),h=vue.ref(false),v=vue.ref(false),g=vue.ref(0),f=vue.ref(""),y=vue.ref(""),_=vue.reactive({searchType:"creativeId",actionType:"2",inputContent:""}),k=[{label:"创意ID",value:"creativeId"},{label:"文字匹配",value:"name"},{label:"笔记ID",value:"noteId"}],b=[{label:"关闭",value:"2"},{label:"开启",value:"1"}],w={searchType:{required:true,message:"请选择搜索方式",trigger:"change"},actionType:{required:true,message:"请选择操作类型",trigger:"change"},inputContent:{required:true,trigger:["input","blur"],validator:(e,t)=>t?0!==t.trim().split(/\r?\n/).filter(e=>""!==e.trim()).length||new Error("请输入有效内容"):new Error("请输入内容")}},x=(e,t)=>{const a=[];for(let l=0;l<e.length;l+=t)a.push(e.slice(l,l+t));return a},I=async(e,t)=>{const a="1"===t?"开启":"关闭",l={accept:"application/json, text/plain, */*","accept-language":"zh-CN,zh;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6","content-type":"application/json;charset=UTF-8",priority:"u=1, i","sec-ch-ua":'"Not(A:Brand";v="99", "Microsoft Edge";v="133", "Chromium";v="133"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"macOS"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin"};-1!==location.href.indexOf("vSellerId")&&(l["v-seller-id"]=location.search.match(new RegExp("(?<=vSellerId=)[0-9a-z].*","g")));for(let o=0;o<e.length;o++){const s=e[o];let i=true,r=0;const u=3;for(g.value=Math.round((o+1)/e.length*100),f.value=`正在${a}创意... (${o+1}/${e.length})`,y.value=`正在处理ID: [${s.join(", ")}]`;i&&r<u;)try{const e=await fetch("https://ad.xiaohongshu.com/api/leona/rtb/creativity/batch/status",{headers:l,referrer:"https://ad.xiaohongshu.com/aurora/ad/manage/creativity",referrerPolicy:"strict-origin-when-cross-origin",body:JSON.stringify({ids:s,actionType:parseInt(t)}),method:"PUT",mode:"cors",credentials:"include"}),n=await e.json();"成功"===n.msg?(c.success(`${a}创意成功: ${JSON.stringify(s)}`),i=!1):(r++,r>=u?(c.error(`${a}创意失败: ${n.msg}, ID: ${JSON.stringify(s)}`),i=!1):await new Promise(e=>setTimeout(e,500)));}catch(n){r++,r>=u?(c.error(`${a}创意出错: ${n.message}, ID: ${JSON.stringify(s)}`),i=false):await new Promise(e=>setTimeout(e,500));}}},S=e=>{e.preventDefault(),m.value?.validate(async e=>{if(e)c.error("请检查表单填写是否正确");else {v.value=true,h.value=true,g.value=0,f.value="开始处理...",y.value="";try{const e=_.inputContent.trim().split(/\r?\n/).map(e=>e.trim()).filter(e=>""!==e);if(0===e.length)return void c.error("请输入有效内容");if("creativeId"===_.searchType){const t=x(e,50);await I(t,_.actionType);}else {if("noteId"===_.searchType){const t=e.filter(e=>e.split("\t")[0].length<=11);if(t.length>0)return void c.error(`以下内容不符合笔记ID格式: ${t.join(", ")}`)}await(async(e,t,a)=>{const l={accept:"application/json, text/plain, */*","accept-language":"zh-CN,zh;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6","content-type":"application/json;charset=UTF-8",priority:"u=1, i","sec-ch-ua":'"Not(A:Brand";v="99", "Microsoft Edge";v="133", "Chromium";v="133"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"macOS"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin"};-1!==location.href.indexOf("vSellerId")&&(l["v-seller-id"]=location.search.match(new RegExp("(?<=vSellerId=)[0-9a-z].*","g")));for(let o=0;o<e.length;o++){const s=e[o];g.value=Math.round((o+1)/e.length*100),f.value=`正在处理: ${s} (${o+1}/${e.length})`;try{let e=s,n=null;if(-1!==s.indexOf("\t")){const t=s.split("\t");e=t[0];const a=t[1];n="信息流"===a?[1]:"搜索"===a?[2]:null;}const o={startTime:(new Date).toISOString().split("T")[0],endTime:(new Date).toISOString().split("T")[0],[a]:e,pageNum:1,pageSize:50};n&&(o.placementList=n);const i=await fetch("https://ad.xiaohongshu.com/api/leona/rtb/creativity/list",{headers:l,referrer:"https://ad.xiaohongshu.com/aurora/ad/manage/creativity",referrerPolicy:"strict-origin-when-cross-origin",body:JSON.stringify(o),method:"POST",mode:"cors",credentials:"include"}),r=await i.json();if(r.data.list.length>0){const e=r.data.list.map(e=>e.creativityId);c.info(`找到 ${e.length} 个创意ID`);const a=x(e,50);await I(a,t);}else c.warning(`未找到匹配的创意: ${e}`);}catch(n){c.error(`处理 ${s} 时出错: ${n.message}`);}}})(e,_.actionType,_.searchType);}c.success("操作完成"),r("update:show",!1);}catch(t){c.error("操作失败: "+(t.message||"未知错误")),console.error("操作过程中出错:",t);}finally{v.value=false,h.value=false;}}});},T=()=>{r("update:show",false),m.value?.restoreValidation();};return (e,t)=>{const a=vue.resolveComponent("n-select"),r=vue.resolveComponent("n-form-item"),c=vue.resolveComponent("n-input"),p=vue.resolveComponent("n-text"),x=vue.resolveComponent("n-form"),I=vue.resolveComponent("n-button"),C=vue.resolveComponent("n-space"),N=vue.resolveComponent("n-progress"),$=vue.resolveComponent("n-modal");return vue.openBlock(),vue.createElementBlock("div",null,[vue.createVNode(x,{model:_,rules:w,ref_key:"formRef",ref:m},{default:vue.withCtx(()=>[vue.createVNode(r,{label:"搜索方式",path:"searchType"},{default:vue.withCtx(()=>[vue.createVNode(a,{value:_.searchType,"onUpdate:value":t[0]||(t[0]=e=>_.searchType=e),options:k},null,8,["value"])]),_:1}),vue.createVNode(r,{label:"操作类型",path:"actionType"},{default:vue.withCtx(()=>[vue.createVNode(a,{value:_.actionType,"onUpdate:value":t[1]||(t[1]=e=>_.actionType=e),options:b},null,8,["value"])]),_:1}),vue.createVNode(r,{label:"输入内容",path:"inputContent"},{default:vue.withCtx(()=>[vue.createVNode(c,{value:_.inputContent,"onUpdate:value":t[2]||(t[2]=e=>_.inputContent=e),type:"textarea",placeholder:"请输入内容，多个内容请换行分隔",autosize:{minRows:4,maxRows:10}},null,8,["value"]),vue.createVNode(p,{depth:"3",style:{"margin-top":"8px",display:"block"}},{default:vue.withCtx(()=>t[4]||(t[4]=[vue.createTextVNode(" 提示：使用创意ID时每行一个；使用笔记ID或文字匹配时，如需指定位置可在内容后加制表符(Tab)和位置(如：信息流、搜索) ",-1)])),_:1,__:[4]})]),_:1})]),_:1},8,["model"]),vue.createVNode(C,{justify:"end",style:{"margin-top":"20px"}},{default:vue.withCtx(()=>[vue.createVNode(I,{onClick:T},{default:vue.withCtx(()=>t[5]||(t[5]=[vue.createTextVNode("取消",-1)])),_:1,__:[5]}),vue.createVNode(I,{type:"primary",onClick:S,loading:v.value},{default:vue.withCtx(()=>[vue.createTextVNode(vue.toDisplayString(v.value?"处理中...":"确认执行"),1)]),_:1},8,["loading"])]),_:1}),vue.createVNode($,{show:h.value,"onUpdate:show":t[3]||(t[3]=e=>h.value=e),preset:"card",style:{width:"500px"},title:"执行进度","mask-closable":false,"close-on-esc":false},{default:vue.withCtx(()=>[vue.createVNode(C,{vertical:""},{default:vue.withCtx(()=>[vue.createVNode(p,null,{default:vue.withCtx(()=>[vue.createTextVNode(vue.toDisplayString(f.value),1)]),_:1}),vue.createVNode(N,{type:"line",percentage:g.value,"indicator-placement":"inside",processing:""},null,8,["percentage"]),vue.createVNode(p,{depth:"3"},{default:vue.withCtx(()=>[vue.createTextVNode(vue.toDisplayString(y.value),1)]),_:1})]),_:1})]),_:1},8,["show"])])}}},[["__scopeId","data-v-66be8dce"]]),oe={class:"createrplan-container"},se={style:{"font-size":"14px"}},ie={style:{"font-size":"16px"}},re=te({__name:"createrplan",setup(e){const a=C.useMessage(),r=vue.ref("old"),c=vue.ref({autoOptimize:false,searchComponent:false,updateNames:false,addKeywords:false,addTracking:false}),p={old:{autoOptimize:".flexible.align-center",searchComponent:".d-grid.d-radio-main-label",creativeNameInput:'input[placeholder="请输入你的创意名称"]',item:".item",commentInput:'input[placeholder="请输入置顶评论文案"]',searchWordInput:'input[placeholder="请输入搜索词"]',linkButton:".link-text",addAction:".add-action",linkInput:'input[placeholder="请输入链接"]',saveButton:".d-button-content .d-text"},new:{autoOptimize:".form-item-main button",searchComponent:".search-component-new",creativeNameInput:'input[placeholder="请输入创意名称"]',item:".creativity-list-container",commentInput:'input[placeholder="请输入置顶评论文案"]',searchWordInput:'input[placeholder="请输入搜索词"]',linkButton:".form-item-main button",addAction:".add-action",linkInput:'input[placeholder="请输入链接"]',saveButton:".d-modal-footer button"}},m=()=>p[r.value],h=vue.ref({baseCreativeName:"",exposureLink:"",clickLink:"",noteMatchingInfo:""});vue.onMounted(()=>{h.value.baseCreativeName=localStorage.getItem("baseCreativeName")||"",h.value.exposureLink=localStorage.getItem("exposureLink")||"",h.value.clickLink=localStorage.getItem("clickLink")||"",h.value.noteMatchingInfo=localStorage.getItem("noteMatchingInfo")||"",r.value=localStorage.getItem("currentVersion")||"old";});const v=()=>{r.value="old"===r.value?"new":"old",localStorage.setItem("currentVersion",r.value),a.success("已切换到"+("old"===r.value?"老版本":"新版本"));},g=(e,t)=>{localStorage.setItem(e,t);},f=e=>new Promise(t=>setTimeout(t,e)),k=async(e,t=null)=>{for(;;){const a=Array.from(document.querySelectorAll(e)).find(e=>!t||e.innerText.includes(t));if(a)return a;await f(100);}},b=async(e,t)=>{for(;;){const a=document.querySelectorAll(e);if(a.length>=t)return a;await f(100);}},w=()=>h.value.noteMatchingInfo.trim().split("\n").map(e=>e.trim().split("\t")),x=async()=>{c.value.autoOptimize=true;try{const e=m();document.querySelectorAll(e.autoOptimize).forEach(e=>{"关闭"===e.innerText&&e.click();}),a.success(`已关闭自动优化 (${r.value}版本)`);}catch(e){a.error("关闭自动优化失败: "+e.message);}finally{c.value.autoOptimize=false;}},I=async()=>{c.value.searchComponent=true;try{const e=m();document.querySelectorAll(e.searchComponent).forEach(e=>{"搜索组件"===e.innerText&&e.click();}),a.success(`已点击搜索组件 (${r.value}版本)`);}catch(e){a.error("点击搜索组件失败: "+e.message);}finally{c.value.searchComponent=false;}},S=async()=>{if("new"===r.value){const e=m(),t=h.value.baseCreativeName;if(!t)return void a.warning("请先输入基础创意名称");const l=document.querySelectorAll(".promotion-note-content-info span:nth-child(3)");console.log(l);const n=document.querySelectorAll(e.creativeNameInput);console.log(n);for(let a=0;a<n.length;a++){const e=n[a];e.value=t.replace("达人昵称",l[a].innerText.split(" ")[0]),e.dispatchEvent(new Event("input"));}}else {c.value.updateNames=true;try{const e=h.value.baseCreativeName,t=w(),l=m();if(!e)return void a.warning("请先输入基础创意名称");document.querySelectorAll(l.item).forEach(a=>{const n=a.querySelectorAll("td");if(n.length>=4){const o=n[1].innerText,s=n[3].innerText,i=t.find(e=>e[1]===o)?.[0];if(i){const t=a.querySelector(l.creativeNameInput);if(t){const a=e.replace("达人昵称",s).replace("场景",i);t.value=a,t.dispatchEvent(new Event("input"));}}else {const t=a.querySelector(l.creativeNameInput);if(t){const a=e.replace("达人昵称",s);t.value=a,t.dispatchEvent(new Event("input"));}}}}),a.success(`已完成创意名称修改 (${r.value}版本)`);}catch(e){a.error("修改创意名称失败: "+e.message);}finally{c.value.updateNames=false;}}},T=async()=>{c.value.addKeywords=true;try{const e=w(),t=m();document.querySelectorAll(t.item).forEach(a=>{const l=a.querySelectorAll("td");if(l.length>=2){const n=l[1].innerText,o=e.find(e=>e[1]===n)?.[2];o&&[a.querySelectorAll(t.commentInput)[1],a.querySelector(t.searchWordInput)].forEach((e,t)=>{e&&(e.value=0===t?o:o.match(new RegExp("(?<=【).*?(?=】)","g"))?.[0]||"",e.dispatchEvent(new Event("input",{bubbles:!0,cancelable:!0,composed:!0})));});}}),a.success(`已完成搜索词添加 (${r.value}版本)`);}catch(e){a.error("添加搜索词失败: "+e.message);}finally{c.value.addKeywords=false;}},C$1=async()=>{c.value.addTracking=true;try{const e=[h.value.exposureLink,h.value.clickLink],t=m();if(!e[0]||!e[1])return void a.warning("请先输入曝光链接和点击链接");const l=Array.from(document.querySelectorAll(t.linkButton)).filter(e=>"添加监测链接"===e.innerText||"去配置"===e.innerText);for(const a of l)a.click(),await b(t.addAction,2),document.querySelectorAll(t.addAction).forEach(e=>e.click()),await f(1e3),(await b(t.linkInput,2)).forEach((t,a)=>{e[a]&&(t.value=e[a],t.dispatchEvent(new Event("input")));}),await f(1e3),(await k(t.saveButton,"保存")).click(),await f(1e3);a.success(`已完成监测链接添加 (${r.value}版本)`);}catch(e){a.error("添加监测链接失败: "+e.message);}finally{c.value.addTracking=false;}},$=()=>{try{["baseCreativeName","exposureLink","clickLink","noteMatchingInfo"].forEach(e=>{localStorage.removeItem(e),h.value[e]="";}),a.success("已清除所有数据");}catch(e){a.error("清除数据失败: "+e.message);}};return (e,t)=>{const a=vue.resolveComponent("n-tag"),p=vue.resolveComponent("n-input"),m=vue.resolveComponent("n-form-item"),f=vue.resolveComponent("n-button"),y=vue.resolveComponent("n-grid-item"),k=vue.resolveComponent("n-grid"),b=vue.resolveComponent("n-space"),w=vue.resolveComponent("n-card");return vue.openBlock(),vue.createElementBlock("div",oe,[vue.createVNode(w,{title:"小红书创意计划工具1.2",class:"main-card"},{"header-extra":vue.withCtx(()=>[vue.createVNode(a,{type:"old"===r.value?"warning":"success",size:"large"},{icon:vue.withCtx(()=>[vue.createElementVNode("span",se,vue.toDisplayString("old"===r.value?"🕰️":"🚀"),1)]),default:vue.withCtx(()=>[vue.createTextVNode(" "+vue.toDisplayString("old"===r.value?"老版本":"新版本"),1)]),_:1},8,["type"])]),default:vue.withCtx(()=>[vue.createVNode(b,{vertical:""},{default:vue.withCtx(()=>[vue.createVNode(m,{label:"基础创意名称"},{default:vue.withCtx(()=>[vue.createVNode(p,{value:h.value.baseCreativeName,"onUpdate:value":[t[0]||(t[0]=e=>h.value.baseCreativeName=e),t[1]||(t[1]=e=>g("baseCreativeName",e))],placeholder:"请输入基础创意名称 【达人昵称】-信息流"},null,8,["value"])]),_:1}),vue.createVNode(m,{label:"曝光链接"},{default:vue.withCtx(()=>[vue.createVNode(p,{value:h.value.exposureLink,"onUpdate:value":[t[2]||(t[2]=e=>h.value.exposureLink=e),t[3]||(t[3]=e=>g("exposureLink",e))],placeholder:"请输入曝光链接"},null,8,["value"])]),_:1}),vue.createVNode(m,{label:"点击链接"},{default:vue.withCtx(()=>[vue.createVNode(p,{value:h.value.clickLink,"onUpdate:value":[t[4]||(t[4]=e=>h.value.clickLink=e),t[5]||(t[5]=e=>g("clickLink",e))],placeholder:"请输入点击链接"},null,8,["value"])]),_:1}),vue.createVNode(m,{label:"笔记匹配信息"},{default:vue.withCtx(()=>[vue.createVNode(p,{value:h.value.noteMatchingInfo,"onUpdate:value":[t[6]||(t[6]=e=>h.value.noteMatchingInfo=e),t[7]||(t[7]=e=>g("noteMatchingInfo",e))],type:"textarea",placeholder:"直接从EXCEL中复制格式：\n小红书笔记id 达人昵称 ",autosize:{minRows:4,maxRows:6}},null,8,["value"])]),_:1}),vue.createVNode(k,{cols:3,"x-gap":12,"y-gap":12},{default:vue.withCtx(()=>[vue.createVNode(y,null,{default:vue.withCtx(()=>[vue.createVNode(f,{type:"primary",block:"",onClick:x,loading:c.value.autoOptimize},{icon:vue.withCtx(()=>t[8]||(t[8]=[vue.createElementVNode("span",{style:{"font-size":"16px"}},"⚙️",-1)])),default:vue.withCtx(()=>[t[9]||(t[9]=vue.createTextVNode(" 关闭自动优化 ",-1))]),_:1,__:[9]},8,["loading"])]),_:1}),vue.createVNode(y,null,{default:vue.withCtx(()=>[vue.createVNode(f,{type:"primary",block:"",onClick:I,loading:c.value.searchComponent},{icon:vue.withCtx(()=>t[10]||(t[10]=[vue.createElementVNode("span",{style:{"font-size":"16px"}},"🔍",-1)])),default:vue.withCtx(()=>[t[11]||(t[11]=vue.createTextVNode(" 点击搜索组件 ",-1))]),_:1,__:[11]},8,["loading"])]),_:1}),vue.createVNode(y,null,{default:vue.withCtx(()=>[vue.createVNode(f,{type:"old"===r.value?"success":"warning",block:"",onClick:v},{icon:vue.withCtx(()=>[vue.createElementVNode("span",ie,vue.toDisplayString("old"===r.value?"🚀":"🕰️"),1)]),default:vue.withCtx(()=>[vue.createTextVNode(" 切换到"+vue.toDisplayString("old"===r.value?"新版本":"老版本"),1)]),_:1},8,["type"])]),_:1}),vue.createVNode(y,null,{default:vue.withCtx(()=>[vue.createVNode(f,{type:"info",block:"",onClick:S,loading:c.value.updateNames},{icon:vue.withCtx(()=>t[12]||(t[12]=[vue.createElementVNode("span",{style:{"font-size":"16px"}},"✏️",-1)])),default:vue.withCtx(()=>[t[13]||(t[13]=vue.createTextVNode(" 修改创意名称 ",-1))]),_:1,__:[13]},8,["loading"])]),_:1}),vue.createVNode(y,null,{default:vue.withCtx(()=>[vue.createVNode(f,{type:"info",block:"",onClick:T,loading:c.value.addKeywords},{icon:vue.withCtx(()=>t[14]||(t[14]=[vue.createElementVNode("span",{style:{"font-size":"16px"}},"🏷️",-1)])),default:vue.withCtx(()=>[t[15]||(t[15]=vue.createTextVNode(" 添加搜索词 ",-1))]),_:1,__:[15]},8,["loading"])]),_:1}),vue.createVNode(y,null,{default:vue.withCtx(()=>[vue.createVNode(f,{type:"warning",block:"",onClick:C$1,loading:c.value.addTracking},{icon:vue.withCtx(()=>t[16]||(t[16]=[vue.createElementVNode("span",{style:{"font-size":"16px"}},"🔗",-1)])),default:vue.withCtx(()=>[t[17]||(t[17]=vue.createTextVNode(" 添加监测链接 ",-1))]),_:1,__:[17]},8,["loading"])]),_:1}),vue.createVNode(y,null,{default:vue.withCtx(()=>[vue.createVNode(f,{type:"error",block:"",onClick:$},{icon:vue.withCtx(()=>t[18]||(t[18]=[vue.createElementVNode("span",{style:{"font-size":"16px"}},"🗑️",-1)])),default:vue.withCtx(()=>[t[19]||(t[19]=vue.createTextVNode(" 清除所有数据 ",-1))]),_:1,__:[19]})]),_:1})]),_:1})]),_:1})]),_:1})])}}},[["__scopeId","data-v-5dbab58c"]]),ce={style:{display:"flex","justify-content":"flex-end"}},ue={key:0,style:{"margin-top":"10px",padding:"10px",background:"#f5f5f5","border-radius":"4px","max-height":"200px",overflow:"auto"}},de=te({__name:"plan",setup(e){const a=vue.ref(null),l=vue.ref(false),p=vue.ref(null),m=vue.ref({campaignData:"",limitDayBudget:true,smartSwitch:false}),h={campaignData:{required:true,trigger:["input","blur"],validator(e,t){if(!t)return new Error("请输入计划ID和预算");const a=t.split(/\n/).filter(e=>""!==e.trim());for(const l of a){const e=l.trim().split(/|,|\t| /);if(e.length<2)return new Error("每行需要包含计划ID和预算金额");const t=e[0],a=e[1];if(!/^\d+$/.test(t))return new Error(`计划ID "${t}" 不是有效的数字`);if(!/^\d+$/.test(a))return new Error(`预算金额 "${a}" 不是有效的数字`)}return  true}}},v=async e=>{e.preventDefault();try{await(a.value?.validate()),l.value=!0,p.value=null;const e=(e=>{const t=e.split("\n").filter(e=>""!==e.trim()),a=[];for(const l of t){const e=l.trim().split(/[\s,]+/);e.length>=2&&a.push({campaignId:parseInt(e[0]),campaignDayBudget:100*parseInt(e[1])});}return a})(m.value.campaignData),t={budgetList:e.map(e=>({campaignId:e.campaignId,limitDayBudget:m.value.limitDayBudget?1:0,campaignDayBudget:e.campaignDayBudget,smartSwitch:m.value.smartSwitch?1:0}))};console.log("发送请求:",t);const n=await fetch("https://ad.xiaohongshu.com/api/leona/rtb/campaign/batch/budget",{method:"PUT",headers:{accept:"application/json, text/plain, */*","accept-language":"zh-CN,zh;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6","content-type":"application/json",priority:"u=1, i","sec-ch-ua":'"Microsoft Edge";v="141", "Not?A_Brand";v="8", "Chromium";v="141"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"macOS"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin",referrer:"https://ad.xiaohongshu.com/aurora/ad/manage/campaign?vSellerId=68d51ba511fe6b0015a32390"},body:JSON.stringify(t),credentials:"include"}),o=await n.json();if(!n.ok)throw new Error(o.message||`❌ 请求失败 (${n.status})`);p.value={success:!0,message:`✅ 成功修改 ${e.length} 个计划的预算`,details:o};}catch(t){console.error("提交失败:",t),p.value={success:false,message:`❌ ${t.message||"网络请求失败"}`,details:t};}finally{l.value=false;}};return (e,t)=>(vue.openBlock(),vue.createBlock(vue.unref(C.NCard),{title:"批量修改计划预算"},{default:vue.withCtx(()=>[vue.createVNode(vue.unref(C.NForm),{model:m.value,rules:h,ref_key:"formRef",ref:a},{default:vue.withCtx(()=>[vue.createVNode(vue.unref(C.NFormItem),{label:"计划ID和预算",path:"campaignData"},{default:vue.withCtx(()=>[vue.createVNode(vue.unref(C.NInput),{value:m.value.campaignData,"onUpdate:value":t[0]||(t[0]=e=>m.value.campaignData=e),type:"textarea",autosize:{minRows:5},placeholder:"每行输入一个计划ID和预算，用空格或逗号分隔\n例如:\n150859569 50000\n150886366 90000"},null,8,["value"])]),_:1}),vue.createVNode(vue.unref(C.NRow),{gutter:[0,12]},{default:vue.withCtx(()=>[vue.createVNode(vue.unref(C.NCol),{span:24},{default:vue.withCtx(()=>[vue.createElementVNode("div",ce,[vue.createVNode(vue.unref(C.NButton),{type:"primary",onClick:v,loading:l.value},{default:vue.withCtx(()=>t[1]||(t[1]=[vue.createTextVNode(" 🚀 批量修改预算 ",-1)])),_:1,__:[1]},8,["loading"])])]),_:1})]),_:1})]),_:1},8,["model"]),p.value?(vue.openBlock(),vue.createBlock(vue.unref(C.NCard),{key:0,title:"请求结果",style:{"margin-top":"20px"}},{default:vue.withCtx(()=>[vue.createVNode(vue.unref(C.NAlert),{type:p.value.success?"success":"error"},{icon:vue.withCtx(()=>[vue.createTextVNode(vue.toDisplayString(p.value.success?"✅":"❌"),1)]),default:vue.withCtx(()=>[vue.createTextVNode(" "+vue.toDisplayString(p.value.message),1)]),_:1},8,["type"]),p.value.details?(vue.openBlock(),vue.createElementBlock("pre",ue,"        "+vue.toDisplayString(JSON.stringify(p.value.details,null,2))+"\n      ",1)):vue.createCommentVNode("",true)]),_:1})):vue.createCommentVNode("",true)]),_:1}))}},[["__scopeId","data-v-789feec4"]]),pe={class:"button-container"},me={class:"modal-content"},he=te({__name:"XHS",setup(e){const a=new Z,m=C.useMessage(),h=vue.ref(false),g=vue.ref(false),f=vue.ref([]),y=vue.reactive({totalCreativity:0,clickUrlCounts:[],expoUrlCounts:[]}),k=vue.ref({rename:false,batchPrice:false,setPlan:false,createPlan:false,plan:false}),x=[{key:"rename",title:"修改创意名称",component:ae},{key:"batchPrice",title:"批量调价",component:le},{key:"setPlan",title:"创意关闭",component:ne},{key:"createPlan",title:"红书半自动搭建计划",component:re},{key:"plan",title:"计划调预算",component:de}],I=e=>{k.value[e]=true;},S=[{key:"checkLinks",type:"primary",icon:"🐒",label:h.value?"检查中...":"检查链接",action:async function(){h.value=true;try{const e=await a.checkLinks();if(e.success){console.log("检查成功",e.data);const t=a.getState();f.value=t.tableData,y.totalCreativity=t.stats.totalCreativity,y.clickUrlCounts=t.stats.clickUrlCounts,y.expoUrlCounts=t.stats.expoUrlCounts,g.value=!0,m.success("成功",{duration:3e3,closable:!0});}else console.error("检查失败",e.error),m.info("失败",{duration:3e3,closable:!0});}catch{m.error("失败",{duration:3e3,closable:true});}finally{h.value=false;}},loadingRef:h},{key:"rename",type:"info",icon:"🐒",label:"修改名称",action:()=>I("rename")},{key:"batchPrice",type:"warning",icon:"🐒",label:"批量调价",action:()=>I("batchPrice"),disabled:true},{key:"setPlan",type:"success",icon:"🐒",label:"关闭创意",action:()=>I("setPlan")},{key:"createPlan",type:"success",icon:"🐒",label:"半自动搭建创意",action:()=>I("createPlan")},{key:"plan",type:"success",icon:"🐒",label:"计划调预算",action:()=>I("plan")}],T=[{title:"创建时间",key:"creativityCreateTime",width:150},{title:"创意名",key:"creativityName",resizable:true},{title:"创意ID",key:"creativityId",width:120},{title:"点击链接",key:"clickUrls",render:e=>e.clickUrls?e.clickUrls.map(e=>a.extractUrlParam(e)).join("\n"):""},{title:"曝光链接",key:"expoUrls",render:e=>e.expoUrls?e.expoUrls.map(e=>a.extractUrlParam(e)).join("\n"):""}];function C$1(){a.downloadCSV();}const $=vue.reactive({page:1,pageSize:10,showSizePicker:true,pageSizes:[10,20,50],prefix:({itemCount:e})=>`总共有 ${e} 条数据`,onChange:e=>{$.page=e,console.log(`切换到第 ${e} 页`);},onUpdatePageSize:e=>{$.pageSize=e,$.page=1,console.log(`每页显示 ${e} 条数据`);}});return (e,t)=>{const a=vue.resolveComponent("n-icon"),p=vue.resolveComponent("n-button"),m=vue.resolveComponent("n-space"),h=vue.resolveComponent("n-modal"),I=vue.resolveComponent("n-statistic"),N=vue.resolveComponent("n-card"),z=vue.resolveComponent("n-grid-item"),U=vue.resolveComponent("n-grid"),q=vue.resolveComponent("n-ellipsis"),D=vue.resolveComponent("n-list-item"),O=vue.resolveComponent("n-list"),E=vue.resolveComponent("n-scrollbar"),j=vue.resolveComponent("n-data-table");return vue.openBlock(),vue.createElementBlock("div",pe,[vue.createVNode(m,{justify:"space-between",wrap:""},{default:vue.withCtx(()=>[(vue.openBlock(),vue.createElementBlock(vue.Fragment,null,vue.renderList(S,e=>vue.createVNode(p,{key:e.key,type:e.type,size:"large",style:{flex:"1","min-width":"150px",margin:"4px"},onClick:e.action,loading:!!e.loadingRef&&e.loadingRef.value,disabled:e.disabled||false},{icon:vue.withCtx(()=>[vue.createVNode(a,null,{default:vue.withCtx(()=>[vue.createTextVNode(vue.toDisplayString(e.icon),1)]),_:2},1024)]),default:vue.withCtx(()=>[vue.createTextVNode(" "+vue.toDisplayString(e.label),1)]),_:2},1032,["type","onClick","loading","disabled"])),64))]),_:1}),(vue.openBlock(),vue.createElementBlock(vue.Fragment,null,vue.renderList(x,e=>vue.createVNode(h,{key:e.key,show:k.value[e.key],"onUpdate:show":t=>k.value[e.key]=t,preset:"card",style:{width:"800px","max-width":"90vw"},title:e.title,bordered:false,"mask-closable":true,"close-on-esc":true},{default:vue.withCtx(()=>[(vue.openBlock(),vue.createBlock(vue.resolveDynamicComponent(e.component),{show:k.value[e.key],"onUpdate:show":t=>k.value[e.key]=t},null,40,["show","onUpdate:show"]))]),_:2},1032,["show","onUpdate:show","title"])),64)),vue.createVNode(h,{show:g.value,"onUpdate:show":t[0]||(t[0]=e=>g.value=e),preset:"card",style:{width:"90vw"},title:"链接检查结果","mask-closable":false,"close-on-esc":false},{"header-extra":vue.withCtx(()=>[vue.createVNode(p,{strong:"",secondary:"",onClick:C$1},{default:vue.withCtx(()=>t[1]||(t[1]=[vue.createTextVNode(" 下载数据 ",-1)])),_:1,__:[1]})]),default:vue.withCtx(()=>[vue.createElementVNode("div",me,[y.totalCreativity>0?(vue.openBlock(),vue.createBlock(U,{key:0,cols:3,responsive:"screen","x-gap":12,"y-gap":12},{default:vue.withCtx(()=>[vue.createVNode(z,null,{default:vue.withCtx(()=>[vue.createVNode(N,{title:"总创意数"},{default:vue.withCtx(()=>[vue.createVNode(I,{value:y.totalCreativity},null,8,["value"])]),_:1})]),_:1}),vue.createVNode(z,null,{default:vue.withCtx(()=>[vue.createVNode(N,{title:"点击链接种类"},{default:vue.withCtx(()=>[vue.createVNode(I,{value:y.clickUrlCounts.length},null,8,["value"])]),_:1})]),_:1}),vue.createVNode(z,null,{default:vue.withCtx(()=>[vue.createVNode(N,{title:"曝光链接种类"},{default:vue.withCtx(()=>[vue.createVNode(I,{value:y.expoUrlCounts.length},null,8,["value"])]),_:1})]),_:1})]),_:1})):vue.createCommentVNode("",true),y.clickUrlCounts.length>0?(vue.openBlock(),vue.createBlock(N,{key:1,title:"点击链接统计",style:{"margin-top":"16px"},class:"auto-height-card"},{default:vue.withCtx(()=>[vue.createVNode(E,{style:{"max-height":"150px"}},{default:vue.withCtx(()=>[vue.createVNode(O,null,{default:vue.withCtx(()=>[(vue.openBlock(true),vue.createElementBlock(vue.Fragment,null,vue.renderList(y.clickUrlCounts,e=>(vue.openBlock(),vue.createBlock(D,{key:e.url},{default:vue.withCtx(()=>[vue.createVNode(q,{style:{"max-width":"100%"},tooltip:true},{default:vue.withCtx(()=>[vue.createTextVNode(vue.toDisplayString(e.displayUrl)+" ："+vue.toDisplayString(e.count)+" 条 ",1)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})):vue.createCommentVNode("",true),y.expoUrlCounts.length>0?(vue.openBlock(),vue.createBlock(N,{key:2,title:"曝光链接统计",style:{"margin-top":"16px"}},{default:vue.withCtx(()=>[vue.createVNode(E,{style:{"max-height":"150px"}},{default:vue.withCtx(()=>[vue.createVNode(O,null,{default:vue.withCtx(()=>[(vue.openBlock(true),vue.createElementBlock(vue.Fragment,null,vue.renderList(y.expoUrlCounts,e=>(vue.openBlock(),vue.createBlock(D,{key:e.url},{default:vue.withCtx(()=>[vue.createVNode(q,{style:{"max-width":"100%"},tooltip:true},{default:vue.withCtx(()=>[vue.createTextVNode(vue.toDisplayString(e.displayUrl)+" ："+vue.toDisplayString(e.count)+" 条 ",1)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})):vue.createCommentVNode("",true),vue.createVNode(N,{title:"详细数据",style:{"margin-top":"16px",flex:"1"}},{default:vue.withCtx(()=>[vue.createVNode(j,{columns:T,data:f.value,pagination:$,striped:"",bordered:true},null,8,["data","pagination"])]),_:1})])]),_:1},8,["show"])])}}},[["__scopeId","data-v-dd9dacf7"]]),ve={class:"default-component"},ge=te({__name:"DefaultComponent",setup:e=>(e,t)=>(vue.openBlock(),vue.createElementBlock("div",ve,[vue.createVNode(vue.unref(C.NEmpty),{description:"暂无适配"},{icon:vue.withCtx(()=>[vue.createVNode(vue.unref(C.NIcon),{size:"48"},{default:vue.withCtx(()=>t[0]||(t[0]=[vue.createTextVNode(" 🐒 ",-1)])),_:1,__:[0]})]),_:1})]))},[["__scopeId","data-v-ff0a68db"]]),fe={class:"getchuangyi-container"},ye=te({__name:"getchuangyi",setup(e){const a=C.useMessage(),p=vue.ref(false),m=vue.ref(Date.now()),h=vue.ref([]),v=[{title:"创意名称",key:"creativeName",width:200,ellipsis:{tooltip:true}},{title:"账户名称",key:"accountName",width:200,ellipsis:{tooltip:true}},{title:"计划名称",key:"campaignName",width:200,ellipsis:{tooltip:true}},{title:"创建时间",key:"createTime",width:150},{title:"状态",key:"statusDesc",width:100,render:e=>vue.h("n-tag",{type:{"有效":"success","已被计划暂停":"warning","未知":"default"}[e.statusDesc]||"default",size:"small"},e.statusDesc)},{title:"审核状态",key:"auditStatusDesc",width:120,render:e=>vue.h("n-tag",{type:{"审核通过":"success","审核拒绝":"error","更新待审核":"warning"}[e.auditStatusDesc]||"info",size:"small"},e.auditStatusDesc)},{title:"投放位置",key:"placementDesc",width:100},{title:"创意ID",key:"creativeId",width:120}],g=e=>e?new Date(e).toISOString().split("T")[0]:(new Date).toISOString().split("T")[0],f=async()=>{p.value=true;try{const e={media:"RED_BOOK",pageSize:500,startTime:g(m.value),endTime:g(m.value),pageNo:1},t=await fetch("https://galaxy.alibaba-inc.com/ad/manage/creative",{headers:{accept:"application/json, text/plain, */*","accept-language":"zh-CN,zh;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6",appname:"adcontent-op","bx-v":"2.5.31","content-type":"application/json",priority:"u=1, i","sec-ch-ua":'"Chromium";v="140", "Not=A?Brand";v="24", "Microsoft Edge";v="140"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"macOS"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin"},referrer:"https://galaxy.alibaba-inc.com/",body:JSON.stringify(e),method:"POST",mode:"cors",credentials:"include"});if(!t.ok)throw new Error(`HTTP错误: ${t.status}`);const l=await t.json();if(!(l.success&&l.model&&l.model.result))throw new Error(l.msgInfo||"获取数据失败");{h.value=l.model.result;const e=new Date(m.value),t=new Date(e.getFullYear(),e.getMonth(),e.getDate());console.log(t),h.value=h.value.filter(t=>{const a=new Date(t.createTime);return console.log(a),a.getFullYear()===e.getFullYear()&&a.getMonth()===e.getMonth()&&a.getDate()===e.getDate()}),a.success(`获取成功! 共 ${h.value.length} 条数据`);}}catch(e){console.error("搜索失败:",e),a.error("搜索失败: "+e.message);}finally{p.value=false;}},y=async()=>{try{await b("all"),a.success("数据已复制到剪贴板，可直接粘贴到Excel");}catch(e){a.error("复制失败: "+e.message);}},k=async()=>{try{await b("lastTwo"),a.success("创意ID和笔记id数据已复制到剪贴板，可直接粘贴到Excel");}catch(e){a.error("复制失败: "+e.message);}},b=async(e="all")=>{try{let t,a;"lastTwo"===e?(t=["创意ID","笔记id"],a=h.value.map(e=>[e.creativeId||"",e.contentId||""])):(t=["创意名称","账户名称","计划名称","创建时间","状态","审核状态","投放位置","创意ID","笔记id"],a=h.value.map(e=>[e.creativeName||"",e.accountName||"",e.campaignName||"",e.createTime||"",e.statusDesc||"",e.auditStatusDesc||"",e.placementDesc||"",e.creativeId||"",e.contentId||""]));const l=[t.join("\t"),...a.map(e=>e.join("\t"))].join("\n"),n=`\n      <table>\n        <thead>\n          <tr>${t.map(e=>`<th>${e}</th>`).join("")}</tr>\n        </thead>\n        <tbody>\n          ${a.map(e=>`<tr>${e.map(e=>`<td>${e}</td>`).join("")}</tr>`).join("")}\n        </tbody>\n      </table>\n    `,o=new ClipboardItem({"text/plain":new Blob([l],{type:"text/plain"}),"text/html":new Blob([n],{type:"text/html"})});await navigator.clipboard.write([o]);}catch(t){let a,l;console.warn("ClipboardItem不支持，使用纯文本格式"),"lastTwo"===e?(a=["创意ID","笔记id"],l=h.value.map(e=>[e.creativeId||"",e.contentId||""])):(a=["创意名称","账户名称","计划名称","创建时间","状态","审核状态","投放位置","创意ID","笔记id"],l=h.value.map(e=>[e.creativeName||"",e.accountName||"",e.campaignName||"",e.createTime||"",e.statusDesc||"",e.auditStatusDesc||"",e.placementDesc||"",e.creativeId||"",e.contentId||""]));const n=[a.join("\t"),...l.map(e=>e.join("\t"))].join("\n");await navigator.clipboard.writeText(n);}},w=()=>{try{const e=I(),t=new Blob([e],{type:"text/csv;charset=utf-8;"}),l=document.createElement("a");l.href=URL.createObjectURL(t);const n=g(m.value);l.download=`创意数据_${n}.csv`,document.body.appendChild(l),l.click(),document.body.removeChild(l),a.success("文件下载成功");}catch(e){a.error("下载失败: "+e.message);}},I=()=>{const e=h.value.map(e=>[`"${e.creativeName||""}"`,`"${e.accountName||""}"`,`"${e.campaignName||""}"`,e.createTime||"",e.statusDesc||"",e.auditStatusDesc||"",e.placementDesc||"",e.creativeId||"",e.contentId||""]);return [["创意名称","账户名称","计划名称","创建时间","状态","审核状态","投放位置","创意ID","笔记id"].join(","),...e.map(e=>e.join(","))].join("\n")};return (e,t)=>{const a=vue.resolveComponent("n-date-picker"),g=vue.resolveComponent("n-button"),b=vue.resolveComponent("n-space"),x=vue.resolveComponent("n-data-table"),I=vue.resolveComponent("n-card");return vue.openBlock(),vue.createElementBlock("div",fe,[vue.createVNode(b,{vertical:"",size:16},{default:vue.withCtx(()=>[vue.createVNode(b,{align:"center",size:12},{default:vue.withCtx(()=>[vue.createVNode(a,{value:m.value,"onUpdate:value":t[0]||(t[0]=e=>m.value=e),type:"date",placeholder:"选择发布日期",format:"yyyy-MM-dd",style:{width:"200px"}},null,8,["value"]),vue.createVNode(g,{type:"primary",onClick:f,loading:p.value},{icon:vue.withCtx(()=>t[1]||(t[1]=[vue.createElementVNode("span",{style:{"font-size":"16px"}},"🔍",-1)])),default:vue.withCtx(()=>[t[2]||(t[2]=vue.createTextVNode(" 开始搜索 ",-1))]),_:1,__:[2]},8,["loading"])]),_:1}),h.value.length>0?(vue.openBlock(),vue.createBlock(I,{key:0,size:"small"},{header:vue.withCtx(()=>[vue.createVNode(b,{justify:"space-between",align:"center"},{default:vue.withCtx(()=>[vue.createElementVNode("span",null,"创意数据列表 (共 "+vue.toDisplayString(h.value.length)+" 条)",1),vue.createVNode(b,null,{default:vue.withCtx(()=>[vue.createVNode(g,{size:"small",onClick:y},{icon:vue.withCtx(()=>t[3]||(t[3]=[vue.createElementVNode("span",{style:{"font-size":"14px"}},"📋",-1)])),default:vue.withCtx(()=>[t[4]||(t[4]=vue.createTextVNode(" 复制 ",-1))]),_:1,__:[4]}),vue.createVNode(g,{size:"small",type:"info",onClick:w},{icon:vue.withCtx(()=>t[5]||(t[5]=[vue.createElementVNode("span",{style:{"font-size":"14px"}},"📥",-1)])),default:vue.withCtx(()=>[t[6]||(t[6]=vue.createTextVNode(" 下载 ",-1))]),_:1,__:[6]}),vue.createVNode(g,{size:"small",type:"info",onClick:k},{icon:vue.withCtx(()=>t[7]||(t[7]=[vue.createElementVNode("span",{style:{"font-size":"14px"}},"📥",-1)])),default:vue.withCtx(()=>[t[8]||(t[8]=vue.createTextVNode(" 复制创意 ",-1))]),_:1,__:[8]})]),_:1})]),_:1})]),default:vue.withCtx(()=>[vue.createVNode(x,{columns:v,data:h.value,pagination:{pageSize:20},striped:"",size:"small","scroll-x":1400},null,8,["data"])]),_:1})):vue.createCommentVNode("",true)]),_:1})])}}},[["__scopeId","data-v-e7612e1f"]]),_e={class:"jihua-container"},ke=te({__name:"chuangyi",setup(e){const a=C.useMessage(),r=vue.ref(""),c=vue.ref(false),p=vue.ref(false);function m(){if(r.value.trim()){c.value=true;try{const t=r.value.trim().split("\n").map(e=>e.trim().split("\t")),l=[],n=[];t.forEach(e=>{"信息流"===e[0]?l.push(e[1]):"搜索"===e[0]&&n.push(e[1]);});const o=[];l.length>0&&o.push((e=l,console.log(p.value),fetch("https://galaxy.alibaba-inc.com/creativePlan/automatedSetUp",{headers:{accept:"application/json, text/plain, */*","accept-language":"zh-CN,zh;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6",appname:"adcontent-op","bx-v":"2.5.31","content-type":"application/json",priority:"u=1, i","sec-ch-ua":'"Not)A;Brand";v="8", "Chromium";v="138", "Microsoft Edge";v="138"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"macOS"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin"},referrer:"https://galaxy.alibaba-inc.com/",body:JSON.stringify({mediaCode:0,opType:2,taskOpType:7,taskType:3,name:p.value?"创意开启":"创意关闭",campaignSettings:'{"startTime":null}',unitSettings:"{}",creativeSettings:p.value?'{"status":1}':'{"status":2}',ext:'{"marketingTarget":4,"placement":1,"optimizeTarget":0,"type":"creative"}',mediaIdList:e}),method:"POST",mode:"cors",credentials:"include"}))),n.length>0&&o.push(function(e){return fetch("https://galaxy.alibaba-inc.com/creativePlan/automatedSetUp",{headers:{accept:"application/json, text/plain, */*","accept-language":"zh-CN,zh;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6",appname:"adcontent-op","bx-v":"2.5.31","content-type":"application/json",priority:"u=1, i","sec-ch-ua":'"Not)A;Brand";v="8", "Chromium";v="138", "Microsoft Edge";v="138"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"macOS"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin"},referrer:"https://galaxy.alibaba-inc.com/",body:JSON.stringify({mediaCode:0,opType:2,taskOpType:7,taskType:3,name:p.value?"创意开启":"创意关闭",campaignSettings:'{"startTime":null}',unitSettings:"{}",creativeSettings:p.value?'{"status":1}':'{"status":2}',ext:'{"marketingTarget":4,"placement":2,"optimizeTarget":0,"type":"creative"}',mediaIdList:e}),method:"POST",mode:"cors",credentials:"include"})}(n)),Promise.all(o).then(()=>{a.success("操作已提交成功"),c.value=!1;}).catch(e=>{console.error("操作失败:",e),a.error("操作执行失败"),c.value=!1;});}catch(t){console.error("处理数据时出错:",t),a.error("数据处理失败"),c.value=false;}var e;}else a.warning("请输入需要处理的数据");}return (e,t)=>{const a=vue.resolveComponent("n-input"),h=vue.resolveComponent("n-checkbox"),v=vue.resolveComponent("n-button"),g=vue.resolveComponent("n-space");return vue.openBlock(),vue.createElementBlock("div",_e,[vue.createVNode(g,{vertical:""},{default:vue.withCtx(()=>[vue.createVNode(a,{value:r.value,"onUpdate:value":t[0]||(t[0]=e=>r.value=e),type:"textarea",placeholder:"请输入数据\n\n示例：\n搜索\t2035614598\n信息流\t2033338178\n搜索\t2035670707",autosize:{minRows:10,maxRows:15},clearable:""},null,8,["value"]),vue.createVNode(h,{checked:p.value,"onUpdate:checked":t[1]||(t[1]=e=>p.value=e)},{default:vue.withCtx(()=>t[2]||(t[2]=[vue.createTextVNode(" 启用创意 (取消勾选则关闭创意) ",-1)])),_:1,__:[2]},8,["checked"]),vue.createVNode(v,{type:"primary",onClick:m,loading:c.value,disabled:!r.value.trim()},{default:vue.withCtx(()=>[vue.createTextVNode(vue.toDisplayString(c.value?"处理中...":"提交执行"),1)]),_:1},8,["loading","disabled"])]),_:1})])}}},[["__scopeId","data-v-e9fa887f"]]),be={class:"plan-container"},we=te({__name:"jihua",setup(e){const p=C.useMessage(),m=vue.ref("close"),h=vue.ref(null),v=vue.ref(""),g=vue.ref(false);async function f(e,t,a){const l="close"===a.mode?"关闭":`调价至 ${a.budget}`;console.log(`> 正在批量 [${l}] [${e}] 类型的 ${t.length} 个计划...`),console.log("  ID 列表:",t);try{const n=function(e,t,a){const l={"信息流":1,"搜索":2}[e];if(void 0===l)throw new Error(`未知的计划类型: "${e}"`);let n={},o="";if("close"===a.mode)n={status:2},o="关闭";else if("adjust"===a.mode){if("number"!=typeof a.budget||a.budget<=0)throw new Error("预算金额无效。");n={campaignDayBudget:a.budget,startTime:"2025-08-01"},o=`调整预算至${a.budget}`;}const s=JSON.stringify(n),i=JSON.stringify({marketingTarget:4,placement:l,optimizeTarget:0,type:"plan"});return {mediaCode:0,opType:2,taskOpType:"close"===a.mode?4:3,taskType:1,name:o,campaignSettings:s,unitSettings:"{}",creativeSettings:"{}",ext:i,mediaIdList:t.map(e=>String(e))}}(e,t,a),o=await fetch("https://galaxy.alibaba-inc.com/creativePlan/automatedSetUp",{method:"POST",headers:{accept:"application/json, text/plain, */*","content-type":"application/json",appname:"adcontent-op"},body:JSON.stringify(n)});if(!o.ok)throw new Error(`HTTP 错误! 状态码: ${o.status}`);const s=await o.json();s.success||"200"===String(s.code)?(p.success(`[${e}] 类型的计划已提交 [${l}] 操作`),console.log(`✅ [成功] [${e}] 类型的计划已提交 [${l}] 操作。响应:`,s.message||"OK")):(p.error(`[${e}] 类型的计划操作失败`),console.error(`❌ [失败] [${e}] 类型的计划操作失败。业务响应:`,s.message||s));}catch(n){p.error(`[${e}] 类型的计划请求异常`),console.error(`❌ [失败] [${e}] 类型的计划请求异常:`,n);}}const y=vue.computed(()=>!(!v.value.trim()||"adjust"===m.value&&!h.value));async function k(){if(v.value.trim())if("adjust"!==m.value||h.value){g.value=true;try{const t={mode:m.value,budget:h.value},a={"信息流":[],"搜索":[]};v.value.trim().split("\n").forEach(e=>{const t=e.trim().split(/\s+/);if(t.length>=2&&t[1]){const l=t[0],n=t[1];a[l]?a[l].push(n):console.warn(`! 跳过未知类型 "${l}" 的行: ${e}`);}});const l=a["信息流"],n=a["搜索"];if(0===l.length&&0===n.length)return p.error("未能解析出任何有效的任务，请检查数据格式"),void(g.value=!1);let o=!1;l.length>0&&(await f("信息流",l,t),o=!0),n.length>0&&(o&&await(e=1e3,new Promise(t=>setTimeout(t,e))),await f("搜索",n,t)),p.success("全部批量任务处理完毕！"),g.value=!1;}catch(t){console.error("处理数据时出错:",t),p.error("数据处理失败"),g.value=false;}var e;}else p.warning("请输入日预算金额");else p.warning("请输入需要处理的数据");}return (e,t)=>{const a=vue.resolveComponent("n-radio"),p=vue.resolveComponent("n-space"),f=vue.resolveComponent("n-radio-group"),b=vue.resolveComponent("n-input-number"),w=vue.resolveComponent("n-input"),x=vue.resolveComponent("n-button");return vue.openBlock(),vue.createElementBlock("div",be,[vue.createVNode(p,{vertical:""},{default:vue.withCtx(()=>[t[6]||(t[6]=vue.createElementVNode("div",{class:"description"},[vue.createElementVNode("p",null,"请选择操作模式并输入需要处理的计划数据"),vue.createElementVNode("p",null,"数据格式：平台 + Tab + 计划ID"),vue.createElementVNode("p",null,"例如："),vue.createElementVNode("pre",null,"搜索\t2035614598\n信息流\t2033338178\n搜索\t2035670707")],-1)),vue.createVNode(f,{value:m.value,"onUpdate:value":t[0]||(t[0]=e=>m.value=e),name:"mode"},{default:vue.withCtx(()=>[vue.createVNode(p,null,{default:vue.withCtx(()=>[vue.createVNode(a,{value:"close"},{default:vue.withCtx(()=>t[3]||(t[3]=[vue.createTextVNode(" 批量关闭计划 ",-1)])),_:1,__:[3]}),vue.createVNode(a,{value:"adjust"},{default:vue.withCtx(()=>t[4]||(t[4]=[vue.createTextVNode(" 批量调整日预算 ",-1)])),_:1,__:[4]})]),_:1})]),_:1},8,["value"]),"adjust"===m.value?(vue.openBlock(),vue.createBlock(b,{key:0,value:h.value,"onUpdate:value":t[1]||(t[1]=e=>h.value=e),placeholder:"请输入新的日预算金额",min:1,clearable:""},{prefix:vue.withCtx(()=>t[5]||(t[5]=[vue.createTextVNode(" ¥ ",-1)])),_:1},8,["value"])):vue.createCommentVNode("",true),vue.createVNode(w,{value:v.value,"onUpdate:value":t[2]||(t[2]=e=>v.value=e),type:"textarea",placeholder:"请输入数据\n\n示例：\n搜索\t2035614598\n信息流\t2033338178\n搜索\t2035670707",autosize:{minRows:10,maxRows:15},clearable:""},null,8,["value"]),vue.createVNode(x,{type:"primary",onClick:k,loading:g.value,disabled:!y.value},{default:vue.withCtx(()=>[vue.createTextVNode(vue.toDisplayString(g.value?"处理中...":"提交执行"),1)]),_:1},8,["loading","disabled"])]),_:1,__:[6]})])}}},[["__scopeId","data-v-f977d1aa"]]),xe={class:"search-price-container"},Ie={class:"button-group"},Se={class:"result-header"},Te={class:"result-icon"},Ce={class:"result-title"},Ne={class:"result-content"},$e={key:0},ze={key:1,class:"error-message"},Ue={class:"preview-header"},qe={class:"plan-ids-grid"},De=te({__name:"sosuo",setup(e){const l=C.useMessage(),p=vue.ref(false),h=vue.ref(null),g=vue.ref(null),f=vue.ref({planIds:"",keywordBid:1.5,startTime:Date.now(),taskName:"调整搜索出价"}),y={planIds:{required:true,message:"请输入计划ID",trigger:["blur","input"],validator:(e,t)=>{if(!t||!t.trim())return new Error("请输入计划ID");const a=w(t);return 0===a.length?new Error("请输入有效的计划ID"):!(a.length>50)||new Error("每次最多支持50个计划ID")}},keywordBid:{required:true,type:"number",message:"请输入有效的出价金额",trigger:["blur","change"]},taskName:{required:true,message:"请输入任务名称",trigger:["blur","input"]}},w=e=>e&&e.trim()?e.split(/[\n\r,;，；]/).map(e=>e.trim()).filter(e=>e.length>0).filter(e=>/^\d+$/.test(e)):[],x=vue.computed(()=>w(f.value.planIds)),S=vue.computed(()=>x.value.length>0&&f.value.keywordBid>0&&f.value.startTime&&f.value.taskName.trim().length>0),T=async()=>{try{await(h.value?.validate()),p.value=!0,g.value=null;const e={mediaCode:0,opType:2,taskOpType:5,taskType:1,name:f.value.taskName,unitSettings:JSON.stringify({keywordBid:f.value.keywordBid}),creativeSettings:"{}",ext:JSON.stringify({marketingTarget:4,placement:2,optimizeTarget:0,type:"plan"}),mediaIdList:x.value},t=await fetch("https://galaxy.alibaba-inc.com/creativePlan/automatedSetUp",{headers:{accept:"application/json, text/plain, */*","accept-language":"zh-CN,zh;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6",appname:"adcontent-op","bx-v":"2.5.31","content-type":"application/json",priority:"u=1, i","sec-ch-ua":'"Chromium";v="140", "Not=A?Brand";v="24", "Microsoft Edge";v="140"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"macOS"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin"},referrer:"https://galaxy.alibaba-inc.com/",body:JSON.stringify(e),method:"POST",mode:"cors",credentials:"include"}),a=await t.json();if(!t.ok)throw new Error(a.message||"请求失败");g.value={success:!0,message:"任务提交成功",details:a},l.success(`成功提交${x.value.length}个计划的出价调整任务`);}catch(e){console.error("提交失败:",e),g.value={success:false,message:e.message||"网络请求失败",details:e},l.error("提交失败: "+(e.message||"未知错误"));}finally{p.value=false;}},C$1=()=>{f.value={planIds:"",keywordBid:1.5,startTime:Date.now(),taskName:"调整搜索出价"},g.value=null,h.value?.restoreValidation();};return vue.watch(()=>f.value.planIds,()=>{x.value.length>0&&(f.value.taskName=`调整搜索出价${f.value.keywordBid}-${x.value.length}个计划`);},{immediate:true}),(e,t)=>(vue.openBlock(),vue.createElementBlock("div",xe,[t[5]||(t[5]=vue.createElementVNode("div",{class:"header"},[vue.createElementVNode("h2",null,"🔍 搜索出价调整工具"),vue.createElementVNode("p",{class:"subtitle"},"批量调整计划的搜索关键词出价")],-1)),vue.createVNode(vue.unref(C.NCard),{class:"form-card"},{default:vue.withCtx(()=>[vue.createVNode(vue.unref(C.NForm),{model:f.value,ref_key:"formRef",ref:h,rules:y},{default:vue.withCtx(()=>[vue.createVNode(vue.unref(C.NFormItem),{label:"📋 计划ID列表",path:"planIds"},{default:vue.withCtx(()=>[vue.createVNode(vue.unref(C.NInput),{value:f.value.planIds,"onUpdate:value":t[0]||(t[0]=e=>f.value.planIds=e),type:"textarea",placeholder:"请输入计划ID，支持多个ID用换行、逗号、分号分隔\\n例如：\\n138676191\\n138676192\\n138676193",rows:6,clearable:""},null,8,["value"])]),_:1}),vue.createVNode(vue.unref(C.NFormItem),{label:"💰 关键词出价",path:"keywordBid"},{default:vue.withCtx(()=>[vue.createVNode(vue.unref(C.NInputNumber),{value:f.value.keywordBid,"onUpdate:value":t[1]||(t[1]=e=>f.value.keywordBid=e),placeholder:"请输入出价金额",precision:2,min:.01,max:999.99,style:{width:"200px"}},{suffix:vue.withCtx(()=>t[3]||(t[3]=[vue.createTextVNode("元",-1)])),_:1},8,["value"])]),_:1}),vue.createVNode(vue.unref(C.NFormItem),{label:"📝 任务名称",path:"taskName"},{default:vue.withCtx(()=>[vue.createVNode(vue.unref(C.NInput),{value:f.value.taskName,"onUpdate:value":t[2]||(t[2]=e=>f.value.taskName=e),placeholder:"请输入任务名称",clearable:""},null,8,["value"])]),_:1}),vue.createElementVNode("div",Ie,[vue.createVNode(vue.unref(C.NButton),{type:"primary",size:"large",loading:p.value,onClick:T,disabled:!S.value},{default:vue.withCtx(()=>[vue.createTextVNode(" 🚀 "+vue.toDisplayString(p.value?"提交中...":"提交任务"),1)]),_:1},8,["loading","disabled"]),vue.createVNode(vue.unref(C.NButton),{size:"large",onClick:C$1,disabled:p.value},{default:vue.withCtx(()=>t[4]||(t[4]=[vue.createTextVNode(" 🔄 重置 ",-1)])),_:1,__:[4]},8,["disabled"])])]),_:1},8,["model"])]),_:1}),g.value?(vue.openBlock(),vue.createBlock(vue.unref(C.NCard),{key:0,class:vue.normalizeClass(["result-card",{success:g.value.success,error:!g.value.success}])},{default:vue.withCtx(()=>[vue.createElementVNode("div",Se,[vue.createElementVNode("span",Te,vue.toDisplayString(g.value.success?"✅":"❌"),1),vue.createElementVNode("span",Ce,vue.toDisplayString(g.value.success?"提交成功":"提交失败"),1)]),vue.createElementVNode("div",Ne,[g.value.success?(vue.openBlock(),vue.createElementBlock("p",$e," 已成功提交 "+vue.toDisplayString(x.value.length)+" 个计划的出价调整任务 ",1)):(vue.openBlock(),vue.createElementBlock("p",ze,vue.toDisplayString(g.value.message),1)),g.value.details?(vue.openBlock(),vue.createBlock(vue.unref(C.NCollapse),{key:2},{default:vue.withCtx(()=>[vue.createVNode(vue.unref(C.NCollapseItem),{title:"📄 详细信息",name:"details"},{default:vue.withCtx(()=>[vue.createElementVNode("pre",null,vue.toDisplayString(JSON.stringify(g.value.details,null,2)),1)]),_:1})]),_:1})):vue.createCommentVNode("",true)])]),_:1},8,["class"])):vue.createCommentVNode("",true),x.value.length>0?(vue.openBlock(),vue.createBlock(vue.unref(C.NCard),{key:1,class:"preview-card"},{default:vue.withCtx(()=>[vue.createElementVNode("div",Ue,[vue.createElementVNode("span",null,"📊 计划ID预览 ("+vue.toDisplayString(x.value.length)+" 个)",1)]),vue.createElementVNode("div",qe,[(vue.openBlock(true),vue.createElementBlock(vue.Fragment,null,vue.renderList(x.value.slice(0,20),(e,t)=>(vue.openBlock(),vue.createBlock(vue.unref(C.NTag),{key:t,type:"info",size:"small"},{default:vue.withCtx(()=>[vue.createTextVNode(vue.toDisplayString(e),1)]),_:2},1024))),128)),x.value.length>20?(vue.openBlock(),vue.createBlock(vue.unref(C.NTag),{key:0,type:"warning",size:"small"},{default:vue.withCtx(()=>[vue.createTextVNode(" ...还有"+vue.toDisplayString(x.value.length-20)+"个 ",1)]),_:1})):vue.createCommentVNode("",true)])]),_:1})):vue.createCommentVNode("",true)]))}},[["__scopeId","data-v-1b153763"]]),Oe={class:"note-match-container"},Ee={class:"match-stats-content"},je={class:"stats-item"},Be={class:"stats-text"},Pe={class:"stats-item"},Ae={class:"stats-text"},Le={class:"stats-item success"},Me={class:"stats-text"},Re={class:"stats-item warning"},Je={class:"stats-text"},Ge={class:"stats-summary"},He={class:"stats-text"},Fe=te({__name:"noteMatch",setup(e){const l=C.useMessage(),p=vue.ref(false),m=vue.ref(false),h=vue.ref(false),g=vue.ref([]),f=vue.ref(null),y=vue.ref([]),w=vue.ref([]),x=vue.ref([]),I=vue.ref("8273771"),S=vue.ref(false),T=vue.ref({totalAccountNotes:0,totalLibraryNotes:0,matchedNotes:0,unmatchedNotes:0}),C$1=vue.computed(()=>I.value&&I.value.trim()?I.value.split(",").map(e=>e.trim()).filter(e=>e.length>0).filter(e=>/^\d+$/.test(e)):[]),z=vue.computed(()=>g.value.map(e=>({label:e,value:e}))),D=[{title:"笔记ID",key:"contentId",width:120},{title:"笔记标题",key:"contentTitle",ellipsis:{tooltip:true}},{title:"创建时间",key:"pubDate",width:180,render:e=>e.createTime?new Date(e.createTime).toLocaleString():"-"},{title:"链接",key:"contentUrl",width:100}],O=[{title:"创意ID",key:"creativeId",width:120},{title:"笔记ID",key:"contentId",width:120},{title:"创意名称",key:"creativeName",ellipsis:{tooltip:true}},{title:"状态",key:"statusDesc",width:100}],j=[{title:"账号笔记ID",key:"accountNoteId",width:120},{title:"笔记库ID",key:"libraryNoteId",width:120},{title:"匹配度",key:"matchScore",width:100,render:e=>`${(100*e.matchScore).toFixed(1)}%`},{title:"账号笔记标题",key:"accountNoteTitle",ellipsis:{tooltip:true}},{title:"笔记库标题",key:"libraryNoteTitle",ellipsis:{tooltip:true}}],B=()=>{!async function(){try{p.value=!0;const e=await fetch("https://galaxy.alibaba-inc.com/assets/tag/select/get",{headers:{accept:"application/json, text/plain, */*","accept-language":"zh-CN,zh;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6",appname:"adcontent-op","bx-v":"2.5.31",priority:"u=1, i","sec-ch-ua":'"Chromium";v="140", "Not=A?Brand";v="24", "Microsoft Edge";v="140"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"macOS"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin"},referrer:"https://galaxy.alibaba-inc.com/",method:"GET",mode:"cors",credentials:"include"});if(!e.ok)throw new Error(`HTTP ${e.status}: ${e.statusText}`);const t=await e.json();if(!(t.success&&t.model&&t.model.projectName))throw new Error(t.msgInfo||"获取项目列表失败");g.value=t.model.projectName,l.success(`获取成功！共 ${t.model.projectName.length} 个项目`);}catch(e){console.error("获取项目列表失败:",e),l.error("获取项目列表失败: "+e.message);}finally{p.value=false;}}();},P=()=>{f.value&&async function(e){try{m.value=!0;const t=await fetch("https://galaxy.alibaba-inc.com/assets/contentTag/list",{headers:{accept:"application/json, text/plain, */*","accept-language":"zh-CN,zh;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6",appname:"adcontent-op","bx-v":"2.5.31","content-type":"application/json",priority:"u=1, i","sec-ch-ua":'"Chromium";v="140", "Not=A?Brand";v="24", "Microsoft Edge";v="140"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"macOS"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin"},referrer:"https://galaxy.alibaba-inc.com/",body:JSON.stringify({pageNo:1,pageSize:1e3,media:"RED_BOOK",projectName:e}),method:"POST",mode:"cors",credentials:"include"});if(!t.ok)throw new Error(`HTTP ${t.status}: ${t.statusText}`);const a=await t.json();if(!(a.success&&a.model&&a.model.result))throw new Error(a.msgInfo||"获取笔记库失败");y.value=a.model.result,l.success(`获取笔记库成功！共 ${a.model.result.length} 条笔记`);}catch(t){console.error("获取笔记库失败:",t),l.error("获取笔记库失败: "+t.message),y.value=[];}finally{m.value=false;}}(f.value);},A=()=>{!async function(){try{if(0===C$1.value.length)return void l.warning("请输入有效的账号ID");h.value=!0;const e=await fetch("https://galaxy.alibaba-inc.com/ad/manage/creative",{headers:{accept:"application/json, text/plain, */*","accept-language":"zh-CN,zh;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6",appname:"adcontent-op","bx-v":"2.5.31","content-type":"application/json",priority:"u=1, i","sec-ch-ua":'"Chromium";v="140", "Not=A?Brand";v="24", "Microsoft Edge";v="140"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"macOS"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin"},referrer:"https://galaxy.alibaba-inc.com/",body:JSON.stringify({media:"RED_BOOK",startTime:"2025-05-01",endTime:"2025-05-02",current:1,pageSize:1e3,marketingTarget:4,optimizeTarget:0,type:"creative",accountIdList:C$1.value,pageNo:1}),method:"POST",mode:"cors",credentials:"include"});if(!e.ok)throw new Error(`HTTP ${e.status}: ${e.statusText}`);const t=await e.json();if(!(t.success&&t.model&&t.model.result))throw new Error(t.msgInfo||"获取账号笔记失败");w.value=t.model.result,l.success(`获取账号笔记成功！共 ${t.model.result.length} 条（账号：${C$1.value.join(", ")}）`);}catch(e){console.error("获取账号笔记失败:",e),l.error("获取账号笔记失败: "+e.message),w.value=[];}finally{h.value=false;}}();},L=()=>{try{const e=[],t=new Set;w.value.forEach(a=>{y.value.forEach(l=>{a.contentId===l.contentId&&(e.push({accountNoteId:a.contentId,libraryNoteId:l.contentId,matchScore:1,accountNoteTitle:a.creativeName,libraryNoteTitle:l.title}),t.add(a.contentId));});}),e.sort((e,t)=>t.matchScore-e.matchScore);const a=w.value.length,n=y.value.length,o=e.filter(e=>1===e.matchScore).length,s=a-o;T.value={totalAccountNotes:a,totalLibraryNotes:n,matchedNotes:o,unmatchedNotes:s},x.value=e,S.value=!0,l.success(`匹配完成！找到 ${e.length} 条匹配结果`);}catch(e){console.error("匹配失败:",e),l.error("匹配失败: "+e.message);}},M=()=>{try{const e=[["账号笔记ID","笔记库ID","匹配度","账号笔记标题","笔记库标题"],...x.value.map(e=>[e.accountNoteId,e.libraryNoteId,`${(100*e.matchScore).toFixed(1)}%`,e.accountNoteTitle,e.libraryNoteTitle])].map(e=>e.join("\t")).join("\n");navigator.clipboard.writeText(e),l.success("结果已复制到剪贴板，可直接粘贴到Excel");}catch(e){l.error("导出失败: "+e.message);}},V=()=>{x.value=[],l.info("已清空匹配结果");};return (e,t)=>(vue.openBlock(),vue.createElementBlock("div",Oe,[t[23]||(t[23]=vue.createElementVNode("div",{class:"header"},[vue.createElementVNode("h2",null,"📚 笔记库匹配工具"),vue.createElementVNode("p",{class:"subtitle"},"选择项目并匹配笔记库中的内容")],-1)),vue.createVNode(vue.unref(C.NCard),{class:"main-card"},{default:vue.withCtx(()=>[vue.createVNode(vue.unref(C.NSpace),{vertical:"",size:"large"},{default:vue.withCtx(()=>[vue.createVNode(vue.unref(C.NFormItem),{label:"🚀 初始化"},{default:vue.withCtx(()=>[vue.createVNode(vue.unref(C.NSpace),null,{default:vue.withCtx(()=>[vue.createVNode(vue.unref(C.NButton),{type:"primary",size:"large",loading:p.value,onClick:B,disabled:g.value.length>0},{default:vue.withCtx(()=>[vue.createTextVNode(" 📋 "+vue.toDisplayString(p.value?"加载中...":"获取项目列表"),1)]),_:1},8,["loading","disabled"]),g.value.length>0?(vue.openBlock(),vue.createBlock(vue.unref(C.NTag),{key:0,type:"success"},{default:vue.withCtx(()=>[vue.createTextVNode(" ✅ 已加载 "+vue.toDisplayString(g.value.length)+" 个项目 ",1)]),_:1})):vue.createCommentVNode("",true)]),_:1})]),_:1}),g.value.length>0?(vue.openBlock(),vue.createBlock(vue.unref(C.NFormItem),{key:0,label:"🎯 选择项目",required:""},{default:vue.withCtx(()=>[vue.createVNode(vue.unref(C.NSpace),{vertical:"",style:{width:"100%"}},{default:vue.withCtx(()=>[vue.createVNode(vue.unref(C.NSelect),{value:f.value,"onUpdate:value":t[0]||(t[0]=e=>f.value=e),placeholder:"请选择项目",options:z.value,clearable:""},null,8,["value","options"]),f.value?(vue.openBlock(),vue.createBlock(vue.unref(C.NButton),{key:0,type:"info",loading:m.value,onClick:P,disabled:y.value.length>0},{default:vue.withCtx(()=>[vue.createTextVNode(" 📚 "+vue.toDisplayString(m.value?"加载中...":"获取笔记库内容"),1)]),_:1},8,["loading","disabled"])):vue.createCommentVNode("",true)]),_:1})]),_:1})):vue.createCommentVNode("",true),y.value.length>0?(vue.openBlock(),vue.createBlock(vue.unref(C.NFormItem),{key:1,label:"📝 笔记库内容"},{default:vue.withCtx(()=>[vue.createVNode(vue.unref(C.NSpace),{vertical:"",style:{width:"100%"}},{default:vue.withCtx(()=>[vue.createVNode(vue.unref(C.NTag),{type:"info"},{default:vue.withCtx(()=>[vue.createTextVNode(" 📊 已加载 "+vue.toDisplayString(y.value.length)+" 条笔记 ",1)]),_:1}),vue.createVNode(vue.unref(C.NDataTable),{columns:D,data:y.value,pagination:{pageSize:10,showSizePicker:true,pageSizes:[10,20,50]},bordered:false,"single-line":false,size:"small","max-height":"400px"},null,8,["data"])]),_:1})]),_:1})):vue.createCommentVNode("",true),y.value.length>0?(vue.openBlock(),vue.createBlock(vue.unref(C.NFormItem),{key:2,label:"👤 账号笔记"},{default:vue.withCtx(()=>[vue.createVNode(vue.unref(C.NSpace),{vertical:"",style:{width:"100%"}},{default:vue.withCtx(()=>[vue.createVNode(vue.unref(C.NFormItem),{label:"🏷️ 账号ID列表",required:""},{default:vue.withCtx(()=>[vue.createVNode(vue.unref(C.NInput),{value:I.value,"onUpdate:value":t[1]||(t[1]=e=>I.value=e),placeholder:"请输入账号ID，多个ID用英文逗号分隔\\n例如：8273771,8273772,8273773",clearable:"",style:{width:"100%"}},null,8,["value"]),C$1.value.length>0?(vue.openBlock(),vue.createBlock(vue.unref(C.NSpace),{key:0,style:{"margin-top":"8px"}},{default:vue.withCtx(()=>[(vue.openBlock(true),vue.createElementBlock(vue.Fragment,null,vue.renderList(C$1.value.slice(0,10),(e,t)=>(vue.openBlock(),vue.createBlock(vue.unref(C.NTag),{key:t,type:"info",size:"small"},{default:vue.withCtx(()=>[vue.createTextVNode(vue.toDisplayString(e),1)]),_:2},1024))),128)),C$1.value.length>10?(vue.openBlock(),vue.createBlock(vue.unref(C.NTag),{key:0,type:"warning",size:"small"},{default:vue.withCtx(()=>[vue.createTextVNode(" ...还有"+vue.toDisplayString(C$1.value.length-10)+"个 ",1)]),_:1})):vue.createCommentVNode("",true)]),_:1})):vue.createCommentVNode("",true)]),_:1}),vue.createVNode(vue.unref(C.NSpace),null,{default:vue.withCtx(()=>[vue.createVNode(vue.unref(C.NButton),{type:"primary",loading:h.value,onClick:A,disabled:0===C$1.value.length},{default:vue.withCtx(()=>t[4]||(t[4]=[vue.createTextVNode(" 🔍 获取账号笔记 ",-1)])),_:1,__:[4]},8,["loading","disabled"]),vue.createVNode(vue.unref(C.NButton),{type:"info",disabled:!w.value.length,onClick:L},{default:vue.withCtx(()=>t[5]||(t[5]=[vue.createTextVNode(" 🔄 开始匹配 ",-1)])),_:1,__:[5]},8,["disabled"])]),_:1}),w.value.length>0?(vue.openBlock(),vue.createBlock(vue.unref(C.NTag),{key:0,type:"info",style:{"margin-top":"16px"}},{default:vue.withCtx(()=>[vue.createTextVNode(" 📊 账号下已加载 "+vue.toDisplayString(w.value.length)+" 条笔记 ",1)]),_:1})):vue.createCommentVNode("",true),w.value.length?(vue.openBlock(),vue.createBlock(vue.unref(C.NDataTable),{key:1,columns:O,data:w.value,pagination:{pageSize:5},bordered:false,size:"small","max-height":"300px",style:{"margin-top":"16px"}},null,8,["data"])):vue.createCommentVNode("",true)]),_:1})]),_:1})):vue.createCommentVNode("",true)]),_:1})]),_:1}),x.value.length?(vue.openBlock(),vue.createBlock(vue.unref(C.NCard),{key:0,class:"result-card"},{header:vue.withCtx(()=>[vue.createElementVNode("span",null,"🎉 匹配结果 ("+vue.toDisplayString(x.value.length)+" 条)",1)]),default:vue.withCtx(()=>[vue.createVNode(vue.unref(C.NDataTable),{columns:j,data:x.value,pagination:{pageSize:10},bordered:false,size:"small"},null,8,["data"]),vue.createVNode(vue.unref(C.NSpace),{style:{"margin-top":"16px"}},{default:vue.withCtx(()=>[vue.createVNode(vue.unref(C.NButton),{type:"success",onClick:M},{default:vue.withCtx(()=>t[6]||(t[6]=[vue.createTextVNode(" 📊 导出结果 ",-1)])),_:1,__:[6]}),vue.createVNode(vue.unref(C.NButton),{onClick:V},{default:vue.withCtx(()=>t[7]||(t[7]=[vue.createTextVNode(" 🧹 清空结果 ",-1)])),_:1,__:[7]})]),_:1})]),_:1})):vue.createCommentVNode("",true),vue.createVNode(vue.unref(C.NModal),{show:S.value,"onUpdate:show":t[3]||(t[3]=e=>S.value=e),preset:"card",style:{width:"600px","max-width":"90vw"},title:"📊 匹配统计结果",bordered:false,"mask-closable":true,"close-on-esc":true},{default:vue.withCtx(()=>[vue.createElementVNode("div",Ee,[vue.createVNode(vue.unref(C.NSpace),{vertical:"",size:"large"},{default:vue.withCtx(()=>[vue.createElementVNode("div",je,[t[10]||(t[10]=vue.createElementVNode("span",{class:"stats-icon"},"📝",-1)),vue.createElementVNode("span",Be,[t[8]||(t[8]=vue.createTextVNode("账号下总共有 ",-1)),vue.createElementVNode("strong",null,vue.toDisplayString(T.value.totalAccountNotes),1),t[9]||(t[9]=vue.createTextVNode(" 条笔记",-1))])]),vue.createElementVNode("div",Pe,[t[13]||(t[13]=vue.createElementVNode("span",{class:"stats-icon"},"📚",-1)),vue.createElementVNode("span",Ae,[t[11]||(t[11]=vue.createTextVNode("笔记库总共 ",-1)),vue.createElementVNode("strong",null,vue.toDisplayString(T.value.totalLibraryNotes),1),t[12]||(t[12]=vue.createTextVNode(" 条笔记",-1))])]),vue.createElementVNode("div",Le,[t[16]||(t[16]=vue.createElementVNode("span",{class:"stats-icon"},"✅",-1)),vue.createElementVNode("span",Me,[t[14]||(t[14]=vue.createTextVNode("账号下有 ",-1)),vue.createElementVNode("strong",null,vue.toDisplayString(T.value.matchedNotes),1),t[15]||(t[15]=vue.createTextVNode(" 条笔记在笔记库中",-1))])]),vue.createElementVNode("div",Re,[t[19]||(t[19]=vue.createElementVNode("span",{class:"stats-icon"},"⚠️",-1)),vue.createElementVNode("span",Je,[t[17]||(t[17]=vue.createTextVNode("有 ",-1)),vue.createElementVNode("strong",null,vue.toDisplayString(T.value.unmatchedNotes),1),t[18]||(t[18]=vue.createTextVNode(" 条笔记不在笔记库中",-1))])]),vue.createElementVNode("div",Ge,[t[21]||(t[21]=vue.createElementVNode("span",{class:"stats-icon"},"📈",-1)),vue.createElementVNode("span",He,[t[20]||(t[20]=vue.createTextVNode("匹配率：",-1)),vue.createElementVNode("strong",null,vue.toDisplayString(T.value.totalAccountNotes>0?(T.value.matchedNotes/T.value.totalAccountNotes*100).toFixed(1):0)+"%",1)])])]),_:1}),vue.createVNode(vue.unref(C.NSpace),{justify:"center",style:{"margin-top":"24px"}},{default:vue.withCtx(()=>[vue.createVNode(vue.unref(C.NButton),{type:"primary",onClick:t[2]||(t[2]=e=>S.value=false)},{default:vue.withCtx(()=>t[22]||(t[22]=[vue.createTextVNode(" 👍 知道了 ",-1)])),_:1,__:[22]})]),_:1})])]),_:1},8,["show"])]))}},[["__scopeId","data-v-0e22a33f"]]),Ve={class:"button-container"},Ke=te({__name:"app",setup(e){const p=vue.ref(false);C.useMessage();const m=vue.ref({chuangyi:false,jihua:false,getchuangyi:false,noteMatch:false,sosuo:false}),h=[{key:"chuangyi",title:"批量关闭创意",component:ke},{key:"jihua",title:"计划批量关闭/调价操作",component:we},{key:"getchuangyi",title:"查看计划",component:ye},{key:"sosuo",title:"调整搜索出价",component:De},{key:"noteMatch",title:"笔记匹配",component:Fe}],g=e=>{m.value[e]=true;},f=vue.computed(()=>[{key:"chuangyi",type:"primary",icon:"🐒",label:"创意关闭/开启",action:()=>g("chuangyi")},{key:"jihua",type:"info",icon:"🐒",label:"计划关闭/调预算",action:()=>g("jihua")},{key:"getchuangyi",type:"success",icon:"🐒",label:"查看计划",action:()=>g("getchuangyi")},{key:"sosuo",type:"success",icon:"🐒",label:"调搜索出价",action:()=>g("sosuo")},{key:"noteMatch",type:"success",icon:"🐒",label:"笔记匹配",action:()=>g("noteMatch")}]);return (e,t)=>{const a=vue.resolveComponent("n-icon"),g=vue.resolveComponent("n-button"),y=vue.resolveComponent("n-space"),_=vue.resolveComponent("n-alert"),k=vue.resolveComponent("n-modal");return vue.openBlock(),vue.createElementBlock("div",Ve,[vue.createVNode(y,{justify:"space-between",wrap:""},{default:vue.withCtx(()=>[(vue.openBlock(true),vue.createElementBlock(vue.Fragment,null,vue.renderList(f.value,e=>(vue.openBlock(),vue.createBlock(g,{key:e.key,type:e.type,size:"large",style:{flex:"1","min-width":"150px",margin:"4px"},onClick:e.action},{icon:vue.withCtx(()=>[vue.createVNode(a,null,{default:vue.withCtx(()=>[vue.createTextVNode(vue.toDisplayString(e.icon),1)]),_:2},1024)]),default:vue.withCtx(()=>[vue.createTextVNode(" "+vue.toDisplayString(e.label),1)]),_:2},1032,["type","onClick"]))),128))]),_:1}),p.value?(vue.openBlock(),vue.createBlock(_,{key:0,type:"info",style:{"margin-top":"20px"},closable:""},{icon:vue.withCtx(()=>[vue.createVNode(a,null,{default:vue.withCtx(()=>t[0]||(t[0]=[vue.createTextVNode("🔊",-1)])),_:1,__:[0]})]),default:vue.withCtx(()=>[t[1]||(t[1]=vue.createTextVNode(" 正在监听中...捕获到的queryJobPs请求将显示在浏览器控制台 ",-1))]),_:1,__:[1]})):vue.createCommentVNode("",true),(vue.openBlock(),vue.createElementBlock(vue.Fragment,null,vue.renderList(h,e=>vue.createVNode(k,{key:e.key,show:m.value[e.key],"onUpdate:show":t=>m.value[e.key]=t,preset:"card",style:{width:"800px","max-width":"90vw"},title:e.title,bordered:false,"mask-closable":true,"close-on-esc":true},{default:vue.withCtx(()=>[(vue.openBlock(),vue.createBlock(vue.resolveDynamicComponent(e.component)))]),_:2},1032,["show","onUpdate:show","title"])),64))])}}},[["__scopeId","data-v-3acfd1ee"]]),We={class:"kuaishou-container"},Ye=te({__name:"kuaishou",setup(e){const a=C.useMessage(),p=vue.ref({batchData:""}),m=vue.ref(false),h=vue.ref([]),g=vue.ref([]),f=['input[placeholder="请输入广告计划名称"]',"#ad_from_unitName_unitName input.ant-input",'input[placeholder="请输入创意名称"]'],k=['input[placeholder="填写后使用直达链接，不填则会使用落地页"]'],w=['input[placeholder="请填写https://开头的链接；如投放原生广告，配置落地页应具备调起APP能力"]'];vue.onMounted(()=>{x(),I("快手广告填表工具已启动");});const x=()=>{p.value.batchData=localStorage.getItem("ks_batchData")||"";},I=e=>{const t=(new Date).toLocaleTimeString();h.value.unshift(`[${t}] ${e}`),h.value.length>50&&(h.value=h.value.slice(0,50));},S=()=>p.value.batchData.trim().split("\n").map((e,t)=>{const a=e.trim().split("\t");return a.length>=3?{index:t+1,title:a[0]||"",h5Link:a[1]||"",directLink:a[2]||"",isIOS:true}:null}).filter(Boolean),T=()=>{g.value=S(),0!==g.value.length?(I(`解析完成，共 ${g.value.length} 条数据`),a.success(`已解析 ${g.value.length} 条数据`)):a.warning("请先输入有效的批量数据");},C$1=(e,t)=>{let a=0;return e.forEach(e=>{try{const l=document.querySelector(e);if(l){l.value=t;const e=new Event("change",{bubbles:!0});l.dispatchEvent(e);const n=new Event("input",{bubbles:!0});l.dispatchEvent(n);const o=Object.keys(l).find(e=>e.startsWith("__reactEventHandlers"));o&&l[o]&&l[o].onChange&&l[o].onChange(e),a++;}}catch(l){console.warn(`设置选择器 ${e} 失败:`,l);}}),a},$=e=>new Promise(t=>setTimeout(t,e)),z=async()=>{const e=document.querySelector('div[data-substep="3-nativeAdvertising"]').innerText;if(p.value.batchData.trim()){m.value=true;try{const t=S();if(0===t.length)return void a.warning("没有有效的数据可以处理");I(`开始批量填充，共 ${t.length} 条数据`);const l=t.filter(t=>e.includes(t.title))[0],n=C$1(f,l.title);I(`填充标题: ${l.title} (成功 ${n} 个字段)`),await $(300);const o=C$1(k,l.directLink);if(I(`填充直达链接: ${l.directLink} (成功 ${o} 个字段)`),await $(300),l.isIOS){const e=C$1(w,l.h5Link);I(`检测到iOS，填充H5链接: ${l.h5Link} (成功 ${e} 个字段)`);}a.success("表单填充完成"),I("批量填充操作完成"),await async function(){document.querySelectorAll('label:has(input[type="checkbox"])').forEach(e=>{if(e.textContent.includes("显示素材名称")){console.log("✅ 找到目标元素:",e);const t=e.querySelector('input[type="checkbox"]');t?(console.log("🎯 准备点击其内部的复选框:",t),t.click(),console.log("🖱️ 点击操作已执行。")):console.warn("⚠️ 找到了标签，但未能找到其内部的复选框。");}});let e=null,t=0;for(;!e&&t<3;)t++,e=document.querySelector('div.ant-typography[rows="2"]:has(span[aria-hidden="true"])'),console.log(`第${t}次查找titleText:`,e),!e&&t<3&&await new Promise(e=>setTimeout(e,500));if(e?console.log("成功找到title元素:",e):console.log("重试3次后仍未找到title元素"),e){let t=e.textContent.trim();t.length>26&&(t=t.slice(0,26)+"...",console.log("✅ 找到标题，已截取至",26,"个字符：",t),C$1(['div[placeholder="请输入广告语或使用推荐的广告语，回车或点击「添加广告语」可新增"]'],t));}}();}catch(t){console.error("填充表单失败:",t),a.error("填充表单失败: "+t.message),I("填充失败: "+t.message);}finally{m.value=false;}}else a.warning("请先输入批量数据");},U=()=>{localStorage.removeItem("ks_batchData"),p.value.batchData="",g.value=[],h.value=[],a.success("已清除所有数据");};return (e,t)=>{const a=vue.resolveComponent("n-input"),f=vue.resolveComponent("n-text"),y=vue.resolveComponent("n-form-item"),k=vue.resolveComponent("n-button"),w=vue.resolveComponent("n-grid-item"),x=vue.resolveComponent("n-grid"),I=vue.resolveComponent("n-tag"),S=vue.resolveComponent("n-table"),C=vue.resolveComponent("n-collapse-item"),N=vue.resolveComponent("n-collapse"),$=vue.resolveComponent("n-log"),q=vue.resolveComponent("n-space"),D=vue.resolveComponent("n-card");return vue.openBlock(),vue.createElementBlock("div",We,[vue.createVNode(D,{title:"快手广告填表工具",class:"tool-card"},{default:vue.withCtx(()=>[vue.createVNode(q,{vertical:"",size:16},{default:vue.withCtx(()=>[vue.createVNode(y,{label:"批量数据输入"},{feedback:vue.withCtx(()=>[vue.createVNode(f,{depth:"3",style:{"font-size":"12px"}},{default:vue.withCtx(()=>t[2]||(t[2]=[vue.createTextVNode(" 格式示例：达人昵称-计划信息 h5 dp ",-1)])),_:1,__:[2]})]),default:vue.withCtx(()=>[vue.createVNode(a,{value:p.value.batchData,"onUpdate:value":[t[0]||(t[0]=e=>p.value.batchData=e),t[1]||(t[1]=e=>{return t="batchData",a=e,void localStorage.setItem(`ks_${t}`,a);var t,a;})],type:"textarea",placeholder:"请按格式输入：达人昵称[TAB]H5链接[TAB]直达链接，每行一条数据",autosize:{minRows:4,maxRows:8}},null,8,["value"])]),_:1}),vue.createVNode(x,{cols:3,"x-gap":12,"y-gap":12},{default:vue.withCtx(()=>[vue.createVNode(w,null,{default:vue.withCtx(()=>[vue.createVNode(k,{type:"primary",block:"",size:"large",onClick:z,loading:m.value},{icon:vue.withCtx(()=>t[3]||(t[3]=[vue.createElementVNode("span",{style:{"font-size":"16px"}},"✏️",-1)])),default:vue.withCtx(()=>[t[4]||(t[4]=vue.createTextVNode(" 批量填充表单 ",-1))]),_:1,__:[4]},8,["loading"])]),_:1}),vue.createVNode(w,null,{default:vue.withCtx(()=>[vue.createVNode(k,{type:"warning",block:"",size:"large",onClick:U},{icon:vue.withCtx(()=>t[5]||(t[5]=[vue.createElementVNode("span",{style:{"font-size":"16px"}},"🗑️",-1)])),default:vue.withCtx(()=>[t[6]||(t[6]=vue.createTextVNode(" 清除所有数据 ",-1))]),_:1,__:[6]})]),_:1}),vue.createVNode(w,null,{default:vue.withCtx(()=>[vue.createVNode(k,{type:"success",block:"",size:"large",onClick:T},{icon:vue.withCtx(()=>t[7]||(t[7]=[vue.createElementVNode("span",{style:{"font-size":"16px"}},"👁️",-1)])),default:vue.withCtx(()=>[t[8]||(t[8]=vue.createTextVNode(" 预览解析数据 ",-1))]),_:1,__:[8]})]),_:1})]),_:1}),g.value.length>0?(vue.openBlock(),vue.createBlock(N,{key:0},{default:vue.withCtx(()=>[vue.createVNode(C,{title:"数据预览",name:"preview"},{default:vue.withCtx(()=>[vue.createVNode(S,{bordered:false,"single-line":false,size:"small"},{default:vue.withCtx(()=>[t[9]||(t[9]=vue.createElementVNode("thead",null,[vue.createElementVNode("tr",null,[vue.createElementVNode("th",null,"序号"),vue.createElementVNode("th",null,"标题名称"),vue.createElementVNode("th",null,"H5链接"),vue.createElementVNode("th",null,"直达链接"),vue.createElementVNode("th",null,"是否iOS")])],-1)),vue.createElementVNode("tbody",null,[(vue.openBlock(true),vue.createElementBlock(vue.Fragment,null,vue.renderList(g.value,(e,t)=>(vue.openBlock(),vue.createElementBlock("tr",{key:t},[vue.createElementVNode("td",null,vue.toDisplayString(t+1),1),vue.createElementVNode("td",null,vue.toDisplayString(e.title),1),vue.createElementVNode("td",null,vue.toDisplayString(e.h5Link),1),vue.createElementVNode("td",null,vue.toDisplayString(e.directLink),1),vue.createElementVNode("td",null,[vue.createVNode(I,{type:e.isIOS?"success":"default",size:"small"},{default:vue.withCtx(()=>[vue.createTextVNode(vue.toDisplayString(e.isIOS?"iOS":"普通"),1)]),_:2},1032,["type"])])]))),128))])]),_:1,__:[9]})]),_:1})]),_:1})):vue.createCommentVNode("",true),h.value.length>0?(vue.openBlock(),vue.createBlock(N,{key:1},{default:vue.withCtx(()=>[vue.createVNode(C,{title:"操作日志",name:"logs"},{default:vue.withCtx(()=>[vue.createVNode($,{log:h.value.join("\n"),rows:6},null,8,["log"])]),_:1})]),_:1})):vue.createCommentVNode("",true)]),_:1})]),_:1})])}}},[["__scopeId","data-v-4eb60829"]]),Xe={__name:"close",setup(e){const t="\n169597390308\n169685376332\n169597006232\n169595328824\n168269398033\n169684625268\n168102001831\n168290494606\n169600912056\n169684001436\n168299019974\n168291195737\n169595521656\n169600026777\n168291009280\n168101654895\n168290834201\n168299214212\n168290922427\n168269622355\n168299405632\n169684283230\n167989923949\n168290390799\n169600254909\n".split("\n");return fetch("https://ad.e.kuaishou.com/rest/dsp/control-panel/creative/update/putStatus?kuaishou.ad.dsp_ph=6b97b016209b12efdb213024078faf279ce6",{headers:{accept:"application/json","accept-language":"zh-CN,zh;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6","account-id":"82275544","content-type":"application/json;charset=UTF-8","ktrace-str":"3|My42NTY4NDU2ODgzODAuMTc2Nzc5MzcuMTc1OTg0Mzg1Mjg1NC4xMTI1|My42NTY4NDU2ODgzODAuNDcxNTMzODYuMTc1OTg0Mzg1Mjg1NC4xMTI0|0|ad-dsp|ad|true|src:Js,seqn:7862,rsi:282af8ed-948c-4567-ba43-1490ef1d5aae,path:/manage,rpi:015d92efa9",priority:"u=1, i","sec-ch-ua":'"Chromium";v="140", "Not=A?Brand";v="24", "Microsoft Edge";v="140"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"macOS"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin","traffic-channel":"pc","x-fetch-time":Date.now().toString(),"x-fetchid":"m4A/cnwLrUTJxJemUlwq+WkAPJ5/+luqrHS3uqEShUQ=","x-requestid":"e6416d3b-0f21-4666-88d7-54ffed12c3ed"},referrer:"https://ad.e.kuaishou.com/manage?__accountId__=82275544&appId=0&templateId=0&advCardId=0&merchandiseId=0&playId=0&searchLevel=3&tab=creative&campaignIds=&unitIds=&creativeIds=&keywordIds=&name=168269398033",body:`{"creativeIds":${t},"putStatus":2}`,method:"POST",mode:"cors",credentials:"include"}),(e,t)=>null}},Qe={class:"kuaishou-container"},Ze=te({__name:"hunjian",setup(e){const a=C.useMessage(),p=vue.ref(""),m=vue.ref({batchData:""}),h=vue.ref(false),g=vue.ref([]),f=vue.ref([]),k=['input[placeholder="请输入广告计划名称"]',"#ad_from_unitName_unitName input.ant-input",'input[placeholder="请输入创意名称"]'],w=['input[placeholder="填写后使用直达链接，不填则会使用落地页"]'],x=['input[placeholder="请填写https://开头的链接；如投放原生广告，配置落地页应具备调起APP能力"]'];vue.onMounted(()=>{I(),S("快手广告填表工具已启动");});const I=()=>{m.value.batchData=localStorage.getItem("ks_batchData")||"";},S=e=>{const t=(new Date).toLocaleTimeString();g.value.unshift(`[${t}] ${e}`),g.value.length>50&&(g.value=g.value.slice(0,50));},T=()=>m.value.batchData.trim().split("\n").map((e,t)=>{const a=e.trim().split("\t");return a.length>=3?{index:t+1,title:`${a[0]}_${a[4]}`||"",h5Link:a[6]||"",directLink:a[7]||"",id:a[2]||"",isIOS:true,videoTitle:a[5]}:null}).filter(Boolean),C$1=()=>{f.value=T(),0!==f.value.length?(S(`解析完成，共 ${f.value.length} 条数据`),a.success(`已解析 ${f.value.length} 条数据`)):a.warning("请先输入有效的批量数据");},$=(e,t)=>{let a=0;return e.forEach(e=>{try{const l=document.querySelector(e);if(l){l.value=t;const e=new Event("change",{bubbles:!0});l.dispatchEvent(e);const n=new Event("input",{bubbles:!0});l.dispatchEvent(n);const o=Object.keys(l).find(e=>e.startsWith("__reactEventHandlers"));o&&l[o]&&l[o].onChange&&l[o].onChange(e),a++;}}catch(l){console.warn(`设置选择器 ${e} 失败:`,l);}}),a},z=e=>new Promise(t=>setTimeout(t,e)),U=async()=>{if(document.querySelector('div[data-substep="3-nativeAdvertising"]').innerText,m.value.batchData.trim()){h.value=true;try{const e=T();if(0===e.length)return void a.warning("没有有效的数据可以处理");S(`开始批量填充，共 ${e.length} 条数据`);const t=e.filter(e=>p.value.includes(e.id))[0],l=$(w,t.directLink);if(S(`填充直达链接: ${t.directLink} (成功 ${l} 个字段)`),await z(300),t.isIOS){const e=$(x,t.h5Link);S(`检测到iOS，填充H5链接: ${t.h5Link} (成功 ${e} 个字段)`);}const n=$(k,t.title);S(`填充标题: ${t.title} (成功 ${n} 个字段)`),await z(300),$(['input[placeholder="请输入广告语或使用推荐的广告语，回车或点击「添加广告语」可新增"],input[placeholder="请填写作品广告语，用来推广内容"]'],t.videoTitle),a.success("表单填充完成"),S("批量填充操作完成"),await async function(){document.querySelectorAll('label:has(input[type="checkbox"])').forEach(e=>{if(e.textContent.includes("显示素材名称")){console.log("✅ 找到目标元素:",e);const t=e.querySelector('input[type="checkbox"]');t?(console.log("🎯 准备点击其内部的复选框:",t),t.click(),console.log("🖱️ 点击操作已执行。")):console.warn("⚠️ 找到了标签，但未能找到其内部的复选框。");}});let e=null,t=0;for(;!e&&t<3;)t++,e=document.querySelector('div.ant-typography[rows="2"]:has(span[aria-hidden="true"])'),console.log(`第${t}次查找titleText:`,e),!e&&t<3&&await new Promise(e=>setTimeout(e,500));if(e?console.log("成功找到title元素:",e):console.log("重试3次后仍未找到title元素"),e){let t=e.textContent.trim();t.length>26&&(t=t.slice(0,26)+"...",console.log("✅ 找到标题，已截取至",26,"个字符：",t),$(['div[placeholder="请输入广告语或使用推荐的广告语，回车或点击「添加广告语」可新增"]'],t));}}();}catch(e){console.error("填充表单失败:",e),a.error("填充表单失败: "+e.message),S("填充失败: "+e.message);}finally{h.value=false;}}else a.warning("请先输入批量数据");},q=()=>{localStorage.removeItem("ks_batchData"),m.value.batchData="",f.value=[],g.value=[],a.success("已清除所有数据");};return (e,t)=>{const a=vue.resolveComponent("n-input"),y=vue.resolveComponent("n-text"),k=vue.resolveComponent("n-form-item"),w=vue.resolveComponent("n-button"),x=vue.resolveComponent("n-grid-item"),I=vue.resolveComponent("n-grid"),S=vue.resolveComponent("n-tag"),T=vue.resolveComponent("n-table"),N=vue.resolveComponent("n-collapse-item"),$=vue.resolveComponent("n-collapse"),z=vue.resolveComponent("n-log"),D=vue.resolveComponent("n-space"),O=vue.resolveComponent("n-card");return vue.openBlock(),vue.createElementBlock("div",Qe,[vue.createVNode(O,{title:"快手广告填表工具",class:"tool-card"},{default:vue.withCtx(()=>[vue.createVNode(D,{vertical:"",size:16},{default:vue.withCtx(()=>[vue.createVNode(k,{label:"批量数据输入"},{feedback:vue.withCtx(()=>[vue.createVNode(y,{depth:"3",style:{"font-size":"12px"}},{default:vue.withCtx(()=>t[3]||(t[3]=[vue.createTextVNode(" 格式示例：达人昵称-计划信息 h5 dp ",-1)])),_:1,__:[3]})]),default:vue.withCtx(()=>[vue.createVNode(a,{value:m.value.batchData,"onUpdate:value":[t[0]||(t[0]=e=>m.value.batchData=e),t[1]||(t[1]=e=>{return t="batchData",a=e,void localStorage.setItem(`ks_${t}`,a);var t,a;})],type:"textarea",placeholder:"请按格式输入：达人昵称[TAB]H5链接[TAB]直达链接，每行一条数据",autosize:{minRows:4,maxRows:8}},null,8,["value"])]),_:1}),vue.createVNode(a,{value:p.value,"onUpdate:value":t[2]||(t[2]=e=>p.value=e),placeholder:"id"},null,8,["value"]),vue.createVNode(I,{cols:3,"x-gap":12,"y-gap":12},{default:vue.withCtx(()=>[vue.createVNode(x,null,{default:vue.withCtx(()=>[vue.createVNode(w,{type:"primary",block:"",size:"large",onClick:U,loading:h.value},{icon:vue.withCtx(()=>t[4]||(t[4]=[vue.createElementVNode("span",{style:{"font-size":"16px"}},"✏️",-1)])),default:vue.withCtx(()=>[t[5]||(t[5]=vue.createTextVNode(" 批量填充表单 ",-1))]),_:1,__:[5]},8,["loading"])]),_:1}),vue.createVNode(x,null,{default:vue.withCtx(()=>[vue.createVNode(w,{type:"warning",block:"",size:"large",onClick:q},{icon:vue.withCtx(()=>t[6]||(t[6]=[vue.createElementVNode("span",{style:{"font-size":"16px"}},"🗑️",-1)])),default:vue.withCtx(()=>[t[7]||(t[7]=vue.createTextVNode(" 清除所有数据 ",-1))]),_:1,__:[7]})]),_:1}),vue.createVNode(x,null,{default:vue.withCtx(()=>[vue.createVNode(w,{type:"success",block:"",size:"large",onClick:C$1},{icon:vue.withCtx(()=>t[8]||(t[8]=[vue.createElementVNode("span",{style:{"font-size":"16px"}},"👁️",-1)])),default:vue.withCtx(()=>[t[9]||(t[9]=vue.createTextVNode(" 预览解析数据 ",-1))]),_:1,__:[9]})]),_:1})]),_:1}),f.value.length>0?(vue.openBlock(),vue.createBlock($,{key:0},{default:vue.withCtx(()=>[vue.createVNode(N,{title:"数据预览",name:"preview"},{default:vue.withCtx(()=>[vue.createVNode(T,{bordered:false,"single-line":false,size:"small"},{default:vue.withCtx(()=>[t[10]||(t[10]=vue.createElementVNode("thead",null,[vue.createElementVNode("tr",null,[vue.createElementVNode("th",null,"序号"),vue.createElementVNode("th",null,"标题名称"),vue.createElementVNode("th",null,"H5链接"),vue.createElementVNode("th",null,"直达链接"),vue.createElementVNode("th",null,"是否iOS")])],-1)),vue.createElementVNode("tbody",null,[(vue.openBlock(true),vue.createElementBlock(vue.Fragment,null,vue.renderList(f.value,(e,t)=>(vue.openBlock(),vue.createElementBlock("tr",{key:t},[vue.createElementVNode("td",null,vue.toDisplayString(t+1),1),vue.createElementVNode("td",null,vue.toDisplayString(e.title),1),vue.createElementVNode("td",null,vue.toDisplayString(e.h5Link),1),vue.createElementVNode("td",null,vue.toDisplayString(e.directLink),1),vue.createElementVNode("td",null,[vue.createVNode(S,{type:e.isIOS?"success":"default",size:"small"},{default:vue.withCtx(()=>[vue.createTextVNode(vue.toDisplayString(e.isIOS?"iOS":"普通"),1)]),_:2},1032,["type"])])]))),128))])]),_:1,__:[10]})]),_:1})]),_:1})):vue.createCommentVNode("",true),g.value.length>0?(vue.openBlock(),vue.createBlock($,{key:1},{default:vue.withCtx(()=>[vue.createVNode(N,{title:"操作日志",name:"logs"},{default:vue.withCtx(()=>[vue.createVNode(z,{log:g.value.join("\n"),rows:6},null,8,["log"])]),_:1})]),_:1})):vue.createCommentVNode("",true)]),_:1})]),_:1})])}}},[["__scopeId","data-v-4830d34f"]]),et={class:"kuaishou-ad-creator"},tt={class:"form-section"},at={class:"form-group"},lt={class:"form-group"},nt={class:"action-section"},ot=["disabled"],st={class:"log-section"},it=te({__name:"KuaishouAdCreator",setup(e){const a=vue.ref(""),l=vue.ref(""),s=vue.ref(false),i=vue.ref([]),r=vue.ref(null),c=(e,t="info")=>{i.value.push({message:e,type:t}),setTimeout(()=>{r.value&&(r.value.scrollTop=r.value.scrollHeight);},0);};vue.onMounted(()=>{const e=GM_getValue("kuaishou_requestData")||"";""!==e?(a.value=e,c("已成功加载保存的请求信息","success")):(c("未检测到保存的请求信息，请先在快手平台执行相关操作以获取请求信息","warning"),c("操作步骤：1. 打开快手广告平台 2. 执行创建广告操作 3. 返回此页面查看是否获取到请求","info"));});const u=()=>Date.now().toString(),p="undefined"!=typeof GM_xmlhttpRequest;c(p);const m=async(e,t,a,l,n)=>(c(`获取达人 ${t} 的视频信息...`),new Promise((o,s)=>{const i=`{"campaignType":7,"videoListType":1,"splash":false,"creativeMaterialTypes":[1,2],"createSourceType":1,"createType":0,"keyword":"${t}","photoSources":[],"sort":1,"photoTags":[],"createTimeRange":[],"photoDupStatus":[],"nativeGoodType":[],"lowQualityStatus":[],"photoPackageIds":[],"dcursor":0,"count":15,"photoAdInfoParam":{"age":[{"min":40,"max":75}],"gender":"","regionCategoryNames":[{"id":"64","name":"宁夏"},{"id":"65","name":"新疆"},{"id":"11","name":"北京"},{"id":"12","name":"天津"},{"id":"13","name":"河北"},{"id":"14","name":"山西"},{"id":"15","name":"内蒙古"},{"id":"21","name":"辽宁"},{"id":"22","name":"吉林"},{"id":"23","name":"黑龙江"},{"id":"31","name":"上海"},{"id":"32","name":"江苏"},{"id":"33","name":"浙江"},{"id":"34","name":"安徽"},{"id":"35","name":"福建"},{"id":"36","name":"江西"},{"id":"37","name":"山东"},{"id":"41","name":"河南"},{"id":"42","name":"湖北"},{"id":"43","name":"湖南"},{"id":"44","name":"广东"},{"id":"45","name":"广西"},{"id":"46","name":"海南"},{"id":"50","name":"重庆"},{"id":"51","name":"四川"},{"id":"52","name":"贵州"},{"id":"53","name":"云南"},{"id":"61","name":"陕西"},{"id":"62","name":"甘肃"},{"id":"63","name":"青海"}],"cpaBid":30000,"ocpxActionType":190,"bidType":10,"audience":[],"unitDayBudget":0,"unitBudgetSchedule":[],"campaignDayBudget":0,"campaignBudgetSchedule":[],"campaignType":7},"adDspPhotoCheckParam":{"videoListType":1,"createSourceType":1,"creativeMaterialTypes":[1,2],"createType":0,"campaignType":7},"ocpcActionType":190,"needToShowGuideUseNewMaterial":false}`;GM_xmlhttpRequest({method:"POST",url:`https://ad.e.kuaishou.com/rest/dsp/control-panel/photo/filter/list?kuaishou.ad.dsp_ph=${e}`,headers:{accept:"application/json","accept-language":"zh-CN,zh;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6","account-id":a,"content-type":"application/json",priority:"u=1, i","sec-ch-ua":'"Not/A)Brand";v="8", "Chromium";v="127", "Edge";v="127"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"Linux"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin","traffic-channel":"pc","x-fetch-time":u(),"x-requestid":n,cookie:document.cookie,"ktrace-str":l},data:i,onload:e=>{try{const a=JSON.parse(e.responseText);c(`获取达人 ${t} 的视频信息成功${a.photos[0].photoId}`,"success"),o(a);}catch(a){c("解析响应失败: "+a.message,"error"),s(a);}},onerror:e=>{c(`请求失败: ${e.status} ${e.statusText}`,"error"),s(new Error(`Network error: ${e.status}`));},ontimeout:()=>{c("请求超时","error"),s(new Error("Request timeout"));},timeout:2e4});})),h=(e,t,a,l,n,o)=>{c("构造请求体...");try{let l=JSON.parse(e);if(l.campaignId=l.campaignId||"",l.unit.campaignId=l.campaignId||"",l.unit.schemaUri=n,l.unit.schemaUrl=n,l.unit.webUri=o,l.unit.name=`${t}_${(new Date).getTime()}`,l.customizedCreative&&l.customizedCreative.creativeListParam&&l.customizedCreative.creativeListParam.length>0){const e=l.customizedCreative.creativeListParam[0];e.coverUrl=a.photos[0].coverUrls[1].url,e.name=`${t}_${(new Date).getTime()}`,e.photoId=a.photos[0].photoId;}return c("构造请求体成功","success"),JSON.stringify(l)}catch(s){return c(`构造请求体失败: ${s.message}`,"error"),e}},f=async(e,t,a,l,n)=>(c("发送广告创建请求..."),new Promise((o,s)=>{GM_xmlhttpRequest({method:"POST",url:`https://ad.e.kuaishou.com/rest/dsp/portal/createUnitAndCreative?kuaishou.ad.dsp_ph=${e}`,headers:{accept:"application/json","accept-language":"zh-CN,zh;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6","account-id":t,"content-type":"application/json",priority:"u=1, i","sec-ch-ua":'"Not/A)Brand";v="8", "Chromium";v="127", "Edge";v="127"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"Linux"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin","traffic-channel":"pc","x-fetch-time":u(),"x-requestid":l,cookie:document.cookie,"ktrace-str":a},data:n,onload:e=>{try{const t=JSON.parse(e.responseText);o(t);}catch(t){c("解析响应失败: "+t.message,"error"),s(t);}},onerror:e=>{c(`请求失败: ${e.status} ${e.statusText}`,"error"),s(new Error(`Network error: ${e.status}`));},ontimeout:()=>{c("请求超时","error"),s(new Error("Request timeout"));},timeout:2e4});})),k=async()=>{if(s.value)c("正在执行中，请稍后再试","error");else {if(!a.value)return c("请先在快手平台执行相关操作以获取请求信息","error"),void alert("请先在快手平台执行相关操作以获取请求信息！");if(l.value){s.value=true,c("开始执行广告批量创建流程...");try{const t=(e=>{try{const t="string"==typeof e?JSON.parse(e):e,a=t.url,l=t.method||"POST",n=t.requestHeaders||{},o=n;if("object"!=typeof n)return JSON.parse(n),null;const s=t.requestBody;console.log(t);const i=JSON.parse(s).campaignId,r=a.match(new RegExp("(?<=dsp_ph=).*"))[0];return {url:a,method:l,headers:n,body:s,requestid:o["x-requestid"],account:o["account-id"],ktrace:o["ktrace-str"],campaignId:i,dsp_ph:r}}catch(t){return c(`解析请求信息失败: ${t.message}`,"error"),null}})(a.value);if(!t)return void c("请求信息解析失败，请检查是否正确获取了请求信息","error");const n=(e=>{c("开始解析Excel数据...");try{const t=e.split("\n"),a=[];for(let e=0;e<t.length;e++){const l=t[e].trim();if(l){const e=l.split("\t");e.length>=4&&a.push({name:e[0],videoId:e[1],dp:e[3],h5:e[2]});}}return c(`解析Excel数据完成，共 ${a.length} 条记录`,"success"),a}catch(t){return c(`解析Excel数据失败: ${t.message}`,"error"),[]}})(l.value);if(0===n.length)return void c("Excel数据解析失败或无有效数据，请检查输入格式","error");const o=t.body;for(let a=0;a<n.length;a++){const l=n[a];c(`处理第 ${a+1}/${n.length} 项: ${l.name}`);try{const e=await m(t.dsp_ph,l.videoId,t.account,t.ktrace,t.requestid),n=h(o,l.name,e,l.videoId,l.dp,l.h5);await f(t.dsp_ph,t.account,t.ktrace,t.requestid,n),c(`处理第 ${a+1} 项完成`,"success");}catch(e){c(`处理第 ${a+1} 项失败: ${e.message}`,"error");}}c("广告批量创建流程执行完成","success");}catch(e){c(`执行过程中发生错误: ${e.message}`,"error");}finally{s.value=false;}}else c("请填写Excel数据表","error");}};return (e,t)=>(vue.openBlock(),vue.createElementBlock("div",et,[vue.createElementVNode("div",tt,[t[6]||(t[6]=vue.createElementVNode("h2",null,"快手广告批量创建工具",-1)),vue.createElementVNode("div",at,[t[2]||(t[2]=vue.createElementVNode("label",{for:"requestInfo"},"发送请求信息:",-1)),vue.withDirectives(vue.createElementVNode("textarea",{id:"requestInfo","onUpdate:modelValue":t[0]||(t[0]=e=>a.value=e),placeholder:"从快手平台自动获取的请求信息，如未显示请先在快手平台执行相关操作",rows:"8",readonly:""},null,512),[[vue.vModelText,a.value]]),t[3]||(t[3]=vue.createElementVNode("div",{class:"hint"}," 💡 请求信息会自动从快手平台获取，如未显示请先在快手平台执行相关操作 ",-1))]),vue.createElementVNode("div",lt,[t[4]||(t[4]=vue.createElementVNode("label",{for:"excelData"},"Excel数据表:",-1)),vue.withDirectives(vue.createElementVNode("textarea",{id:"excelData","onUpdate:modelValue":t[1]||(t[1]=e=>l.value=e),placeholder:"请输入Excel中的数据表（达人名称、视频ID、跳转链接、H5链接，用制表符分隔）",rows:"10"},null,512),[[vue.vModelText,l.value]])]),vue.createElementVNode("div",nt,[vue.createElementVNode("button",{onClick:k,disabled:s.value},vue.toDisplayString(s.value?"执行中...":"开始执行"),9,ot)]),vue.createElementVNode("div",st,[t[5]||(t[5]=vue.createElementVNode("h3",null,"执行日志",-1)),vue.createElementVNode("div",{class:"log-content",ref_key:"logContent",ref:r},[(vue.openBlock(true),vue.createElementBlock(vue.Fragment,null,vue.renderList(i.value,(e,t)=>(vue.openBlock(),vue.createElementBlock("div",{key:t,class:vue.normalizeClass(e.type)},vue.toDisplayString(e.message),3))),128))],512)])])]))}},[["__scopeId","data-v-654ceeb0"]]),rt={class:"kuaishou-ad-creator"},ct={class:"form-section"},ut={class:"form-group"},dt={class:"form-group"},pt={class:"action-section"},mt=["disabled"],ht={class:"log-section"},vt=te({__name:"KuaishouAdCreator_ys",setup(e){const a=vue.ref(""),l=vue.ref(""),s=vue.ref(false),i=vue.ref([]),r=vue.ref(null),c=(e,t="info")=>{i.value.push({message:e,type:t}),setTimeout(()=>{r.value&&(r.value.scrollTop=r.value.scrollHeight);},0);};vue.onMounted(()=>{const e=GM_getValue("kuaishou_requestData")||"";""!==e?(a.value=e,c("已成功加载保存的请求信息","success")):(c("未检测到保存的请求信息，请先在快手平台执行相关操作以获取请求信息","warning"),c("操作步骤：1. 打开快手广告平台 2. 执行创建广告操作 3. 返回此页面查看是否获取到请求","info"));});const u=()=>Date.now().toString(),p="undefined"!=typeof GM_xmlhttpRequest;c(p);const m=async(e,t,a,l,n)=>(c(`获取达人 ${t} 的视频信息...`),new Promise((o,s)=>{const i=`{"authorId":${t},"kolUserType":3,"campaignType":2}`;GM_xmlhttpRequest({method:"POST",url:`https://ad.e.kuaishou.com/rest/dsp/kwai/order/photo/list?kuaishou.ad.dsp_ph=${e}`,headers:{accept:"application/json","accept-language":"zh-CN,zh;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6","account-id":a,"content-type":"application/json",priority:"u=1, i","sec-ch-ua":'"Not/A)Brand";v="8", "Chromium";v="127", "Edge";v="127"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"Linux"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin","traffic-channel":"pc","x-fetch-time":u(),"x-requestid":n,cookie:document.cookie,"ktrace-str":l},data:i,onload:e=>{try{const a=JSON.parse(e.responseText);c(`获取达人 ${t} 的视频信息成功${a.data.photos[0].photoId}`,"success"),o(a.data);}catch(a){c("解析响应失败: "+a.message,"error"),s(a);}},onerror:e=>{c(`请求失败: ${e.status} ${e.statusText}`,"error"),s(new Error(`Network error: ${e.status}`));},ontimeout:()=>{c("请求超时","error"),s(new Error("Request timeout"));},timeout:2e4});})),h=(e,t,a,l,n,o)=>{c("构造请求体...");try{let s=JSON.parse(e);if(s.campaignId=s.campaignId||"",s.unit.campaignId=s.campaignId||"",s.unit.schemaUri=n,s.unit.schemaUrl=n,s.unit.webUri=o,s.unit.name=`${t}_${(new Date).getTime()}`,s.customizedCreative&&s.customizedCreative.creativeListParam&&s.customizedCreative.creativeListParam.length>0){const e=s.customizedCreative.creativeListParam[0];e.description=a.photos[0].caption.slice(0,29).trim(),e.coverUrl=a.photos[0].coverThumbnailUrls[0].url,e.name=`${t}_${(new Date).getTime()}`,e.photoId=a.photos[0].photoId,e.kolUserId=l,e.coverWidth=a.photos[0].width,e.coverHeight=a.photos[0].height;}return c("构造请求体成功","success"),JSON.stringify(s)}catch(s){return c(`构造请求体失败: ${s.message}`,"error"),e}},f=async(e,t,a,l,n)=>(c("发送广告创建请求..."),new Promise((o,s)=>{GM_xmlhttpRequest({method:"POST",url:`https://ad.e.kuaishou.com/rest/dsp/portal/createUnitAndCreative?kuaishou.ad.dsp_ph=${e}`,headers:{accept:"application/json","accept-language":"zh-CN,zh;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6","account-id":t,"content-type":"application/json",priority:"u=1, i","sec-ch-ua":'"Not/A)Brand";v="8", "Chromium";v="127", "Edge";v="127"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"Linux"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin","traffic-channel":"pc","x-fetch-time":u(),"x-requestid":l,cookie:document.cookie,"ktrace-str":a},data:n,onload:e=>{try{const t=JSON.parse(e.responseText);o(t);}catch(t){c("解析响应失败: "+t.message,"error"),s(t);}},onerror:e=>{c(`请求失败: ${e.status} ${e.statusText}`,"error"),s(new Error(`Network error: ${e.status}`));},ontimeout:()=>{c("请求超时","error"),s(new Error("Request timeout"));},timeout:2e4});})),k=async()=>{if(s.value)c("正在执行中，请稍后再试","error");else {if(!a.value)return c("请先在快手平台执行相关操作以获取请求信息","error"),void alert("请先在快手平台执行相关操作以获取请求信息！");if(l.value){s.value=true,c("开始执行广告批量创建流程...");try{const t=(e=>{try{const t="string"==typeof e?JSON.parse(e):e,a=t.url,l=t.method||"POST",n=t.requestHeaders||{},o=n;if("object"!=typeof n)return JSON.parse(n),null;const s=t.requestBody;console.log(t);const i=JSON.parse(s).campaignId,r=a.match(new RegExp("(?<=dsp_ph=).*"))[0];return {url:a,method:l,headers:n,body:s,requestid:o["x-requestid"],account:o["account-id"],ktrace:o["ktrace-str"],campaignId:i,dsp_ph:r}}catch(t){return c(`解析请求信息失败: ${t.message}`,"error"),null}})(a.value);if(!t)return void c("请求信息解析失败，请检查是否正确获取了请求信息","error");const n=(e=>{c("开始解析Excel数据...");try{const t=e.split("\n"),a=[];for(let e=0;e<t.length;e++){const l=t[e].trim();if(l){const e=l.split("\t");e.length>=4&&a.push({name:e[0],videoId:e[1],dp:e[3],h5:e[2]});}}return c(`解析Excel数据完成，共 ${a.length} 条记录`,"success"),a}catch(t){return c(`解析Excel数据失败: ${t.message}`,"error"),[]}})(l.value);if(0===n.length)return void c("Excel数据解析失败或无有效数据，请检查输入格式","error");const o=t.body;for(let a=0;a<n.length;a++){const l=n[a];c(`处理第 ${a+1}/${n.length} 项: ${l.name}`);try{const e=await m(t.dsp_ph,l.videoId,t.account,t.ktrace,t.requestid),n=h(o,l.name,e,l.videoId,l.dp,l.h5);await f(t.dsp_ph,t.account,t.ktrace,t.requestid,n),c(`处理第 ${a+1} 项完成`,"success");}catch(e){c(`处理第 ${a+1} 项失败: ${e.message}`,"error");}}c("广告批量创建流程执行完成","success");}catch(e){c(`执行过程中发生错误: ${e.message}`,"error");}finally{s.value=false;}}else c("请填写Excel数据表","error");}};return (e,t)=>(vue.openBlock(),vue.createElementBlock("div",rt,[vue.createElementVNode("div",ct,[t[6]||(t[6]=vue.createElementVNode("h2",null,"快手广告批量创建工具",-1)),vue.createElementVNode("div",ut,[t[2]||(t[2]=vue.createElementVNode("label",{for:"requestInfo"},"发送请求信息:",-1)),vue.withDirectives(vue.createElementVNode("textarea",{id:"requestInfo","onUpdate:modelValue":t[0]||(t[0]=e=>a.value=e),placeholder:"从快手平台自动获取的请求信息，如未显示请先在快手平台执行相关操作",rows:"8",readonly:""},null,512),[[vue.vModelText,a.value]]),t[3]||(t[3]=vue.createElementVNode("div",{class:"hint"}," 💡 请求信息会自动从快手平台获取，如未显示请先在快手平台执行相关操作 ",-1))]),vue.createElementVNode("div",dt,[t[4]||(t[4]=vue.createElementVNode("label",{for:"excelData"},"Excel数据表:",-1)),vue.withDirectives(vue.createElementVNode("textarea",{id:"excelData","onUpdate:modelValue":t[1]||(t[1]=e=>l.value=e),placeholder:"请输入Excel中的数据表（达人名称、视频ID、跳转链接、H5链接，用制表符分隔）",rows:"10"},null,512),[[vue.vModelText,l.value]])]),vue.createElementVNode("div",pt,[vue.createElementVNode("button",{onClick:k,disabled:s.value},vue.toDisplayString(s.value?"执行中...":"开始执行"),9,mt)]),vue.createElementVNode("div",ht,[t[5]||(t[5]=vue.createElementVNode("h3",null,"执行日志",-1)),vue.createElementVNode("div",{class:"log-content",ref_key:"logContent",ref:r},[(vue.openBlock(true),vue.createElementBlock(vue.Fragment,null,vue.renderList(i.value,(e,t)=>(vue.openBlock(),vue.createElementBlock("div",{key:t,class:vue.normalizeClass(e.type)},vue.toDisplayString(e.message),3))),128))],512)])])]))}},[["__scopeId","data-v-e2ee36d7"]]),gt={class:"button-container"},ft=te({__name:"app",setup(e){C.useMessage();const c=vue.ref({kuaishou:false,close:false,hunjian:false,adCreator:false}),p=[{key:"kuaishou",title:"快手广告填表工具",component:Ye},{key:"close",title:"快手创意关闭",component:Xe},{key:"hunjian",title:"快手混剪工具",component:Ze},{key:"adCreator",title:"快手广告创建工具",component:it},{key:"adCreatorYS",title:"快手广告创建工具_原生",component:vt}],m=e=>{c.value[e]=true;},h=vue.computed(()=>[{key:"kuaishou",type:"primary",icon:"🐒",label:"快手填表",action:()=>m("kuaishou")},{key:"close",type:"error",icon:"🐒",label:"创意关闭",action:()=>m("close")},{key:"hunjian",type:"success",icon:"🐒",label:"混剪工具",action:()=>m("hunjian")},{key:"adCreator",type:"info",icon:"🐒",label:"广告创建",action:()=>m("adCreator")},{key:"adCreatorYS",type:"info",icon:"🐒",label:"广告创建_原生",action:()=>m("adCreatorYS")}]);return (e,t)=>{const a=vue.resolveComponent("n-icon"),m=vue.resolveComponent("n-button"),g=vue.resolveComponent("n-space"),f=vue.resolveComponent("n-modal");return vue.openBlock(),vue.createElementBlock("div",gt,[vue.createVNode(g,{justify:"space-between",wrap:""},{default:vue.withCtx(()=>[(vue.openBlock(true),vue.createElementBlock(vue.Fragment,null,vue.renderList(h.value,e=>(vue.openBlock(),vue.createBlock(m,{key:e.key,type:e.type,size:"large",style:{flex:"1","min-width":"150px",margin:"4px"},onClick:e.action},{icon:vue.withCtx(()=>[vue.createVNode(a,null,{default:vue.withCtx(()=>[vue.createTextVNode(vue.toDisplayString(e.icon),1)]),_:2},1024)]),default:vue.withCtx(()=>[vue.createTextVNode(" "+vue.toDisplayString(e.label),1)]),_:2},1032,["type","onClick"]))),128))]),_:1}),(vue.openBlock(),vue.createElementBlock(vue.Fragment,null,vue.renderList(p,e=>vue.createVNode(f,{key:e.key,show:c.value[e.key],"onUpdate:show":t=>c.value[e.key]=t,preset:"card",style:{width:"800px","max-width":"90vw"},title:e.title,bordered:false,"mask-closable":true,"close-on-esc":true},{default:vue.withCtx(()=>[(vue.openBlock(),vue.createBlock(vue.resolveDynamicComponent(e.component)))]),_:2},1032,["show","onUpdate:show","title"])),64))])}}},[["__scopeId","data-v-ddd76544"]]),yt={class:"hunjianpiliang-container"},_t=te({__name:"hunjianpiliang",props:{tbToken:{type:String,default:""}},setup(e){const d=e,p=C.useMessage(),m=vue.ref(""),v=vue.ref("RED_BOOK"),g=vue.ref("RED_BOOK"),f=vue.ref(false),y=vue.ref([]),k=vue.ref([]),b=vue.ref(0),w=vue.ref(0),x=[{isDefault:true,label:"小红书",value:"RED_BOOK"},{label:"B站",value:"BILIBILI"},{label:"抖音",value:"DOUYIN"},{label:"快手",value:"KUAISHOU"},{label:"腾讯视频号",value:"TENCENT"}],I=vue.computed(()=>w.value>0?Math.round(b.value/w.value*100):0),S=vue.computed(()=>k.value.filter(e=>"success"===e.status).length),T=vue.computed(()=>k.value.filter(e=>"error"===e.status).length),C$1=[{title:"素材ID",key:"remixMaterialId",width:150},{title:"达人唯一标识",key:"koxUniqId",width:150},{title:"商品ID列表",key:"itemIds",width:200},{title:"状态",key:"status",width:100,render:e=>{const t="success"===e.status?"success":"error",a="success"===e.status?"成功":"失败",l="success"===e.status?"✅":"❌";return h("n-tag",{type:t,size:"small"},{default:()=>[l," ",a]})}},{title:"错误信息",key:"error",ellipsis:{tooltip:true}}],$=e=>{const t=(new Date).toLocaleTimeString();y.value.unshift(`[${t}] ${e}`),y.value.length>50&&(y.value=y.value.slice(0,50));},z=async e=>{const[t,a,l,n]=e,o=location.search.match(new RegExp("(?<=eventId=).*"))[0],s=v.value,i=l.split(",")[0],r=d.tbToken||"ee3b737e1e7ee";try{const e=await fetch("https://adstar.alimama.com/openapi/json2/1/gateway.unionpub/union.kox.summary.query.json?bizCode=adstar&_tb_token_="+r+"&uidList="+a+"&mediaBpCode="+g.value,{method:"GET",headers:{_tb_token_:r,accept:"*/*","accept-language":"zh-CN,zh;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6","bx-v":"2.5.11","content-type":"application/x-www-form-urlencoded; charset=UTF-8",priority:"u=1, i","sec-ch-ua":'"Microsoft Edge";v="141", "Not?A_Brand";v="8", "Chromium";v="141"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"macOS"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin","x-requested-with":"XMLHttpRequest"},referrer:"https://adstar.alimama.com/portal/v2/pages/tasks/detail/self_official.htm?eventId="+o,mode:"cors",credentials:"include"}),l=await e.json();if(!l.success||!l.model||0===l.model.length)throw new Error("请求1失败：未获取到有效的达人数据");const c=l.model[0],u={eventId:o,media:s,isRemix:!0,remixMaterialSrcMedia:g.value,koxNickname:c.nick,koxUniqId:c.uniqId,remixEditor:n,cpId:1314017170,remixMaterialId:t,koxId:c.uid,stickyItemId:i,extraInfo:"{}"},d="_data_="+encodeURIComponent(JSON.stringify(u)),p=await fetch("https://adstar.alimama.com/openapi/param2/1/gateway.unionpub/union.adcontent.kox.link.record.add.json?_tb_token_="+r,{method:"POST",headers:{accept:"*/*","accept-language":"zh-CN,zh;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6","bx-v":"2.5.11","content-type":"application/x-www-form-urlencoded; charset=UTF-8",priority:"u=1, i","sec-ch-ua":'"Microsoft Edge";v="141", "Not?A_Brand";v="8", "Chromium";v="141"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"macOS"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin","x-requested-with":"XMLHttpRequest"},referrer:"https://adstar.alimama.com/portal/v2/pages/tasks/detail/self_official.htm?eventId="+o,body:d,mode:"cors",credentials:"include"}),m=await p.json();return console.log("请求2响应：",m),m}catch(c){throw console.error("执行过程中出错：",c),c}},U=async()=>{if(m.value.trim()){f.value=true,k.value=[],b.value=0;try{const t=m.value.trim().split("\n").map(e=>e.split("\t"));w.value=t.length;for(const a of t)try{b.value++,$(`正在处理记录: ${a[0]}`),await z(a),k.value.push({koxNickname:a[0],index:a[1],remixMaterialId:a[2],koxUniqId:a[3],taskType:a[4],itemIds:a[5],status:"success",error:""}),await new Promise(e=>setTimeout(e,1e3));}catch(e){b.value++,$(`处理记录 ${a[0]} 时出错: ${e.message}`),k.value.push({koxNickname:a[0]||"",index:a[1]||"",remixMaterialId:a[2]||"",koxUniqId:a[3]||"",taskType:a[4]||"",itemIds:a[5]||"",status:"error",error:e.message});}p.success(`批量处理完成! 成功 ${S.value} 条，失败 ${T.value} 条`),$(`批量处理完成! 成功 ${S.value} 条，失败 ${T.value} 条`);}catch(e){console.error("批量处理过程中出错：",e),p.error("批量处理失败: "+e.message),$("批量处理失败: "+e.message);}finally{f.value=false;}}else p.warning("请先输入数据");},q=()=>{m.value="",k.value=[],y.value=[],b.value=0,w.value=0,p.success("已清除所有数据"),$("清除所有数据");};return (e,t)=>{const a=vue.resolveComponent("n-input"),d=vue.resolveComponent("n-text"),p=vue.resolveComponent("n-form-item"),h=vue.resolveComponent("n-select"),b=vue.resolveComponent("n-button"),N=vue.resolveComponent("n-space"),$=vue.resolveComponent("n-progress"),z=vue.resolveComponent("n-statistic"),D=vue.resolveComponent("n-grid-item"),O=vue.resolveComponent("n-grid"),E=vue.resolveComponent("n-data-table"),j=vue.resolveComponent("n-collapse-item"),B=vue.resolveComponent("n-collapse"),P=vue.resolveComponent("n-log"),A=vue.resolveComponent("n-card");return vue.openBlock(),vue.createElementBlock("div",yt,[vue.createVNode(A,{title:"混剪批量处理工具",class:"main-card"},{default:vue.withCtx(()=>[vue.createVNode(N,{vertical:"",size:16},{default:vue.withCtx(()=>[vue.createVNode(p,{label:"数据输入"},{feedback:vue.withCtx(()=>[vue.createVNode(d,{depth:"3",style:{"font-size":"12px"}},{default:vue.withCtx(()=>t[3]||(t[3]=[vue.createTextVNode(" 每行一条数据，字段间用制表符分隔 ",-1)])),_:1,__:[3]})]),default:vue.withCtx(()=>[vue.createVNode(a,{value:m.value,"onUpdate:value":t[0]||(t[0]=e=>m.value=e),type:"textarea",placeholder:"请输入数据，格式：素材id 达人标识 商品id 剪辑师",autosize:{minRows:6,maxRows:12}},null,8,["value"])]),_:1}),vue.createVNode(p,{label:"星任务平台"},{default:vue.withCtx(()=>[vue.createVNode(h,{value:v.value,"onUpdate:value":t[1]||(t[1]=e=>v.value=e),options:x,placeholder:"星任务平台"},null,8,["value"])]),_:1}),vue.createVNode(p,{label:"素材来源平台"},{default:vue.withCtx(()=>[vue.createVNode(h,{value:g.value,"onUpdate:value":t[2]||(t[2]=e=>g.value=e),options:x,placeholder:"请选择素材来源平台"},null,8,["value"])]),_:1}),vue.createVNode(N,{justify:"center"},{default:vue.withCtx(()=>[vue.createVNode(b,{type:"primary",size:"large",onClick:U,loading:f.value,disabled:!m.value.trim()},{icon:vue.withCtx(()=>t[4]||(t[4]=[vue.createElementVNode("span",{style:{"font-size":"16px"}},"🚀",-1)])),default:vue.withCtx(()=>[t[5]||(t[5]=vue.createTextVNode(" 开始批量处理 ",-1))]),_:1,__:[5]},8,["loading","disabled"]),vue.createVNode(b,{type:"warning",size:"large",onClick:q},{icon:vue.withCtx(()=>t[6]||(t[6]=[vue.createElementVNode("span",{style:{"font-size":"16px"}},"🗑️",-1)])),default:vue.withCtx(()=>[t[7]||(t[7]=vue.createTextVNode(" 清除数据 ",-1))]),_:1,__:[7]})]),_:1}),f.value?(vue.openBlock(),vue.createBlock($,{key:0,type:"line",percentage:I.value,"indicator-placement":"inside",processing:""},null,8,["percentage"])):vue.createCommentVNode("",true),k.value.length>0?(vue.openBlock(),vue.createBlock(O,{key:1,cols:3,"x-gap":12},{default:vue.withCtx(()=>[vue.createVNode(D,null,{default:vue.withCtx(()=>[vue.createVNode(z,{label:"总记录数",value:w.value},null,8,["value"])]),_:1}),vue.createVNode(D,null,{default:vue.withCtx(()=>[vue.createVNode(z,{label:"成功",value:S.value},{prefix:vue.withCtx(()=>t[8]||(t[8]=[vue.createElementVNode("span",null,"✅",-1)])),_:1},8,["value"])]),_:1}),vue.createVNode(D,null,{default:vue.withCtx(()=>[vue.createVNode(z,{label:"失败",value:T.value},{prefix:vue.withCtx(()=>t[9]||(t[9]=[vue.createElementVNode("span",null,"❌",-1)])),_:1},8,["value"])]),_:1})]),_:1})):vue.createCommentVNode("",true),k.value.length>0?(vue.openBlock(),vue.createBlock(B,{key:2},{default:vue.withCtx(()=>[vue.createVNode(j,{title:"处理结果详情",name:"results"},{default:vue.withCtx(()=>[vue.createVNode(E,{columns:C$1,data:k.value,pagination:{pageSize:10},size:"small",striped:""},null,8,["data"])]),_:1})]),_:1})):vue.createCommentVNode("",true),y.value.length>0?(vue.openBlock(),vue.createBlock(B,{key:3},{default:vue.withCtx(()=>[vue.createVNode(j,{title:"操作日志",name:"logs"},{default:vue.withCtx(()=>[vue.createVNode(P,{log:y.value.join("\n"),rows:8},null,8,["log"])]),_:1})]),_:1})):vue.createCommentVNode("",true)]),_:1})]),_:1})])}}},[["__scopeId","data-v-866e6680"]]),kt={class:"hunjianpiliang-container"},bt=te({__name:"ys",props:{tbToken:{type:String,default:""}},setup(e){const d=e,p=C.useMessage(),m=vue.ref(""),v=vue.ref("RED_BOOK"),g=vue.ref(false),f=vue.ref([]),y=vue.ref([]),k=vue.ref(0),b=vue.ref(0),w=[{isDefault:true,label:"小红书",value:"RED_BOOK"},{label:"B站",value:"BILIBILI"},{label:"抖音",value:"DOUYIN"},{label:"快手",value:"KUAISHOU"},{label:"腾讯视频号",value:"TENCENT"}],x=vue.computed(()=>b.value>0?Math.round(k.value/b.value*100):0),I=vue.computed(()=>y.value.filter(e=>"success"===e.status).length),S=vue.computed(()=>y.value.filter(e=>"error"===e.status).length),T=[{title:"达人唯一标识",key:"koxUniqId",width:150},{title:"商品ID列表",key:"itemIds",width:200},{title:"状态",key:"status",width:100,render:e=>{const t="success"===e.status?"success":"error",a="success"===e.status?"成功":"失败",l="success"===e.status?"✅":"❌";return h("n-tag",{type:t,size:"small"},{default:()=>[l," ",a]})}},{title:"错误信息",key:"error",ellipsis:{tooltip:true}}],C$1=e=>{const t=(new Date).toLocaleTimeString();f.value.unshift(`[${t}] ${e}`),f.value.length>50&&(f.value=f.value.slice(0,50));},$=async e=>{const[t,a]=e,l=location.search.match(new RegExp("(?<=eventId=).*"))[0],n=v.value,o=a.split(",")[0],s=d.tbToken||"ee3b737e1e7ee";try{const e=await fetch("https://adstar.alimama.com/openapi/json2/1/gateway.unionpub/union.kox.summary.query.json?bizCode=adstar&_tb_token_="+s+"&uidList="+t+"&mediaBpCode="+v.value,{method:"GET",headers:{_tb_token_:s,accept:"*/*","accept-language":"zh-CN,zh;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6","bx-v":"2.5.11","content-type":"application/x-www-form-urlencoded; charset=UTF-8",priority:"u=1, i","sec-ch-ua":'"Microsoft Edge";v="141", "Not?A_Brand";v="8", "Chromium";v="141"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"macOS"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin","x-requested-with":"XMLHttpRequest"},referrer:"https://adstar.alimama.com/portal/v2/pages/tasks/detail/self_official.htm?eventId="+l,mode:"cors",credentials:"include"}),a=await e.json();if(!a.success||!a.model||0===a.model.length)throw new Error("请求1失败：未获取到有效的达人数据");const i=a.model[0],r={eventId:l,media:n,isRemix:!1,koxNickname:i.nick,koxUniqId:i.uniqId,cpId:1314017170,koxId:i.uid,stickyItemId:o,extraInfo:"{}"},c="_data_="+encodeURIComponent(JSON.stringify(r)),u=await fetch("https://adstar.alimama.com/openapi/param2/1/gateway.unionpub/union.adcontent.kox.link.record.add.json?_tb_token_="+s,{method:"POST",headers:{accept:"*/*","accept-language":"zh-CN,zh;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6","bx-v":"2.5.11","content-type":"application/x-www-form-urlencoded; charset=UTF-8",priority:"u=1, i","sec-ch-ua":'"Microsoft Edge";v="141", "Not?A_Brand";v="8", "Chromium";v="141"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"macOS"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin","x-requested-with":"XMLHttpRequest"},referrer:"https://adstar.alimama.com/portal/v2/pages/tasks/detail/self_official.htm?eventId="+l,body:c,mode:"cors",credentials:"include"}),d=await u.json();return console.log("请求2响应：",d),d}catch(i){throw console.error("执行过程中出错：",i),i}},z=async()=>{if(m.value.trim()){g.value=true,y.value=[],k.value=0;try{const t=m.value.trim().split("\n").map(e=>e.split("\t"));b.value=t.length;for(const a of t)try{k.value++,C$1(`正在处理记录: ${a[0]}`),await $(a),y.value.push({koxNickname:a[0],index:a[1],koxUniqId:a[3],taskType:a[4],itemIds:a[5],status:"success",error:""}),await new Promise(e=>setTimeout(e,1e3));}catch(e){k.value++,C$1(`处理记录 ${a[0]} 时出错: ${e.message}`),y.value.push({koxNickname:a[0]||"",index:a[1]||"",koxUniqId:a[3]||"",taskType:a[4]||"",itemIds:a[5]||"",status:"error",error:e.message});}p.success(`批量处理完成! 成功 ${I.value} 条，失败 ${S.value} 条`),C$1(`批量处理完成! 成功 ${I.value} 条，失败 ${S.value} 条`);}catch(e){console.error("批量处理过程中出错：",e),p.error("批量处理失败: "+e.message),C$1("批量处理失败: "+e.message);}finally{g.value=false;}}else p.warning("请先输入数据");},U=()=>{m.value="",y.value=[],f.value=[],k.value=0,b.value=0,p.success("已清除所有数据"),C$1("清除所有数据");};return (e,t)=>{const a=vue.resolveComponent("n-input"),d=vue.resolveComponent("n-text"),p=vue.resolveComponent("n-form-item"),h=vue.resolveComponent("n-select"),k=vue.resolveComponent("n-button"),C=vue.resolveComponent("n-space"),N=vue.resolveComponent("n-progress"),$=vue.resolveComponent("n-statistic"),q=vue.resolveComponent("n-grid-item"),D=vue.resolveComponent("n-grid"),O=vue.resolveComponent("n-data-table"),E=vue.resolveComponent("n-collapse-item"),j=vue.resolveComponent("n-collapse"),B=vue.resolveComponent("n-log"),P=vue.resolveComponent("n-card");return vue.openBlock(),vue.createElementBlock("div",kt,[vue.createVNode(P,{title:"原生批量处理工具",class:"main-card"},{default:vue.withCtx(()=>[vue.createVNode(C,{vertical:"",size:16},{default:vue.withCtx(()=>[vue.createVNode(p,{label:"数据输入"},{feedback:vue.withCtx(()=>[vue.createVNode(d,{depth:"3",style:{"font-size":"12px"}},{default:vue.withCtx(()=>t[2]||(t[2]=[vue.createTextVNode(" 每行一条数据，字段间用制表符分隔 ",-1)])),_:1,__:[2]})]),default:vue.withCtx(()=>[vue.createVNode(a,{value:m.value,"onUpdate:value":t[0]||(t[0]=e=>m.value=e),type:"textarea",placeholder:"请输入数据，格式：素材id 达人标识 商品id 剪辑师",autosize:{minRows:6,maxRows:12}},null,8,["value"])]),_:1}),vue.createVNode(p,{label:"星任务平台"},{default:vue.withCtx(()=>[vue.createVNode(h,{value:v.value,"onUpdate:value":t[1]||(t[1]=e=>v.value=e),options:w,placeholder:"星任务平台"},null,8,["value"])]),_:1}),vue.createVNode(C,{justify:"center"},{default:vue.withCtx(()=>[vue.createVNode(k,{type:"primary",size:"large",onClick:z,loading:g.value,disabled:!m.value.trim()},{icon:vue.withCtx(()=>t[3]||(t[3]=[vue.createElementVNode("span",{style:{"font-size":"16px"}},"🚀",-1)])),default:vue.withCtx(()=>[t[4]||(t[4]=vue.createTextVNode(" 开始批量处理 ",-1))]),_:1,__:[4]},8,["loading","disabled"]),vue.createVNode(k,{type:"warning",size:"large",onClick:U},{icon:vue.withCtx(()=>t[5]||(t[5]=[vue.createElementVNode("span",{style:{"font-size":"16px"}},"🗑️",-1)])),default:vue.withCtx(()=>[t[6]||(t[6]=vue.createTextVNode(" 清除数据 ",-1))]),_:1,__:[6]})]),_:1}),g.value?(vue.openBlock(),vue.createBlock(N,{key:0,type:"line",percentage:x.value,"indicator-placement":"inside",processing:""},null,8,["percentage"])):vue.createCommentVNode("",true),y.value.length>0?(vue.openBlock(),vue.createBlock(D,{key:1,cols:3,"x-gap":12},{default:vue.withCtx(()=>[vue.createVNode(q,null,{default:vue.withCtx(()=>[vue.createVNode($,{label:"总记录数",value:b.value},null,8,["value"])]),_:1}),vue.createVNode(q,null,{default:vue.withCtx(()=>[vue.createVNode($,{label:"成功",value:I.value},{prefix:vue.withCtx(()=>t[7]||(t[7]=[vue.createElementVNode("span",null,"✅",-1)])),_:1},8,["value"])]),_:1}),vue.createVNode(q,null,{default:vue.withCtx(()=>[vue.createVNode($,{label:"失败",value:S.value},{prefix:vue.withCtx(()=>t[8]||(t[8]=[vue.createElementVNode("span",null,"❌",-1)])),_:1},8,["value"])]),_:1})]),_:1})):vue.createCommentVNode("",true),y.value.length>0?(vue.openBlock(),vue.createBlock(j,{key:2},{default:vue.withCtx(()=>[vue.createVNode(E,{title:"处理结果详情",name:"results"},{default:vue.withCtx(()=>[vue.createVNode(O,{columns:T,data:y.value,pagination:{pageSize:10},size:"small",striped:""},null,8,["data"])]),_:1})]),_:1})):vue.createCommentVNode("",true),f.value.length>0?(vue.openBlock(),vue.createBlock(j,{key:3},{default:vue.withCtx(()=>[vue.createVNode(E,{title:"操作日志",name:"logs"},{default:vue.withCtx(()=>[vue.createVNode(B,{log:f.value.join("\n"),rows:8},null,8,["log"])]),_:1})]),_:1})):vue.createCommentVNode("",true)]),_:1})]),_:1})])}}},[["__scopeId","data-v-f1625577"]]),wt={class:"button-container"},xt=te({__name:"app",setup(e){C.useMessage();const p=vue.ref(false),m=vue.ref("");vue.ref(0);const h=vue.ref({hunjianpiliang:false}),g=[{key:"hunjianpiliang",title:"混剪批量处理",component:_t},{key:"ys",title:"原生批量处理",component:bt}],f=e=>{h.value[e]=true;},y=vue.computed(()=>[{key:"hunjianpiliang",type:"primary",icon:"🎬",label:"混剪批量处理",action:()=>f("hunjianpiliang")},{key:"ys",type:"primary",icon:"🎬",label:"原生批量处理",action:()=>f("ys")}]);return (e,t)=>{const a=vue.resolveComponent("n-icon"),f=vue.resolveComponent("n-button"),_=vue.resolveComponent("n-space"),k=vue.resolveComponent("n-alert"),x=vue.resolveComponent("n-modal");return vue.openBlock(),vue.createElementBlock("div",wt,[vue.createVNode(_,{justify:"space-between",wrap:""},{default:vue.withCtx(()=>[(vue.openBlock(true),vue.createElementBlock(vue.Fragment,null,vue.renderList(y.value,e=>(vue.openBlock(),vue.createBlock(f,{key:e.key,type:e.type,size:"large",style:{flex:"1","min-width":"150px",margin:"4px"},onClick:e.action},{icon:vue.withCtx(()=>[vue.createVNode(a,null,{default:vue.withCtx(()=>[vue.createTextVNode(vue.toDisplayString(e.icon),1)]),_:2},1024)]),default:vue.withCtx(()=>[vue.createTextVNode(" "+vue.toDisplayString(e.label),1)]),_:2},1032,["type","onClick"]))),128))]),_:1}),p.value?(vue.openBlock(),vue.createBlock(k,{key:0,type:"info",style:{"margin-top":"20px"},closable:""},{icon:vue.withCtx(()=>[vue.createVNode(a,null,{default:vue.withCtx(()=>t[0]||(t[0]=[vue.createTextVNode("🔊",-1)])),_:1,__:[0]})]),default:vue.withCtx(()=>[t[1]||(t[1]=vue.createTextVNode(" 正在监听中...捕获到的_tb_token_值将自动传递给混剪批量处理工具 ",-1))]),_:1,__:[1]})):vue.createCommentVNode("",true),(vue.openBlock(),vue.createElementBlock(vue.Fragment,null,vue.renderList(g,e=>vue.createVNode(x,{key:e.key,show:h.value[e.key],"onUpdate:show":t=>h.value[e.key]=t,preset:"card",style:{width:"1200px","max-width":"95vw",height:"90vh"},title:e.title,bordered:false,"mask-closable":true,"close-on-esc":true},{default:vue.withCtx(()=>[(vue.openBlock(),vue.createBlock(vue.resolveDynamicComponent(e.component),{"tb-token":m.value},null,8,["tb-token"]))]),_:2},1032,["show","onUpdate:show","title"])),64))])}}},[["__scopeId","data-v-4c94ffe2"]]),It={class:"kanban-table-container"},St={style:{"margin-bottom":"16px"}},Tt=te({__name:"table",setup(e){const l=vue.ref([]),p=vue.ref(false),m=vue.ref(null),h=vue.ref(""),v=vue.ref(true),g={pageSize:20},f=vue.computed(()=>{if(T.value&&0!==T.value.length)return Math.max(1200,150*T.value.length)}),b=async()=>{try{const e=await new Promise((e,t)=>{const a=indexedDB.open("RequestDataDB",1);a.onerror=e=>{console.error("IndexedDB 初始化失败:",e.target.error),t(e.target.error);},a.onsuccess=t=>{e(t.target.result);},a.onupgradeneeded=e=>{const t=e.target.result;t.objectStoreNames.contains("requests")||t.createObjectStore("requests",{keyPath:"id"}).createIndex("name","name",{unique:!1});};}),t=e.transaction(["requests"],"readonly"),a=t.objectStore("requests").getAll();a.onsuccess=t=>{const a=t.target.result.filter(e=>"alibaba_responseData"===e.name).map(e=>e.data);let n=null;try{const e=GM_getValue("exported_data");e&&(n=JSON.parse(e));}catch(o){console.error("加载配置数据失败:",o);}l.value=a,e.close();},a.onerror=t=>{console.error("获取阿里数据失败:",t.target.error),e.close();};}catch(e){console.error("IndexedDB 操作失败:",e);}},w=e=>{if(null==e)return "N/A";if("object"==typeof e){const t=JSON.stringify(e);return t.length>100?t.substring(0,100)+"...":t}return "string"==typeof e&&e.length>100?e.substring(0,100)+"...":e},x=(e,t)=>{const a=t.split(".");let l=e;for(const n of a){if(!l||"object"!=typeof l||!(n in l))return;l=l[n];}return l},I=()=>{if(!U.value||0===U.value.length)return void alert("没有数据可导出");const e=T.value.map(e=>e.title),t=T.value.map(e=>e.key);let a="\ufeff"+e.join(",")+"\n";U.value.forEach(e=>{const l=t.map(t=>{const a=x(e,t),l=w(a);return "string"==typeof l&&(l.includes(",")||l.includes('"'))?`"${l.replace(/"/g,'""')}"`:l});a+=l.join(",")+"\n";});const l=new Blob([a],{type:"text/csv;charset=utf-8;"}),n=URL.createObjectURL(l),o=document.createElement("a");o.setAttribute("href",n),o.setAttribute("download",`alibaba_data_${(new Date).toISOString().slice(0,10)}.csv`),o.style.visibility="hidden",document.body.appendChild(o),o.click(),document.body.removeChild(o);},S=[{condition:e=>e&&e.includes("信息流"),value:"信息流"},{condition:e=>e&&e.includes("搜索"),value:"搜索"},{condition:e=>e&&e.includes("视频流"),value:"视频流"},{condition:()=>true,value:"未匹配上"}],T=vue.computed(()=>{if(!U.value||0===U.value.length)return [];const e=U.value[0];return e?Object.keys(e).map(e=>({title:e,key:e,ellipsis:true,maxWidth:200,sorter:(t,a)=>{const l=x(t,e),n=x(a,e);if("number"==typeof l&&"number"==typeof n)return l-n;const o=String(l||""),s=String(n||"");return o.localeCompare(s)},render:t=>{const a=x(t,e);return w(a)}})):[]}),C$1=vue.computed(()=>[{title:"分类字段",key:"category",ellipsis:true,maxWidth:200},{title:"记录数",key:"count",sorter:(e,t)=>e.count-t.count},{title:"总消耗",key:"totalCost",sorter:(e,t)=>e.totalCost-t.totalCost,render:e=>e.totalCost.toFixed(2)},{title:"平均消耗",key:"avgCost",sorter:(e,t)=>e.avgCost-t.avgCost,render:e=>e.avgCost.toFixed(2)},{title:"总UV",key:"totalUv",sorter:(e,t)=>e.totalUv-t.totalUv},{title:"平均UV成本",key:"avgUvCost",sorter:(e,t)=>e.avgUvCost-t.avgUvCost,render:e=>e.avgUvCost.toFixed(2)}]),N=vue.computed(()=>{if(!h.value)return U.value;const e=h.value.toLowerCase();return U.value.filter(t=>Object.keys(t).some(a=>{const l=x(t,a);return String(l).toLowerCase().includes(e)}))}),z=vue.computed(()=>((e,t="星任务分类")=>{if(!e||0===e.length)return [];const a={};return e.forEach(e=>{const l=e[t]||"未分类";a[l]||(a[l]={category:l,count:0,totalCost:0,totalUv:0}),a[l].count+=1,a[l].totalCost+=parseFloat(e["消耗"])||0,a[l].totalUv+=parseFloat(e["3d_last_click_商品三级行业_标准搜索uv"])||0;}),Object.values(a).map(e=>{const t=e.totalUv>0?e.totalCost/e.totalUv:0;return {...e,avgCost:e.count>0?e.totalCost/e.count:0,avgUvCost:t}})})(U.value,"星任务分类")),U=vue.computed(()=>{if(!l.value||0===l.value.length)return [];let e=[];l.value.forEach((t,a)=>{console.log(`处理第 ${a} 项数据:`,t);const l=t.response?.data;l?Array.isArray(l)?(console.log(`第 ${a} 项 data 是数组，长度: ${l.length}`),l.forEach((t,l)=>{e.push({...t}),console.log(`第 ${a} 项第 ${l} 行数据:`,t);})):(console.log(`第 ${a} 项 data 是对象`),e.push({...l})):console.log(`第 ${a} 项没有 response.data 数据`);});const t=(()=>{try{const e=GM_getValue("exported_data");if(e)return JSON.parse(e)}catch(e){console.error("加载配置数据失败:",e);}return null})();var a,n,o;return a="创意名称",n=S,o="type",e=e.map(e=>{const t=e[a];let l=null;for(const a of n)if(a.condition(t,e)){l=a.value;break}return null===l&&n.default&&(l="function"==typeof n.default?n.default(t,e):n.default),{...e,[o]:l}}),e=((e,t)=>{const a=new Map;return t&&Object.keys(t).forEach(e=>{const l=t[e];Array.isArray(l)&&l.forEach(t=>{"string"==typeof t?a.set(t,e):"number"==typeof t&&a.set(t.toString(),e);});}),e.map(e=>{const t=e["星任务id"];let l="未匹配";if(null!=t){const e=t.toString();a.has(e)&&(l=a.get(e));}return {...e,"星任务分类":l}})})(e,t),e=(e=>e.map(e=>{const t=parseFloat(e["消耗"])||0,a=parseFloat(e["3d_last_click_商品三级行业_标准搜索uv"])||0;if(0===t||0===a)return {...e,"uv成本":0};const l=t/a;return {...e,"uv成本":parseFloat(l).toFixed(2)}}))(e),console.log("最终的 tableData:",e),e});return vue.onMounted(()=>{b();}),(e,t)=>(vue.openBlock(),vue.createElementBlock("div",It,[vue.createVNode(vue.unref(C.NCard),{title:"阿里接口响应数据",size:"small"},{default:vue.withCtx(()=>[vue.createElementVNode("div",St,[vue.createVNode(vue.unref(C.NSpace),null,{default:vue.withCtx(()=>[vue.createVNode(vue.unref(C.NButton),{onClick:I,size:"small"},{default:vue.withCtx(()=>t[3]||(t[3]=[vue.createTextVNode(" 📥 导出 CSV ",-1)])),_:1,__:[3]}),vue.createVNode(vue.unref(C.NInput),{value:h.value,"onUpdate:value":t[0]||(t[0]=e=>h.value=e),placeholder:"搜索...",size:"small",style:{width:"200px"}},null,8,["value"]),vue.createVNode(vue.unref(C.NSwitch),{value:v.value,"onUpdate:value":t[1]||(t[1]=e=>v.value=e),size:"small"},{checked:vue.withCtx(()=>t[4]||(t[4]=[vue.createTextVNode(" 隐藏汇总 ",-1)])),unchecked:vue.withCtx(()=>t[5]||(t[5]=[vue.createTextVNode(" 显示汇总 ",-1)])),_:1},8,["value"])]),_:1})]),v.value&&z.value.length>0?(vue.openBlock(),vue.createBlock(vue.unref(C.NCard),{key:0,title:"分类汇总数据",style:{"margin-bottom":"20px"},size:"small"},{default:vue.withCtx(()=>[vue.createVNode(vue.unref(C.NDataTable),{columns:C$1.value,data:z.value,bordered:true,"single-line":false,style:{"font-size":"12px"}},null,8,["columns","data"])]),_:1})):vue.createCommentVNode("",true),N.value.length>0?(vue.openBlock(),vue.createBlock(vue.unref(C.NDataTable),{key:1,columns:T.value,data:N.value,pagination:g,bordered:true,"single-line":false,"scroll-x":f.value,style:{"font-size":"12px"}},null,8,["columns","data","scroll-x"])):(vue.openBlock(),vue.createBlock(vue.unref(C.NEmpty),{key:2,description:"暂无数据"}))]),_:1}),vue.createVNode(vue.unref(C.NModal),{show:p.value,"onUpdate:show":t[2]||(t[2]=e=>p.value=e),preset:"card",style:{width:"80%","max-width":"800px"},segmented:{footer:"soft"}},{default:vue.withCtx(()=>[vue.createElementVNode("pre",null,vue.toDisplayString(JSON.stringify(m.value,null,2)),1)]),_:1},8,["show"])]))}},[["__scopeId","data-v-18710e37"]]),Ct={class:"option-container"},Nt={style:{display:"flex","align-items":"center","margin-bottom":"8px"}},$t=te({__name:"option",setup(e){const a=vue.ref({storageKey:"exported_data"}),l=vue.ref([{key:"",values:[]}]),c=()=>{l.value.push({key:"",values:[]});},d=()=>{confirm("确定要重置所有配置吗？这将清除当前所有配置项！")&&(a.value.storageKey="exported_data",l.value=[{key:"",values:[]}]);},p=()=>{try{const e=GM_getValue(a.value.storageKey);if(e){const t=JSON.parse(e),a=[];Object.keys(t).forEach(e=>{a.push({key:e,values:Array.isArray(t[e])?t[e]:[t[e]]});}),l.value=a,alert(`成功从 GM_Value 读取配置，共加载 ${a.length} 项配置`);}else alert("未找到存储的数据");}catch(e){console.error("读取配置失败:",e),alert("读取配置失败，请查看控制台了解详情");}},m=()=>{try{if(l.value.some(e=>""===e.key.trim()))return void alert("请确保所有配置项都填写了键名");const e={};l.value.forEach(t=>{""!==t.key.trim()&&(e[t.key]=[...t.values]);}),GM_setValue(a.value.storageKey,JSON.stringify(e)),console.log("数据已保存到 GM_setValue:",e),alert(`数据已成功保存到 GM_setValue，键名为: ${a.value.storageKey}`);}catch(e){console.error("保存失败:",e),alert("保存失败，请查看控制台了解详情");}};return vue.onMounted(()=>{p();}),(e,t)=>(vue.openBlock(),vue.createElementBlock("div",Ct,[vue.createVNode(vue.unref(C.NAlert),{type:"info",closable:"",style:{"margin-bottom":"20px"}},{default:vue.withCtx(()=>t[0]||(t[0]=[vue.createTextVNode(" 记得点保存 ",-1)])),_:1,__:[0]}),vue.createVNode(vue.unref(C.NForm),{model:a.value,"label-placement":"left","label-width":"100"},{default:vue.withCtx(()=>[vue.createVNode(vue.unref(C.NFormItem),{label:"数据配置 📊"},{default:vue.withCtx(()=>[vue.createVNode(vue.unref(C.NCard),{embedded:"",bordered:false,style:{"margin-bottom":"15px"}},{default:vue.withCtx(()=>[0===l.value.length?(vue.openBlock(),vue.createBlock(vue.unref(C.NEmpty),{key:0,description:"暂无配置项"},{extra:vue.withCtx(()=>[vue.createVNode(vue.unref(C.NButton),{type:"primary",onClick:c},{default:vue.withCtx(()=>t[1]||(t[1]=[vue.createTextVNode(" ➕ 添加第一项配置 ",-1)])),_:1,__:[1]})]),_:1})):(vue.openBlock(),vue.createBlock(vue.unref(C.NScrollbar),{key:1,trigger:"none",style:{"max-height":"400px","padding-right":"10px"}},{default:vue.withCtx(()=>[vue.createVNode(vue.unref(C.NCollapse),{"default-expanded-names":"0",accordion:true},{default:vue.withCtx(()=>[(vue.openBlock(true),vue.createElementBlock(vue.Fragment,null,vue.renderList(l.value,(e,a)=>{return vue.openBlock(),vue.createBlock(vue.unref(C.NCollapseItem),{key:a,name:a.toString(),title:`配置项 ${a+1}${e.key?": "+e.key:""} ${n=e.key,n?n.includes("name")||n.includes("title")?"📝":n.includes("id")||n.includes("num")?"🔢":n.includes("date")||n.includes("time")?"📅":n.includes("url")||n.includes("link")?"🔗":n.includes("email")?"📧":n.includes("phone")||n.includes("tel")?"📱":n.includes("price")||n.includes("cost")?"💰":n.includes("status")?"📌":"🏷️":""}`},{default:vue.withCtx(()=>[vue.createVNode(vue.unref(C.NGrid),{cols:24,"x-gap":12,"y-gap":12},{default:vue.withCtx(()=>[vue.createVNode(vue.unref(C.NGi),{span:24},{default:vue.withCtx(()=>[vue.createVNode(vue.unref(C.NInput),{value:e.key,"onUpdate:value":t=>e.key=t,placeholder:"请输入键名",round:""},null,8,["value","onUpdate:value"])]),_:2},1024),vue.createVNode(vue.unref(C.NGi),{span:24},{default:vue.withCtx(()=>[vue.createElementVNode("div",Nt,[t[3]||(t[3]=vue.createElementVNode("span",{style:{"margin-right":"10px"}},"值列表 📋:",-1)),vue.createVNode(vue.unref(C.NButton),{text:"",onClick:e=>(e=>{const t=["示例值1","示例值2","示例值3"],a=t[Math.floor(Math.random()*t.length)];l.value[e].values.push(a);})(a)},{default:vue.withCtx(()=>t[2]||(t[2]=[vue.createTextVNode(" 💡 添加示例值 ",-1)])),_:2,__:[2]},1032,["onClick"])]),vue.createVNode(vue.unref(C.NDynamicTags),{value:e.values,"onUpdate:value":t=>e.values=t,placeholder:"请输入值并按回车确认，可添加多个值",round:""},null,8,["value","onUpdate:value"])]),_:2},1024),vue.createVNode(vue.unref(C.NGi),{span:24},{default:vue.withCtx(()=>[vue.createVNode(vue.unref(C.NSpace),{justify:"end"},{default:vue.withCtx(()=>[vue.createVNode(vue.unref(C.NButton),{strong:"",secondary:"",type:"error",onClick:e=>(e=>{l.value.splice(e,1);})(a)},{default:vue.withCtx(()=>t[4]||(t[4]=[vue.createTextVNode(" 🗑️ 删除此项 ",-1)])),_:2,__:[4]},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1032,["name","title"]);var n;}),128))]),_:1})]),_:1}))]),_:1})]),_:1}),vue.createVNode(vue.unref(C.NButton),{type:"primary",dashed:"",block:"",style:{"margin-top":"10px"},onClick:c},{default:vue.withCtx(()=>t[5]||(t[5]=[vue.createTextVNode(" ➕ 添加配置项 ",-1)])),_:1,__:[5]}),vue.createVNode(vue.unref(C.NSpace),{justify:"end"},{default:vue.withCtx(()=>[vue.createVNode(vue.unref(C.NButton),{strong:"",secondary:"",onClick:p},{default:vue.withCtx(()=>t[6]||(t[6]=[vue.createTextVNode(" 📥 从 GM_Value 读取 ",-1)])),_:1,__:[6]}),vue.createVNode(vue.unref(C.NButton),{strong:"",secondary:"",onClick:d},{default:vue.withCtx(()=>t[7]||(t[7]=[vue.createTextVNode(" 🔄 重置 ",-1)])),_:1,__:[7]}),vue.createVNode(vue.unref(C.NButton),{type:"primary",onClick:m},{default:vue.withCtx(()=>t[8]||(t[8]=[vue.createTextVNode(" 💾 保存到 GM_setValue ",-1)])),_:1,__:[8]})]),_:1})]),_:1},8,["model"])]))}},[["__scopeId","data-v-9eb581f0"]]),zt={class:"button-container"},Ut=te({__name:"app",setup(e){C.useMessage();const c=vue.ref({table:false,option:false}),p=[{key:"table",title:"表格",component:Tt},{key:"option",title:"选项",component:$t}],m=e=>{c.value[e]=true;},h=vue.computed(()=>[{key:"table",type:"primary",icon:"🐒",label:"表格",action:()=>m("table")},{key:"option",type:"primary",icon:"🐒",label:"选项",action:()=>m("option")}]);return (e,t)=>{const a=vue.resolveComponent("n-icon"),m=vue.resolveComponent("n-button"),g=vue.resolveComponent("n-space"),f=vue.resolveComponent("n-modal");return vue.openBlock(),vue.createElementBlock("div",zt,[vue.createVNode(g,{justify:"space-between",wrap:""},{default:vue.withCtx(()=>[(vue.openBlock(true),vue.createElementBlock(vue.Fragment,null,vue.renderList(h.value,e=>(vue.openBlock(),vue.createBlock(m,{key:e.key,type:e.type,size:"large",style:{flex:"1","min-width":"150px",margin:"4px"},onClick:e.action},{icon:vue.withCtx(()=>[vue.createVNode(a,null,{default:vue.withCtx(()=>[vue.createTextVNode(vue.toDisplayString(e.icon),1)]),_:2},1024)]),default:vue.withCtx(()=>[vue.createTextVNode(" "+vue.toDisplayString(e.label),1)]),_:2},1032,["type","onClick"]))),128))]),_:1}),(vue.openBlock(),vue.createElementBlock(vue.Fragment,null,vue.renderList(p,e=>vue.createVNode(f,{key:e.key,show:c.value[e.key],"onUpdate:show":t=>c.value[e.key]=t,preset:"card",style:{width:"1000px","max-width":"90vw"},title:e.title,bordered:false,"mask-closable":true,"close-on-esc":true},{default:vue.withCtx(()=>[(vue.openBlock(),vue.createBlock(vue.resolveDynamicComponent(e.component)))]),_:2},1032,["show","onUpdate:show","title"])),64))])}}},[["__scopeId","data-v-1b23b5f3"]]),qt={__name:"App",setup(e){const n=vue.ref(false),c=vue.ref("right"),d=vue.computed(()=>{const e=window.location.href;return e.includes("xiaohongshu.com")||e.includes("xhslink.com")?he:e.includes("galaxy.alibaba-inc.com")?Ke:e.includes("ad.e.kuaishou.com")?ft:e.includes("adstar.alimama.com")?xt:e.includes("diy.cbd.alibaba-inc.com")?Ut:ge});return (e,t)=>{const a=vue.resolveComponent("n-icon"),p=vue.resolveComponent("n-float-button"),m=vue.resolveComponent("n-drawer-content"),h=vue.resolveComponent("n-drawer"),v=vue.resolveComponent("n-message-provider");return vue.openBlock(),vue.createBlock(v,null,{default:vue.withCtx(()=>[vue.createVNode(p,{type:"primary",position:"fixed",right:24,bottom:24,onClick:t[0]||(t[0]=e=>{return t="right",n.value=true,void(c.value=t);var t;})},{default:vue.withCtx(()=>[vue.createVNode(a,null,{default:vue.withCtx(()=>t[2]||(t[2]=[vue.createTextVNode(" 🐒 ",-1)])),_:1,__:[2]})]),_:1}),vue.createVNode(h,{show:n.value,"onUpdate:show":t[1]||(t[1]=e=>n.value=e),width:502,placement:c.value},{default:vue.withCtx(()=>[vue.createVNode(m,{title:"工具箱 by.qjj"},{default:vue.withCtx(()=>[t[3]||(t[3]=vue.createTextVNode(" 通用工具箱 ",-1)),(vue.openBlock(),vue.createBlock(vue.resolveDynamicComponent(d.value)))]),_:1,__:[3]})]),_:1},8,["show","placement"])]),_:1})}}};console.log("当前环境production"),window.self===window.top?vue.createApp(qt).use(C).mount((()=>{const e=document.createElement("div");return e.style.position="absolute",e.style.top="0",e.style.left="0",e.style.zIndex="10000",document.body.append(e),e})()):console.log("在 iframe 中，不加载应用");}},function(){return Z||(0, Q[e(Q)[0]])((Z={exports:{}}).exports,Z),Z.exports});ee();

})(Vue, naive);
